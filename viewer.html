
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>FC ç›´æ’­è§‚ä¼—ç«¯</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/peerjs/1.5.2/peerjs.min.js"></script>
    <style>
        body { margin: 0;      background: linear-gradient(45deg,#ff7e5f,#feb47b,#ffed86,#9feb8f,#5fbfff,#9b8eff);
 color: #fff; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .video-container { flex: 1; position: relative;      background: linear-gradient(45deg,#ff7e5f,#feb47b,#ffed86,#9feb8f,#5fbfff,#9b8eff);
 display: flex; align-items: center; justify-content: center; }
        video { max-width: 100%; max-height: 100%; }
        #play-hint { position: absolute; inset: 0; background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 10; font-size: 1.2em; }
        .panel { padding: 15px; background: #222; border-top: 1px solid #444; }
        .emojis { display: flex; justify-content: space-around; font-size: 32px; margin-bottom: 15px; }
        .emojis span { cursor: pointer; padding: 5px; transition: 0.1s; }
        .emojis span:active { transform: scale(1.3); }
        .chat-box { display: flex; gap: 10px; }
        input { flex: 1; padding: 12px; background: #333; border: 1px solid #555; color: #fff; border-radius: 4px; }
        button { background: #E91E63; color: #fff; border: none; padding: 0 20px; border-radius: 4px; font-weight: bold; cursor: pointer; }
        #status { font-size: 12px; color: #FFC107; text-align: center; margin-bottom: 5px; }
        .disabled { opacity: 0.3; pointer-events: none; }
    </style>
</head>
<body>
    <div class="video-container">
        <video id="remoteVideo" autoplay playsinline muted></video>
        <div id="play-hint" onclick="enableAudio()">ç‚¹å‡»å¼€å¯å£°éŸ³ ğŸ”Š</div>
    </div>
    <div class="panel">
        <div id="status">æ­£åœ¨è·å–è§‚ä¼— ID...</div>
        <div id="interactive-area" class="disabled">
            <div class="emojis">
                <span onclick="send('emoji', 'ğŸ”¥')">ğŸ”¥</span>
                <span onclick="send('emoji', 'ğŸ‘')">ğŸ‘</span>
                <span onclick="send('emoji', 'ğŸ˜‚')">ğŸ˜‚</span>
                <span onclick="send('emoji', 'ğŸ‘')">ğŸ‘</span>
            </div>
            <div class="chat-box">
                <input type="text" id="chatInput" placeholder="å‘æ¡å¼¹å¹•...">
                <button onclick="sendChat()">å‘é€</button>
            </div>
        </div>
    </div>

    <script>
        const video = document.getElementById('remoteVideo');
        const status = document.getElementById('status');
        const hint = document.getElementById('play-hint');
        let dataConn = null, isStreamLoaded = false;

        const randomId = 'VIEWER_' + Math.floor(Math.random() * 8999 + 1000);
        const peer = new Peer(randomId, { host: '127.0.0.1', port: 9000, path: '/' });

        peer.on('open', id => {
            status.innerHTML = `è§‚ä¼— ID: <b style="color:#00BCD4;">${id}</b> (è¯·å¡«å…¥ä¸»æ’­ç«¯)`;
        });

        peer.on('call', call => {
            call.answer();
            call.on('stream', stream => {
                if (isStreamLoaded) return;
                isStreamLoaded = true;
                video.srcObject = stream;
                video.play().then(() => { hint.style.display = 'flex'; });
            });
        });

        peer.on('connection', conn => {
            dataConn = conn;
            dataConn.on('open', () => {
                status.innerText = "âœ… äº’åŠ¨é€šé“å·²è¿æ¥ï¼Œå¯ä»¥å‘é€è¡¨æƒ…å’Œå¼¹å¹•";
                document.getElementById('interactive-area').classList.remove('disabled');
            });
        });

        function enableAudio() { video.muted = false; hint.style.display = 'none'; }

        function send(type, value) {
            if (dataConn && dataConn.open) dataConn.send({ type, value });
        }

        function sendChat() {
            const input = document.getElementById('chatInput');
            if (input.value.trim()) { send('chat', input.value); input.value = ''; }
        }
    </script>
</body>
</html>
