<!DOCTYPE html><html><head>
  <link rel="stylesheet" type="text/css" href="data:text/css;base64,CmJvZHkgewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWZlZmVmOwp9CgpwcmUgewogIG1hcmdpbjogMDsKICBwYWRkaW5nOiAwOwp9CgojbG9nIHsKICBmb250LWZhbWlseTogbW9ub3NwYWNlOwogIG1heC1oZWlnaHQ6IDIwMHB4OwogIG1pbi1oZWlnaHQ6IDIwMHB4OwogIG92ZXJmbG93OiBzY3JvbGw7CiAgdGV4dC1hbGlnbjogbGVmdDsKICB3aWR0aDogNTEycHg7CiAgbWFyZ2luOiBhdXRvOwogIGJvcmRlcjogMXB4IHNvbGlkICNhZmFmYWY7CiAgcGFkZGluZzogNXB4Owp9Cgojb3V0cHV0IHsKICB3aWR0aDogNTEycHg7CiAgaGVpZ2h0OiA0ODBweDsKICBpbWFnZS1yZW5kZXJpbmc6IGNyaXNwLWVkZ2VzOwogIGltYWdlLXJlbmRlcmluZzogcGl4ZWxhdGVkOwp9Cg==">
  <title>NesJS</title>
</head>
<body>
  <input id="rom" type="file">
  <button id="pause">Pause</button>
  <button id="reset">Reset</button>
  <button id="hardreset">Power cycle</button>
  <button id="runframe">Run 1 frame</button><br>
  <canvas id="output" width="256" height="240"></canvas>
  <pre id="log">Audio initialized, sample rate: 48000<br></pre>
  <p>
    NesJs, by angelo_wf. <a href="https://angelo-wf.github.io/NesJs/debug.html">Debugger</a>, <a href="https://angelo-wf.github.io/NesJs/nsfplayer.html">NsfJs</a>.<br>
    Source on <a href="https://github.com/angelo-wf/NesJs">Github</a>.
  </p>

  <script src="data:application/javascript;base64,LyoKIENvcHlyaWdodCAoYykgMjAxMyBHaWxkYXMgTG9ybWVhdS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KCiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OgoKIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwKIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuCgogMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbgogdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCgogMy4gVGhlIG5hbWVzIG9mIHRoZSBhdXRob3JzIG1heSBub3QgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMKIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLgoKIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgYGBBUyBJUycnIEFORCBBTlkgRVhQUkVTU0VEIE9SIElNUExJRUQgV0FSUkFOVElFUywKIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQKIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBKQ1JBRlQsCiBJTkMuIE9SIEFOWSBDT05UUklCVVRPUlMgVE8gVEhJUyBTT0ZUV0FSRSBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULAogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVAogTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsCiBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GCiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORwogTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLAogRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS4KICovCgooZnVuY3Rpb24ob2JqKSB7CgkidXNlIHN0cmljdCI7CgoJdmFyIEVSUl9CQURfRk9STUFUID0gIkZpbGUgZm9ybWF0IGlzIG5vdCByZWNvZ25pemVkLiI7Cgl2YXIgRVJSX0NSQyA9ICJDUkMgZmFpbGVkLiI7Cgl2YXIgRVJSX0VOQ1JZUFRFRCA9ICJGaWxlIGNvbnRhaW5zIGVuY3J5cHRlZCBlbnRyeS4iOwoJdmFyIEVSUl9aSVA2NCA9ICJGaWxlIGlzIHVzaW5nIFppcDY0ICg0Z2IrIGZpbGUgc2l6ZSkuIjsKCXZhciBFUlJfUkVBRCA9ICJFcnJvciB3aGlsZSByZWFkaW5nIHppcCBmaWxlLiI7Cgl2YXIgRVJSX1dSSVRFID0gIkVycm9yIHdoaWxlIHdyaXRpbmcgemlwIGZpbGUuIjsKCXZhciBFUlJfV1JJVEVfREFUQSA9ICJFcnJvciB3aGlsZSB3cml0aW5nIGZpbGUgZGF0YS4iOwoJdmFyIEVSUl9SRUFEX0RBVEEgPSAiRXJyb3Igd2hpbGUgcmVhZGluZyBmaWxlIGRhdGEuIjsKCXZhciBFUlJfRFVQTElDQVRFRF9OQU1FID0gIkZpbGUgYWxyZWFkeSBleGlzdHMuIjsKCXZhciBDSFVOS19TSVpFID0gNTEyICogMTAyNDsKCQoJdmFyIFRFWFRfUExBSU4gPSAidGV4dC9wbGFpbiI7CgoJdmFyIGFwcGVuZEFCVmlld1N1cHBvcnRlZDsKCXRyeSB7CgkJYXBwZW5kQUJWaWV3U3VwcG9ydGVkID0gbmV3IEJsb2IoWyBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKDApKSBdKS5zaXplID09PSAwOwoJfSBjYXRjaCAoZSkgewoJfQoKCWZ1bmN0aW9uIENyYzMyKCkgewoJCXRoaXMuY3JjID0gLTE7Cgl9CglDcmMzMi5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gYXBwZW5kKGRhdGEpIHsKCQl2YXIgY3JjID0gdGhpcy5jcmMgfCAwLCB0YWJsZSA9IHRoaXMudGFibGU7CgkJZm9yICh2YXIgb2Zmc2V0ID0gMCwgbGVuID0gZGF0YS5sZW5ndGggfCAwOyBvZmZzZXQgPCBsZW47IG9mZnNldCsrKQoJCQljcmMgPSAoY3JjID4+PiA4KSBeIHRhYmxlWyhjcmMgXiBkYXRhW29mZnNldF0pICYgMHhGRl07CgkJdGhpcy5jcmMgPSBjcmM7Cgl9OwoJQ3JjMzIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldCgpIHsKCQlyZXR1cm4gfnRoaXMuY3JjOwoJfTsKCUNyYzMyLnByb3RvdHlwZS50YWJsZSA9IChmdW5jdGlvbigpIHsKCQl2YXIgaSwgaiwgdCwgdGFibGUgPSBbXTsgLy8gVWludDMyQXJyYXkgaXMgYWN0dWFsbHkgc2xvd2VyIHRoYW4gW10KCQlmb3IgKGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKCQkJdCA9IGk7CgkJCWZvciAoaiA9IDA7IGogPCA4OyBqKyspCgkJCQlpZiAodCAmIDEpCgkJCQkJdCA9ICh0ID4+PiAxKSBeIDB4RURCODgzMjA7CgkJCQllbHNlCgkJCQkJdCA9IHQgPj4+IDE7CgkJCXRhYmxlW2ldID0gdDsKCQl9CgkJcmV0dXJuIHRhYmxlOwoJfSkoKTsKCQoJLy8gIm5vLW9wIiBjb2RlYwoJZnVuY3Rpb24gTk9PUCgpIHt9CglOT09QLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiBhcHBlbmQoYnl0ZXMsIG9ucHJvZ3Jlc3MpIHsKCQlyZXR1cm4gYnl0ZXM7Cgl9OwoJTk9PUC5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiBmbHVzaCgpIHt9OwoKCWZ1bmN0aW9uIGJsb2JTbGljZShibG9iLCBpbmRleCwgbGVuZ3RoKSB7CgkJaWYgKGluZGV4IDwgMCB8fCBsZW5ndGggPCAwIHx8IGluZGV4ICsgbGVuZ3RoID4gYmxvYi5zaXplKQoJCQl0aHJvdyBuZXcgUmFuZ2VFcnJvcignb2Zmc2V0OicgKyBpbmRleCArICcsIGxlbmd0aDonICsgbGVuZ3RoICsgJywgc2l6ZTonICsgYmxvYi5zaXplKTsKCQlpZiAoYmxvYi5zbGljZSkKCQkJcmV0dXJuIGJsb2Iuc2xpY2UoaW5kZXgsIGluZGV4ICsgbGVuZ3RoKTsKCQllbHNlIGlmIChibG9iLndlYmtpdFNsaWNlKQoJCQlyZXR1cm4gYmxvYi53ZWJraXRTbGljZShpbmRleCwgaW5kZXggKyBsZW5ndGgpOwoJCWVsc2UgaWYgKGJsb2IubW96U2xpY2UpCgkJCXJldHVybiBibG9iLm1velNsaWNlKGluZGV4LCBpbmRleCArIGxlbmd0aCk7CgkJZWxzZSBpZiAoYmxvYi5tc1NsaWNlKQoJCQlyZXR1cm4gYmxvYi5tc1NsaWNlKGluZGV4LCBpbmRleCArIGxlbmd0aCk7Cgl9CgoJZnVuY3Rpb24gZ2V0RGF0YUhlbHBlcihieXRlTGVuZ3RoLCBieXRlcykgewoJCXZhciBkYXRhQnVmZmVyLCBkYXRhQXJyYXk7CgkJZGF0YUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihieXRlTGVuZ3RoKTsKCQlkYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheShkYXRhQnVmZmVyKTsKCQlpZiAoYnl0ZXMpCgkJCWRhdGFBcnJheS5zZXQoYnl0ZXMsIDApOwoJCXJldHVybiB7CgkJCWJ1ZmZlciA6IGRhdGFCdWZmZXIsCgkJCWFycmF5IDogZGF0YUFycmF5LAoJCQl2aWV3IDogbmV3IERhdGFWaWV3KGRhdGFCdWZmZXIpCgkJfTsKCX0KCgkvLyBSZWFkZXJzCglmdW5jdGlvbiBSZWFkZXIoKSB7Cgl9CgoJZnVuY3Rpb24gVGV4dFJlYWRlcih0ZXh0KSB7CgkJdmFyIHRoYXQgPSB0aGlzLCBibG9iUmVhZGVyOwoKCQlmdW5jdGlvbiBpbml0KGNhbGxiYWNrLCBvbmVycm9yKSB7CgkJCXZhciBibG9iID0gbmV3IEJsb2IoWyB0ZXh0IF0sIHsKCQkJCXR5cGUgOiBURVhUX1BMQUlOCgkJCX0pOwoJCQlibG9iUmVhZGVyID0gbmV3IEJsb2JSZWFkZXIoYmxvYik7CgkJCWJsb2JSZWFkZXIuaW5pdChmdW5jdGlvbigpIHsKCQkJCXRoYXQuc2l6ZSA9IGJsb2JSZWFkZXIuc2l6ZTsKCQkJCWNhbGxiYWNrKCk7CgkJCX0sIG9uZXJyb3IpOwoJCX0KCgkJZnVuY3Rpb24gcmVhZFVpbnQ4QXJyYXkoaW5kZXgsIGxlbmd0aCwgY2FsbGJhY2ssIG9uZXJyb3IpIHsKCQkJYmxvYlJlYWRlci5yZWFkVWludDhBcnJheShpbmRleCwgbGVuZ3RoLCBjYWxsYmFjaywgb25lcnJvcik7CgkJfQoKCQl0aGF0LnNpemUgPSAwOwoJCXRoYXQuaW5pdCA9IGluaXQ7CgkJdGhhdC5yZWFkVWludDhBcnJheSA9IHJlYWRVaW50OEFycmF5OwoJfQoJVGV4dFJlYWRlci5wcm90b3R5cGUgPSBuZXcgUmVhZGVyKCk7CglUZXh0UmVhZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFRleHRSZWFkZXI7CgoJZnVuY3Rpb24gRGF0YTY0VVJJUmVhZGVyKGRhdGFVUkkpIHsKCQl2YXIgdGhhdCA9IHRoaXMsIGRhdGFTdGFydDsKCgkJZnVuY3Rpb24gaW5pdChjYWxsYmFjaykgewoJCQl2YXIgZGF0YUVuZCA9IGRhdGFVUkkubGVuZ3RoOwoJCQl3aGlsZSAoZGF0YVVSSS5jaGFyQXQoZGF0YUVuZCAtIDEpID09ICI9IikKCQkJCWRhdGFFbmQtLTsKCQkJZGF0YVN0YXJ0ID0gZGF0YVVSSS5pbmRleE9mKCIsIikgKyAxOwoJCQl0aGF0LnNpemUgPSBNYXRoLmZsb29yKChkYXRhRW5kIC0gZGF0YVN0YXJ0KSAqIDAuNzUpOwoJCQljYWxsYmFjaygpOwoJCX0KCgkJZnVuY3Rpb24gcmVhZFVpbnQ4QXJyYXkoaW5kZXgsIGxlbmd0aCwgY2FsbGJhY2spIHsKCQkJdmFyIGksIGRhdGEgPSBnZXREYXRhSGVscGVyKGxlbmd0aCk7CgkJCXZhciBzdGFydCA9IE1hdGguZmxvb3IoaW5kZXggLyAzKSAqIDQ7CgkJCXZhciBlbmQgPSBNYXRoLmNlaWwoKGluZGV4ICsgbGVuZ3RoKSAvIDMpICogNDsKCQkJdmFyIGJ5dGVzID0gb2JqLmF0b2IoZGF0YVVSSS5zdWJzdHJpbmcoc3RhcnQgKyBkYXRhU3RhcnQsIGVuZCArIGRhdGFTdGFydCkpOwoJCQl2YXIgZGVsdGEgPSBpbmRleCAtIE1hdGguZmxvb3Ioc3RhcnQgLyA0KSAqIDM7CgkJCWZvciAoaSA9IGRlbHRhOyBpIDwgZGVsdGEgKyBsZW5ndGg7IGkrKykKCQkJCWRhdGEuYXJyYXlbaSAtIGRlbHRhXSA9IGJ5dGVzLmNoYXJDb2RlQXQoaSk7CgkJCWNhbGxiYWNrKGRhdGEuYXJyYXkpOwoJCX0KCgkJdGhhdC5zaXplID0gMDsKCQl0aGF0LmluaXQgPSBpbml0OwoJCXRoYXQucmVhZFVpbnQ4QXJyYXkgPSByZWFkVWludDhBcnJheTsKCX0KCURhdGE2NFVSSVJlYWRlci5wcm90b3R5cGUgPSBuZXcgUmVhZGVyKCk7CglEYXRhNjRVUklSZWFkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRGF0YTY0VVJJUmVhZGVyOwoKCWZ1bmN0aW9uIEJsb2JSZWFkZXIoYmxvYikgewoJCXZhciB0aGF0ID0gdGhpczsKCgkJZnVuY3Rpb24gaW5pdChjYWxsYmFjaykgewoJCQl0aGF0LnNpemUgPSBibG9iLnNpemU7CgkJCWNhbGxiYWNrKCk7CgkJfQoKCQlmdW5jdGlvbiByZWFkVWludDhBcnJheShpbmRleCwgbGVuZ3RoLCBjYWxsYmFjaywgb25lcnJvcikgewoJCQl2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCQkJcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHsKCQkJCWNhbGxiYWNrKG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCkpOwoJCQl9OwoJCQlyZWFkZXIub25lcnJvciA9IG9uZXJyb3I7CgkJCXRyeSB7CgkJCQlyZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYlNsaWNlKGJsb2IsIGluZGV4LCBsZW5ndGgpKTsKCQkJfSBjYXRjaCAoZSkgewoJCQkJb25lcnJvcihlKTsKCQkJfQoJCX0KCgkJdGhhdC5zaXplID0gMDsKCQl0aGF0LmluaXQgPSBpbml0OwoJCXRoYXQucmVhZFVpbnQ4QXJyYXkgPSByZWFkVWludDhBcnJheTsKCX0KCUJsb2JSZWFkZXIucHJvdG90eXBlID0gbmV3IFJlYWRlcigpOwoJQmxvYlJlYWRlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBCbG9iUmVhZGVyOwoKCS8vIFdyaXRlcnMKCglmdW5jdGlvbiBXcml0ZXIoKSB7Cgl9CglXcml0ZXIucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbihjYWxsYmFjaykgewoJCWNhbGxiYWNrKHRoaXMuZGF0YSk7Cgl9OwoKCWZ1bmN0aW9uIFRleHRXcml0ZXIoZW5jb2RpbmcpIHsKCQl2YXIgdGhhdCA9IHRoaXMsIGJsb2I7CgoJCWZ1bmN0aW9uIGluaXQoY2FsbGJhY2spIHsKCQkJYmxvYiA9IG5ldyBCbG9iKFtdLCB7CgkJCQl0eXBlIDogVEVYVF9QTEFJTgoJCQl9KTsKCQkJY2FsbGJhY2soKTsKCQl9CgoJCWZ1bmN0aW9uIHdyaXRlVWludDhBcnJheShhcnJheSwgY2FsbGJhY2spIHsKCQkJYmxvYiA9IG5ldyBCbG9iKFsgYmxvYiwgYXBwZW5kQUJWaWV3U3VwcG9ydGVkID8gYXJyYXkgOiBhcnJheS5idWZmZXIgXSwgewoJCQkJdHlwZSA6IFRFWFRfUExBSU4KCQkJfSk7CgkJCWNhbGxiYWNrKCk7CgkJfQoKCQlmdW5jdGlvbiBnZXREYXRhKGNhbGxiYWNrLCBvbmVycm9yKSB7CgkJCXZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoJCQlyZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkgewoJCQkJY2FsbGJhY2soZS50YXJnZXQucmVzdWx0KTsKCQkJfTsKCQkJcmVhZGVyLm9uZXJyb3IgPSBvbmVycm9yOwoJCQlyZWFkZXIucmVhZEFzVGV4dChibG9iLCBlbmNvZGluZyk7CgkJfQoKCQl0aGF0LmluaXQgPSBpbml0OwoJCXRoYXQud3JpdGVVaW50OEFycmF5ID0gd3JpdGVVaW50OEFycmF5OwoJCXRoYXQuZ2V0RGF0YSA9IGdldERhdGE7Cgl9CglUZXh0V3JpdGVyLnByb3RvdHlwZSA9IG5ldyBXcml0ZXIoKTsKCVRleHRXcml0ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVGV4dFdyaXRlcjsKCglmdW5jdGlvbiBEYXRhNjRVUklXcml0ZXIoY29udGVudFR5cGUpIHsKCQl2YXIgdGhhdCA9IHRoaXMsIGRhdGEgPSAiIiwgcGVuZGluZyA9ICIiOwoKCQlmdW5jdGlvbiBpbml0KGNhbGxiYWNrKSB7CgkJCWRhdGEgKz0gImRhdGE6IiArIChjb250ZW50VHlwZSB8fCAiIikgKyAiO2Jhc2U2NCwiOwoJCQljYWxsYmFjaygpOwoJCX0KCgkJZnVuY3Rpb24gd3JpdGVVaW50OEFycmF5KGFycmF5LCBjYWxsYmFjaykgewoJCQl2YXIgaSwgZGVsdGEgPSBwZW5kaW5nLmxlbmd0aCwgZGF0YVN0cmluZyA9IHBlbmRpbmc7CgkJCXBlbmRpbmcgPSAiIjsKCQkJZm9yIChpID0gMDsgaSA8IChNYXRoLmZsb29yKChkZWx0YSArIGFycmF5Lmxlbmd0aCkgLyAzKSAqIDMpIC0gZGVsdGE7IGkrKykKCQkJCWRhdGFTdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShhcnJheVtpXSk7CgkJCWZvciAoOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspCgkJCQlwZW5kaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYXJyYXlbaV0pOwoJCQlpZiAoZGF0YVN0cmluZy5sZW5ndGggPiAyKQoJCQkJZGF0YSArPSBvYmouYnRvYShkYXRhU3RyaW5nKTsKCQkJZWxzZQoJCQkJcGVuZGluZyA9IGRhdGFTdHJpbmc7CgkJCWNhbGxiYWNrKCk7CgkJfQoKCQlmdW5jdGlvbiBnZXREYXRhKGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKGRhdGEgKyBvYmouYnRvYShwZW5kaW5nKSk7CgkJfQoKCQl0aGF0LmluaXQgPSBpbml0OwoJCXRoYXQud3JpdGVVaW50OEFycmF5ID0gd3JpdGVVaW50OEFycmF5OwoJCXRoYXQuZ2V0RGF0YSA9IGdldERhdGE7Cgl9CglEYXRhNjRVUklXcml0ZXIucHJvdG90eXBlID0gbmV3IFdyaXRlcigpOwoJRGF0YTY0VVJJV3JpdGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IERhdGE2NFVSSVdyaXRlcjsKCglmdW5jdGlvbiBCbG9iV3JpdGVyKGNvbnRlbnRUeXBlKSB7CgkJdmFyIGJsb2IsIHRoYXQgPSB0aGlzOwoKCQlmdW5jdGlvbiBpbml0KGNhbGxiYWNrKSB7CgkJCWJsb2IgPSBuZXcgQmxvYihbXSwgewoJCQkJdHlwZSA6IGNvbnRlbnRUeXBlCgkJCX0pOwoJCQljYWxsYmFjaygpOwoJCX0KCgkJZnVuY3Rpb24gd3JpdGVVaW50OEFycmF5KGFycmF5LCBjYWxsYmFjaykgewoJCQlibG9iID0gbmV3IEJsb2IoWyBibG9iLCBhcHBlbmRBQlZpZXdTdXBwb3J0ZWQgPyBhcnJheSA6IGFycmF5LmJ1ZmZlciBdLCB7CgkJCQl0eXBlIDogY29udGVudFR5cGUKCQkJfSk7CgkJCWNhbGxiYWNrKCk7CgkJfQoKCQlmdW5jdGlvbiBnZXREYXRhKGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKGJsb2IpOwoJCX0KCgkJdGhhdC5pbml0ID0gaW5pdDsKCQl0aGF0LndyaXRlVWludDhBcnJheSA9IHdyaXRlVWludDhBcnJheTsKCQl0aGF0LmdldERhdGEgPSBnZXREYXRhOwoJfQoJQmxvYldyaXRlci5wcm90b3R5cGUgPSBuZXcgV3JpdGVyKCk7CglCbG9iV3JpdGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJsb2JXcml0ZXI7CgoJLyoqIAoJICogaW5mbGF0ZS9kZWZsYXRlIGNvcmUgZnVuY3Rpb25zCgkgKiBAcGFyYW0gd29ya2VyIHtXb3JrZXJ9IHdlYiB3b3JrZXIgZm9yIHRoZSB0YXNrLgoJICogQHBhcmFtIGluaXRpYWxNZXNzYWdlIHtPYmplY3R9IGluaXRpYWwgbWVzc2FnZSB0byBiZSBzZW50IHRvIHRoZSB3b3JrZXIuIHNob3VsZCBjb250YWluCgkgKiAgIHNuKHNlcmlhbCBudW1iZXIgZm9yIGRpc3Rpbmd1aXNoaW5nIG11bHRpcGxlIHRhc2tzIHNlbnQgdG8gdGhlIHdvcmtlciksIGFuZCBjb2RlY0NsYXNzLgoJICogICBUaGlzIGZ1bmN0aW9uIG1heSBhZGQgbW9yZSBwcm9wZXJ0aWVzIGJlZm9yZSBzZW5kaW5nLgoJICovCglmdW5jdGlvbiBsYXVuY2hXb3JrZXJQcm9jZXNzKHdvcmtlciwgaW5pdGlhbE1lc3NhZ2UsIHJlYWRlciwgd3JpdGVyLCBvZmZzZXQsIHNpemUsIG9ucHJvZ3Jlc3MsIG9uZW5kLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKSB7CgkJdmFyIGNodW5rSW5kZXggPSAwLCBpbmRleCwgb3V0cHV0U2l6ZSwgc24gPSBpbml0aWFsTWVzc2FnZS5zbiwgY3JjOwoKCQlmdW5jdGlvbiBvbmZsdXNoKCkgewoJCQl3b3JrZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIG9ubWVzc2FnZSwgZmFsc2UpOwoJCQlvbmVuZChvdXRwdXRTaXplLCBjcmMpOwoJCX0KCgkJZnVuY3Rpb24gb25tZXNzYWdlKGV2ZW50KSB7CgkJCXZhciBtZXNzYWdlID0gZXZlbnQuZGF0YSwgZGF0YSA9IG1lc3NhZ2UuZGF0YSwgZXJyID0gbWVzc2FnZS5lcnJvcjsKCQkJaWYgKGVycikgewoJCQkJZXJyLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJ0Vycm9yOiAnICsgdGhpcy5tZXNzYWdlOyB9OwoJCQkJb25yZWFkZXJyb3IoZXJyKTsKCQkJCXJldHVybjsKCQkJfQoJCQlpZiAobWVzc2FnZS5zbiAhPT0gc24pCgkJCQlyZXR1cm47CgkJCWlmICh0eXBlb2YgbWVzc2FnZS5jb2RlY1RpbWUgPT09ICdudW1iZXInKQoJCQkJd29ya2VyLmNvZGVjVGltZSArPSBtZXNzYWdlLmNvZGVjVGltZTsgLy8gc2hvdWxkIGJlIGJlZm9yZSBvbmZsdXNoKCkKCQkJaWYgKHR5cGVvZiBtZXNzYWdlLmNyY1RpbWUgPT09ICdudW1iZXInKQoJCQkJd29ya2VyLmNyY1RpbWUgKz0gbWVzc2FnZS5jcmNUaW1lOwoKCQkJc3dpdGNoIChtZXNzYWdlLnR5cGUpIHsKCQkJCWNhc2UgJ2FwcGVuZCc6CgkJCQkJaWYgKGRhdGEpIHsKCQkJCQkJb3V0cHV0U2l6ZSArPSBkYXRhLmxlbmd0aDsKCQkJCQkJd3JpdGVyLndyaXRlVWludDhBcnJheShkYXRhLCBmdW5jdGlvbigpIHsKCQkJCQkJCXN0ZXAoKTsKCQkJCQkJfSwgb253cml0ZWVycm9yKTsKCQkJCQl9IGVsc2UKCQkJCQkJc3RlcCgpOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnZmx1c2gnOgoJCQkJCWNyYyA9IG1lc3NhZ2UuY3JjOwoJCQkJCWlmIChkYXRhKSB7CgkJCQkJCW91dHB1dFNpemUgKz0gZGF0YS5sZW5ndGg7CgkJCQkJCXdyaXRlci53cml0ZVVpbnQ4QXJyYXkoZGF0YSwgZnVuY3Rpb24oKSB7CgkJCQkJCQlvbmZsdXNoKCk7CgkJCQkJCX0sIG9ud3JpdGVlcnJvcik7CgkJCQkJfSBlbHNlCgkJCQkJCW9uZmx1c2goKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgJ3Byb2dyZXNzJzoKCQkJCQlpZiAob25wcm9ncmVzcykKCQkJCQkJb25wcm9ncmVzcyhpbmRleCArIG1lc3NhZ2UubG9hZGVkLCBzaXplKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgJ2ltcG9ydFNjcmlwdHMnOiAvL25vIG5lZWQgdG8gaGFuZGxlIGhlcmUKCQkJCWNhc2UgJ25ld1Rhc2snOgoJCQkJY2FzZSAnZWNobyc6CgkJCQkJYnJlYWs7CgkJCQlkZWZhdWx0OgoJCQkJCWNvbnNvbGUud2FybignemlwLmpzOmxhdW5jaFdvcmtlclByb2Nlc3M6IHVua25vd24gbWVzc2FnZTogJywgbWVzc2FnZSk7CgkJCX0KCQl9CgoJCWZ1bmN0aW9uIHN0ZXAoKSB7CgkJCWluZGV4ID0gY2h1bmtJbmRleCAqIENIVU5LX1NJWkU7CgkJCS8vIHVzZSBgPD1gIGluc3RlYWQgb2YgYDxgLCBiZWNhdXNlIGBzaXplYCBtYXkgYmUgMC4KCQkJaWYgKGluZGV4IDw9IHNpemUpIHsKCQkJCXJlYWRlci5yZWFkVWludDhBcnJheShvZmZzZXQgKyBpbmRleCwgTWF0aC5taW4oQ0hVTktfU0laRSwgc2l6ZSAtIGluZGV4KSwgZnVuY3Rpb24oYXJyYXkpIHsKCQkJCQlpZiAob25wcm9ncmVzcykKCQkJCQkJb25wcm9ncmVzcyhpbmRleCwgc2l6ZSk7CgkJCQkJdmFyIG1zZyA9IGluZGV4ID09PSAwID8gaW5pdGlhbE1lc3NhZ2UgOiB7c24gOiBzbn07CgkJCQkJbXNnLnR5cGUgPSAnYXBwZW5kJzsKCQkJCQltc2cuZGF0YSA9IGFycmF5OwoJCQkJCQoJCQkJCS8vIHBvc3RpbmcgYSBtZXNzYWdlIHdpdGggdHJhbnNmZXJhYmxlcyB3aWxsIGZhaWwgb24gSUUxMAoJCQkJCXRyeSB7CgkJCQkJCXdvcmtlci5wb3N0TWVzc2FnZShtc2csIFthcnJheS5idWZmZXJdKTsKCQkJCQl9IGNhdGNoKGV4KSB7CgkJCQkJCXdvcmtlci5wb3N0TWVzc2FnZShtc2cpOyAvLyByZXRyeSB3aXRob3V0IHRyYW5zZmVyYWJsZXMKCQkJCQl9CgkJCQkJY2h1bmtJbmRleCsrOwoJCQkJfSwgb25yZWFkZXJyb3IpOwoJCQl9IGVsc2UgewoJCQkJd29ya2VyLnBvc3RNZXNzYWdlKHsKCQkJCQlzbjogc24sCgkJCQkJdHlwZTogJ2ZsdXNoJwoJCQkJfSk7CgkJCX0KCQl9CgoJCW91dHB1dFNpemUgPSAwOwoJCXdvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgb25tZXNzYWdlLCBmYWxzZSk7CgkJc3RlcCgpOwoJfQoKCWZ1bmN0aW9uIGxhdW5jaFByb2Nlc3MocHJvY2VzcywgcmVhZGVyLCB3cml0ZXIsIG9mZnNldCwgc2l6ZSwgY3JjVHlwZSwgb25wcm9ncmVzcywgb25lbmQsIG9ucmVhZGVycm9yLCBvbndyaXRlZXJyb3IpIHsKCQl2YXIgY2h1bmtJbmRleCA9IDAsIGluZGV4LCBvdXRwdXRTaXplID0gMCwKCQkJY3JjSW5wdXQgPSBjcmNUeXBlID09PSAnaW5wdXQnLAoJCQljcmNPdXRwdXQgPSBjcmNUeXBlID09PSAnb3V0cHV0JywKCQkJY3JjID0gbmV3IENyYzMyKCk7CgkJZnVuY3Rpb24gc3RlcCgpIHsKCQkJdmFyIG91dHB1dERhdGE7CgkJCWluZGV4ID0gY2h1bmtJbmRleCAqIENIVU5LX1NJWkU7CgkJCWlmIChpbmRleCA8IHNpemUpCgkJCQlyZWFkZXIucmVhZFVpbnQ4QXJyYXkob2Zmc2V0ICsgaW5kZXgsIE1hdGgubWluKENIVU5LX1NJWkUsIHNpemUgLSBpbmRleCksIGZ1bmN0aW9uKGlucHV0RGF0YSkgewoJCQkJCXZhciBvdXRwdXREYXRhOwoJCQkJCXRyeSB7CgkJCQkJCW91dHB1dERhdGEgPSBwcm9jZXNzLmFwcGVuZChpbnB1dERhdGEsIGZ1bmN0aW9uKGxvYWRlZCkgewoJCQkJCQkJaWYgKG9ucHJvZ3Jlc3MpCgkJCQkJCQkJb25wcm9ncmVzcyhpbmRleCArIGxvYWRlZCwgc2l6ZSk7CgkJCQkJCX0pOwoJCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQkJb25yZWFkZXJyb3IoZSk7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQkJaWYgKG91dHB1dERhdGEpIHsKCQkJCQkJb3V0cHV0U2l6ZSArPSBvdXRwdXREYXRhLmxlbmd0aDsKCQkJCQkJd3JpdGVyLndyaXRlVWludDhBcnJheShvdXRwdXREYXRhLCBmdW5jdGlvbigpIHsKCQkJCQkJCWNodW5rSW5kZXgrKzsKCQkJCQkJCXNldFRpbWVvdXQoc3RlcCwgMSk7CgkJCQkJCX0sIG9ud3JpdGVlcnJvcik7CgkJCQkJCWlmIChjcmNPdXRwdXQpCgkJCQkJCQljcmMuYXBwZW5kKG91dHB1dERhdGEpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWNodW5rSW5kZXgrKzsKCQkJCQkJc2V0VGltZW91dChzdGVwLCAxKTsKCQkJCQl9CgkJCQkJaWYgKGNyY0lucHV0KQoJCQkJCQljcmMuYXBwZW5kKGlucHV0RGF0YSk7CgkJCQkJaWYgKG9ucHJvZ3Jlc3MpCgkJCQkJCW9ucHJvZ3Jlc3MoaW5kZXgsIHNpemUpOwoJCQkJfSwgb25yZWFkZXJyb3IpOwoJCQllbHNlIHsKCQkJCXRyeSB7CgkJCQkJb3V0cHV0RGF0YSA9IHByb2Nlc3MuZmx1c2goKTsKCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQlvbnJlYWRlcnJvcihlKTsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQlpZiAob3V0cHV0RGF0YSkgewoJCQkJCWlmIChjcmNPdXRwdXQpCgkJCQkJCWNyYy5hcHBlbmQob3V0cHV0RGF0YSk7CgkJCQkJb3V0cHV0U2l6ZSArPSBvdXRwdXREYXRhLmxlbmd0aDsKCQkJCQl3cml0ZXIud3JpdGVVaW50OEFycmF5KG91dHB1dERhdGEsIGZ1bmN0aW9uKCkgewoJCQkJCQlvbmVuZChvdXRwdXRTaXplLCBjcmMuZ2V0KCkpOwoJCQkJCX0sIG9ud3JpdGVlcnJvcik7CgkJCQl9IGVsc2UKCQkJCQlvbmVuZChvdXRwdXRTaXplLCBjcmMuZ2V0KCkpOwoJCQl9CgkJfQoKCQlzdGVwKCk7Cgl9CgoJZnVuY3Rpb24gaW5mbGF0ZSh3b3JrZXIsIHNuLCByZWFkZXIsIHdyaXRlciwgb2Zmc2V0LCBzaXplLCBjb21wdXRlQ3JjMzIsIG9uZW5kLCBvbnByb2dyZXNzLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKSB7CgkJdmFyIGNyY1R5cGUgPSBjb21wdXRlQ3JjMzIgPyAnb3V0cHV0JyA6ICdub25lJzsKCQlpZiAob2JqLnppcC51c2VXZWJXb3JrZXJzKSB7CgkJCXZhciBpbml0aWFsTWVzc2FnZSA9IHsKCQkJCXNuOiBzbiwKCQkJCWNvZGVjQ2xhc3M6ICdJbmZsYXRlcicsCgkJCQljcmNUeXBlOiBjcmNUeXBlLAoJCQl9OwoJCQlsYXVuY2hXb3JrZXJQcm9jZXNzKHdvcmtlciwgaW5pdGlhbE1lc3NhZ2UsIHJlYWRlciwgd3JpdGVyLCBvZmZzZXQsIHNpemUsIG9ucHJvZ3Jlc3MsIG9uZW5kLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKTsKCQl9IGVsc2UKCQkJbGF1bmNoUHJvY2VzcyhuZXcgb2JqLnppcC5JbmZsYXRlcigpLCByZWFkZXIsIHdyaXRlciwgb2Zmc2V0LCBzaXplLCBjcmNUeXBlLCBvbnByb2dyZXNzLCBvbmVuZCwgb25yZWFkZXJyb3IsIG9ud3JpdGVlcnJvcik7Cgl9CgoJZnVuY3Rpb24gZGVmbGF0ZSh3b3JrZXIsIHNuLCByZWFkZXIsIHdyaXRlciwgbGV2ZWwsIG9uZW5kLCBvbnByb2dyZXNzLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKSB7CgkJdmFyIGNyY1R5cGUgPSAnaW5wdXQnOwoJCWlmIChvYmouemlwLnVzZVdlYldvcmtlcnMpIHsKCQkJdmFyIGluaXRpYWxNZXNzYWdlID0gewoJCQkJc246IHNuLAoJCQkJb3B0aW9uczoge2xldmVsOiBsZXZlbH0sCgkJCQljb2RlY0NsYXNzOiAnRGVmbGF0ZXInLAoJCQkJY3JjVHlwZTogY3JjVHlwZSwKCQkJfTsKCQkJbGF1bmNoV29ya2VyUHJvY2Vzcyh3b3JrZXIsIGluaXRpYWxNZXNzYWdlLCByZWFkZXIsIHdyaXRlciwgMCwgcmVhZGVyLnNpemUsIG9ucHJvZ3Jlc3MsIG9uZW5kLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKTsKCQl9IGVsc2UKCQkJbGF1bmNoUHJvY2VzcyhuZXcgb2JqLnppcC5EZWZsYXRlcigpLCByZWFkZXIsIHdyaXRlciwgMCwgcmVhZGVyLnNpemUsIGNyY1R5cGUsIG9ucHJvZ3Jlc3MsIG9uZW5kLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKTsKCX0KCglmdW5jdGlvbiBjb3B5KHdvcmtlciwgc24sIHJlYWRlciwgd3JpdGVyLCBvZmZzZXQsIHNpemUsIGNvbXB1dGVDcmMzMiwgb25lbmQsIG9ucHJvZ3Jlc3MsIG9ucmVhZGVycm9yLCBvbndyaXRlZXJyb3IpIHsKCQl2YXIgY3JjVHlwZSA9ICdpbnB1dCc7CgkJaWYgKG9iai56aXAudXNlV2ViV29ya2VycyAmJiBjb21wdXRlQ3JjMzIpIHsKCQkJdmFyIGluaXRpYWxNZXNzYWdlID0gewoJCQkJc246IHNuLAoJCQkJY29kZWNDbGFzczogJ05PT1AnLAoJCQkJY3JjVHlwZTogY3JjVHlwZSwKCQkJfTsKCQkJbGF1bmNoV29ya2VyUHJvY2Vzcyh3b3JrZXIsIGluaXRpYWxNZXNzYWdlLCByZWFkZXIsIHdyaXRlciwgb2Zmc2V0LCBzaXplLCBvbnByb2dyZXNzLCBvbmVuZCwgb25yZWFkZXJyb3IsIG9ud3JpdGVlcnJvcik7CgkJfSBlbHNlCgkJCWxhdW5jaFByb2Nlc3MobmV3IE5PT1AoKSwgcmVhZGVyLCB3cml0ZXIsIG9mZnNldCwgc2l6ZSwgY3JjVHlwZSwgb25wcm9ncmVzcywgb25lbmQsIG9ucmVhZGVycm9yLCBvbndyaXRlZXJyb3IpOwoJfQoKCS8vIFppcFJlYWRlcgoKCWZ1bmN0aW9uIGRlY29kZUFTQ0lJKHN0cikgewoJCXZhciBpLCBvdXQgPSAiIiwgY2hhckNvZGUsIGV4dGVuZGVkQVNDSUkgPSBbICdcdTAwQzcnLCAnXHUwMEZDJywgJ1x1MDBFOScsICdcdTAwRTInLCAnXHUwMEU0JywgJ1x1MDBFMCcsICdcdTAwRTUnLCAnXHUwMEU3JywgJ1x1MDBFQScsICdcdTAwRUInLAoJCQkJJ1x1MDBFOCcsICdcdTAwRUYnLCAnXHUwMEVFJywgJ1x1MDBFQycsICdcdTAwQzQnLCAnXHUwMEM1JywgJ1x1MDBDOScsICdcdTAwRTYnLCAnXHUwMEM2JywgJ1x1MDBGNCcsICdcdTAwRjYnLCAnXHUwMEYyJywgJ1x1MDBGQicsICdcdTAwRjknLAoJCQkJJ1x1MDBGRicsICdcdTAwRDYnLCAnXHUwMERDJywgJ1x1MDBGOCcsICdcdTAwQTMnLCAnXHUwMEQ4JywgJ1x1MDBENycsICdcdTAxOTInLCAnXHUwMEUxJywgJ1x1MDBFRCcsICdcdTAwRjMnLCAnXHUwMEZBJywgJ1x1MDBGMScsICdcdTAwRDEnLAoJCQkJJ1x1MDBBQScsICdcdTAwQkEnLCAnXHUwMEJGJywgJ1x1MDBBRScsICdcdTAwQUMnLCAnXHUwMEJEJywgJ1x1MDBCQycsICdcdTAwQTEnLCAnXHUwMEFCJywgJ1x1MDBCQicsICdfJywgJ18nLCAnXycsICdcdTAwQTYnLCAnXHUwMEE2JywKCQkJCSdcdTAwQzEnLCAnXHUwMEMyJywgJ1x1MDBDMCcsICdcdTAwQTknLCAnXHUwMEE2JywgJ1x1MDBBNicsICcrJywgJysnLCAnXHUwMEEyJywgJ1x1MDBBNScsICcrJywgJysnLCAnLScsICctJywgJysnLCAnLScsICcrJywgJ1x1MDBFMycsCgkJCQknXHUwMEMzJywgJysnLCAnKycsICctJywgJy0nLCAnXHUwMEE2JywgJy0nLCAnKycsICdcdTAwQTQnLCAnXHUwMEYwJywgJ1x1MDBEMCcsICdcdTAwQ0EnLCAnXHUwMENCJywgJ1x1MDBDOCcsICdpJywgJ1x1MDBDRCcsICdcdTAwQ0UnLAoJCQkJJ1x1MDBDRicsICcrJywgJysnLCAnXycsICdfJywgJ1x1MDBBNicsICdcdTAwQ0MnLCAnXycsICdcdTAwRDMnLCAnXHUwMERGJywgJ1x1MDBENCcsICdcdTAwRDInLCAnXHUwMEY1JywgJ1x1MDBENScsICdcdTAwQjUnLCAnXHUwMEZFJywKCQkJCSdcdTAwREUnLCAnXHUwMERBJywgJ1x1MDBEQicsICdcdTAwRDknLCAnXHUwMEZEJywgJ1x1MDBERCcsICdcdTAwQUYnLCAnXHUwMEI0JywgJ1x1MDBBRCcsICdcdTAwQjEnLCAnXycsICdcdTAwQkUnLCAnXHUwMEI2JywgJ1x1MDBBNycsCgkJCQknXHUwMEY3JywgJ1x1MDBCOCcsICdcdTAwQjAnLCAnXHUwMEE4JywgJ1x1MDBCNycsICdcdTAwQjknLCAnXHUwMEIzJywgJ1x1MDBCMicsICdfJywgJyAnIF07CgkJZm9yIChpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgewoJCQljaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRjsKCQkJaWYgKGNoYXJDb2RlID4gMTI3KQoJCQkJb3V0ICs9IGV4dGVuZGVkQVNDSUlbY2hhckNvZGUgLSAxMjhdOwoJCQllbHNlCgkJCQlvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSk7CgkJfQoJCXJldHVybiBvdXQ7Cgl9CgoJZnVuY3Rpb24gZGVjb2RlVVRGOChzdHJpbmcpIHsKCQlyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShzdHJpbmcpKTsKCX0KCglmdW5jdGlvbiBnZXRTdHJpbmcoYnl0ZXMpIHsKCQl2YXIgaSwgc3RyID0gIiI7CgkJZm9yIChpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSsrKQoJCQlzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSk7CgkJcmV0dXJuIHN0cjsKCX0KCglmdW5jdGlvbiBnZXREYXRlKHRpbWVSYXcpIHsKCQl2YXIgZGF0ZSA9ICh0aW1lUmF3ICYgMHhmZmZmMDAwMCkgPj4gMTYsIHRpbWUgPSB0aW1lUmF3ICYgMHgwMDAwZmZmZjsKCQl0cnkgewoJCQlyZXR1cm4gbmV3IERhdGUoMTk4MCArICgoZGF0ZSAmIDB4RkUwMCkgPj4gOSksICgoZGF0ZSAmIDB4MDFFMCkgPj4gNSkgLSAxLCBkYXRlICYgMHgwMDFGLCAodGltZSAmIDB4RjgwMCkgPj4gMTEsICh0aW1lICYgMHgwN0UwKSA+PiA1LAoJCQkJCSh0aW1lICYgMHgwMDFGKSAqIDIsIDApOwoJCX0gY2F0Y2ggKGUpIHsKCQl9Cgl9CgoJZnVuY3Rpb24gcmVhZENvbW1vbkhlYWRlcihlbnRyeSwgZGF0YSwgaW5kZXgsIGNlbnRyYWxEaXJlY3RvcnksIG9uZXJyb3IpIHsKCQllbnRyeS52ZXJzaW9uID0gZGF0YS52aWV3LmdldFVpbnQxNihpbmRleCwgdHJ1ZSk7CgkJZW50cnkuYml0RmxhZyA9IGRhdGEudmlldy5nZXRVaW50MTYoaW5kZXggKyAyLCB0cnVlKTsKCQllbnRyeS5jb21wcmVzc2lvbk1ldGhvZCA9IGRhdGEudmlldy5nZXRVaW50MTYoaW5kZXggKyA0LCB0cnVlKTsKCQllbnRyeS5sYXN0TW9kRGF0ZVJhdyA9IGRhdGEudmlldy5nZXRVaW50MzIoaW5kZXggKyA2LCB0cnVlKTsKCQllbnRyeS5sYXN0TW9kRGF0ZSA9IGdldERhdGUoZW50cnkubGFzdE1vZERhdGVSYXcpOwoJCWlmICgoZW50cnkuYml0RmxhZyAmIDB4MDEpID09PSAweDAxKSB7CgkJCW9uZXJyb3IoRVJSX0VOQ1JZUFRFRCk7CgkJCXJldHVybjsKCQl9CgkJaWYgKGNlbnRyYWxEaXJlY3RvcnkgfHwgKGVudHJ5LmJpdEZsYWcgJiAweDAwMDgpICE9IDB4MDAwOCkgewoJCQllbnRyeS5jcmMzMiA9IGRhdGEudmlldy5nZXRVaW50MzIoaW5kZXggKyAxMCwgdHJ1ZSk7CgkJCWVudHJ5LmNvbXByZXNzZWRTaXplID0gZGF0YS52aWV3LmdldFVpbnQzMihpbmRleCArIDE0LCB0cnVlKTsKCQkJZW50cnkudW5jb21wcmVzc2VkU2l6ZSA9IGRhdGEudmlldy5nZXRVaW50MzIoaW5kZXggKyAxOCwgdHJ1ZSk7CgkJfQoJCWlmIChlbnRyeS5jb21wcmVzc2VkU2l6ZSA9PT0gMHhGRkZGRkZGRiB8fCBlbnRyeS51bmNvbXByZXNzZWRTaXplID09PSAweEZGRkZGRkZGKSB7CgkJCW9uZXJyb3IoRVJSX1pJUDY0KTsKCQkJcmV0dXJuOwoJCX0KCQllbnRyeS5maWxlbmFtZUxlbmd0aCA9IGRhdGEudmlldy5nZXRVaW50MTYoaW5kZXggKyAyMiwgdHJ1ZSk7CgkJZW50cnkuZXh0cmFGaWVsZExlbmd0aCA9IGRhdGEudmlldy5nZXRVaW50MTYoaW5kZXggKyAyNCwgdHJ1ZSk7Cgl9CgoJZnVuY3Rpb24gY3JlYXRlWmlwUmVhZGVyKHJlYWRlciwgY2FsbGJhY2ssIG9uZXJyb3IpIHsKCQl2YXIgaW5mbGF0ZVNOID0gMDsKCgkJZnVuY3Rpb24gRW50cnkoKSB7CgkJfQoKCQlFbnRyeS5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uKHdyaXRlciwgb25lbmQsIG9ucHJvZ3Jlc3MsIGNoZWNrQ3JjMzIpIHsKCQkJdmFyIHRoYXQgPSB0aGlzOwoKCQkJZnVuY3Rpb24gdGVzdENyYzMyKGNyYzMyKSB7CgkJCQl2YXIgZGF0YUNyYzMyID0gZ2V0RGF0YUhlbHBlcig0KTsKCQkJCWRhdGFDcmMzMi52aWV3LnNldFVpbnQzMigwLCBjcmMzMik7CgkJCQlyZXR1cm4gdGhhdC5jcmMzMiA9PSBkYXRhQ3JjMzIudmlldy5nZXRVaW50MzIoMCk7CgkJCX0KCgkJCWZ1bmN0aW9uIGdldFdyaXRlckRhdGEodW5jb21wcmVzc2VkU2l6ZSwgY3JjMzIpIHsKCQkJCWlmIChjaGVja0NyYzMyICYmICF0ZXN0Q3JjMzIoY3JjMzIpKQoJCQkJCW9uZXJyb3IoRVJSX0NSQyk7CgkJCQllbHNlCgkJCQkJd3JpdGVyLmdldERhdGEoZnVuY3Rpb24oZGF0YSkgewoJCQkJCQlvbmVuZChkYXRhKTsKCQkJCQl9KTsKCQkJfQoKCQkJZnVuY3Rpb24gb25yZWFkZXJyb3IoZXJyKSB7CgkJCQlvbmVycm9yKGVyciB8fCBFUlJfUkVBRF9EQVRBKTsKCQkJfQoKCQkJZnVuY3Rpb24gb253cml0ZWVycm9yKGVycikgewoJCQkJb25lcnJvcihlcnIgfHwgRVJSX1dSSVRFX0RBVEEpOwoJCQl9CgoJCQlyZWFkZXIucmVhZFVpbnQ4QXJyYXkodGhhdC5vZmZzZXQsIDMwLCBmdW5jdGlvbihieXRlcykgewoJCQkJdmFyIGRhdGEgPSBnZXREYXRhSGVscGVyKGJ5dGVzLmxlbmd0aCwgYnl0ZXMpLCBkYXRhT2Zmc2V0OwoJCQkJaWYgKGRhdGEudmlldy5nZXRVaW50MzIoMCkgIT0gMHg1MDRiMDMwNCkgewoJCQkJCW9uZXJyb3IoRVJSX0JBRF9GT1JNQVQpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJCXJlYWRDb21tb25IZWFkZXIodGhhdCwgZGF0YSwgNCwgZmFsc2UsIG9uZXJyb3IpOwoJCQkJZGF0YU9mZnNldCA9IHRoYXQub2Zmc2V0ICsgMzAgKyB0aGF0LmZpbGVuYW1lTGVuZ3RoICsgdGhhdC5leHRyYUZpZWxkTGVuZ3RoOwoJCQkJd3JpdGVyLmluaXQoZnVuY3Rpb24oKSB7CgkJCQkJaWYgKHRoYXQuY29tcHJlc3Npb25NZXRob2QgPT09IDApCgkJCQkJCWNvcHkodGhhdC5fd29ya2VyLCBpbmZsYXRlU04rKywgcmVhZGVyLCB3cml0ZXIsIGRhdGFPZmZzZXQsIHRoYXQuY29tcHJlc3NlZFNpemUsIGNoZWNrQ3JjMzIsIGdldFdyaXRlckRhdGEsIG9ucHJvZ3Jlc3MsIG9ucmVhZGVycm9yLCBvbndyaXRlZXJyb3IpOwoJCQkJCWVsc2UKCQkJCQkJaW5mbGF0ZSh0aGF0Ll93b3JrZXIsIGluZmxhdGVTTisrLCByZWFkZXIsIHdyaXRlciwgZGF0YU9mZnNldCwgdGhhdC5jb21wcmVzc2VkU2l6ZSwgY2hlY2tDcmMzMiwgZ2V0V3JpdGVyRGF0YSwgb25wcm9ncmVzcywgb25yZWFkZXJyb3IsIG9ud3JpdGVlcnJvcik7CgkJCQl9LCBvbndyaXRlZXJyb3IpOwoJCQl9LCBvbnJlYWRlcnJvcik7CgkJfTsKCgkJZnVuY3Rpb24gc2Vla0VPQ0RSKGVvY2RyQ2FsbGJhY2spIHsKCQkJLy8gIkVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSByZWNvcmQiIGlzIHRoZSBsYXN0IHBhcnQgb2YgYSB6aXAgYXJjaGl2ZSwgYW5kIGlzIGF0IGxlYXN0IDIyIGJ5dGVzIGxvbmcuCgkJCS8vIFppcCBmaWxlIGNvbW1lbnQgaXMgdGhlIGxhc3QgcGFydCBvZiBFT0NEUiBhbmQgaGFzIG1heCBsZW5ndGggb2YgNjRLQiwKCQkJLy8gc28gd2Ugb25seSBoYXZlIHRvIHNlYXJjaCB0aGUgbGFzdCA2NEsgKyAyMiBieXRlcyBvZiBhIGFyY2hpdmUgZm9yIEVPQ0RSIHNpZ25hdHVyZSAoMHgwNjA1NGI1MCkuCgkJCXZhciBFT0NEUl9NSU4gPSAyMjsKCQkJaWYgKHJlYWRlci5zaXplIDwgRU9DRFJfTUlOKSB7CgkJCQlvbmVycm9yKEVSUl9CQURfRk9STUFUKTsKCQkJCXJldHVybjsKCQkJfQoJCQl2YXIgWklQX0NPTU1FTlRfTUFYID0gMjU2ICogMjU2LCBFT0NEUl9NQVggPSBFT0NEUl9NSU4gKyBaSVBfQ09NTUVOVF9NQVg7CgoJCQkvLyBJbiBtb3N0IGNhc2VzLCB0aGUgRU9DRFIgaXMgRU9DRFJfTUlOIGJ5dGVzIGxvbmcKCQkJZG9TZWVrKEVPQ0RSX01JTiwgZnVuY3Rpb24oKSB7CgkJCQkvLyBJZiBub3QgZm91bmQsIHRyeSB3aXRoaW4gRU9DRFJfTUFYIGJ5dGVzCgkJCQlkb1NlZWsoTWF0aC5taW4oRU9DRFJfTUFYLCByZWFkZXIuc2l6ZSksIGZ1bmN0aW9uKCkgewoJCQkJCW9uZXJyb3IoRVJSX0JBRF9GT1JNQVQpOwoJCQkJfSk7CgkJCX0pOwoKCQkJLy8gc2VlayBsYXN0IGxlbmd0aCBieXRlcyBvZiBmaWxlIGZvciBFT0NEUgoJCQlmdW5jdGlvbiBkb1NlZWsobGVuZ3RoLCBlb2Nkck5vdEZvdW5kQ2FsbGJhY2spIHsKCQkJCXJlYWRlci5yZWFkVWludDhBcnJheShyZWFkZXIuc2l6ZSAtIGxlbmd0aCwgbGVuZ3RoLCBmdW5jdGlvbihieXRlcykgewoJCQkJCWZvciAodmFyIGkgPSBieXRlcy5sZW5ndGggLSBFT0NEUl9NSU47IGkgPj0gMDsgaS0tKSB7CgkJCQkJCWlmIChieXRlc1tpXSA9PT0gMHg1MCAmJiBieXRlc1tpICsgMV0gPT09IDB4NGIgJiYgYnl0ZXNbaSArIDJdID09PSAweDA1ICYmIGJ5dGVzW2kgKyAzXSA9PT0gMHgwNikgewoJCQkJCQkJZW9jZHJDYWxsYmFjayhuZXcgRGF0YVZpZXcoYnl0ZXMuYnVmZmVyLCBpLCBFT0NEUl9NSU4pKTsKCQkJCQkJCXJldHVybjsKCQkJCQkJfQoJCQkJCX0KCQkJCQllb2Nkck5vdEZvdW5kQ2FsbGJhY2soKTsKCQkJCX0sIGZ1bmN0aW9uKCkgewoJCQkJCW9uZXJyb3IoRVJSX1JFQUQpOwoJCQkJfSk7CgkJCX0KCQl9CgoJCXZhciB6aXBSZWFkZXIgPSB7CgkJCWdldEVudHJpZXMgOiBmdW5jdGlvbihjYWxsYmFjaykgewoJCQkJdmFyIHdvcmtlciA9IHRoaXMuX3dvcmtlcjsKCQkJCS8vIGxvb2sgZm9yIEVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSByZWNvcmQKCQkJCXNlZWtFT0NEUihmdW5jdGlvbihkYXRhVmlldykgewoJCQkJCXZhciBkYXRhbGVuZ3RoLCBmaWxlc2xlbmd0aDsKCQkJCQlkYXRhbGVuZ3RoID0gZGF0YVZpZXcuZ2V0VWludDMyKDE2LCB0cnVlKTsKCQkJCQlmaWxlc2xlbmd0aCA9IGRhdGFWaWV3LmdldFVpbnQxNig4LCB0cnVlKTsKCQkJCQlpZiAoZGF0YWxlbmd0aCA8IDAgfHwgZGF0YWxlbmd0aCA+PSByZWFkZXIuc2l6ZSkgewoJCQkJCQlvbmVycm9yKEVSUl9CQURfRk9STUFUKTsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCQlyZWFkZXIucmVhZFVpbnQ4QXJyYXkoZGF0YWxlbmd0aCwgcmVhZGVyLnNpemUgLSBkYXRhbGVuZ3RoLCBmdW5jdGlvbihieXRlcykgewoJCQkJCQl2YXIgaSwgaW5kZXggPSAwLCBlbnRyaWVzID0gW10sIGVudHJ5LCBmaWxlbmFtZSwgY29tbWVudCwgZGF0YSA9IGdldERhdGFIZWxwZXIoYnl0ZXMubGVuZ3RoLCBieXRlcyk7CgkJCQkJCWZvciAoaSA9IDA7IGkgPCBmaWxlc2xlbmd0aDsgaSsrKSB7CgkJCQkJCQllbnRyeSA9IG5ldyBFbnRyeSgpOwoJCQkJCQkJZW50cnkuX3dvcmtlciA9IHdvcmtlcjsKCQkJCQkJCWlmIChkYXRhLnZpZXcuZ2V0VWludDMyKGluZGV4KSAhPSAweDUwNGIwMTAyKSB7CgkJCQkJCQkJb25lcnJvcihFUlJfQkFEX0ZPUk1BVCk7CgkJCQkJCQkJcmV0dXJuOwoJCQkJCQkJfQoJCQkJCQkJcmVhZENvbW1vbkhlYWRlcihlbnRyeSwgZGF0YSwgaW5kZXggKyA2LCB0cnVlLCBvbmVycm9yKTsKCQkJCQkJCWVudHJ5LmNvbW1lbnRMZW5ndGggPSBkYXRhLnZpZXcuZ2V0VWludDE2KGluZGV4ICsgMzIsIHRydWUpOwoJCQkJCQkJZW50cnkuZGlyZWN0b3J5ID0gKChkYXRhLnZpZXcuZ2V0VWludDgoaW5kZXggKyAzOCkgJiAweDEwKSA9PSAweDEwKTsKCQkJCQkJCWVudHJ5Lm9mZnNldCA9IGRhdGEudmlldy5nZXRVaW50MzIoaW5kZXggKyA0MiwgdHJ1ZSk7CgkJCQkJCQlmaWxlbmFtZSA9IGdldFN0cmluZyhkYXRhLmFycmF5LnN1YmFycmF5KGluZGV4ICsgNDYsIGluZGV4ICsgNDYgKyBlbnRyeS5maWxlbmFtZUxlbmd0aCkpOwoJCQkJCQkJZW50cnkuZmlsZW5hbWUgPSAoKGVudHJ5LmJpdEZsYWcgJiAweDA4MDApID09PSAweDA4MDApID8gZGVjb2RlVVRGOChmaWxlbmFtZSkgOiBkZWNvZGVBU0NJSShmaWxlbmFtZSk7CgkJCQkJCQlpZiAoIWVudHJ5LmRpcmVjdG9yeSAmJiBlbnRyeS5maWxlbmFtZS5jaGFyQXQoZW50cnkuZmlsZW5hbWUubGVuZ3RoIC0gMSkgPT0gIi8iKQoJCQkJCQkJCWVudHJ5LmRpcmVjdG9yeSA9IHRydWU7CgkJCQkJCQljb21tZW50ID0gZ2V0U3RyaW5nKGRhdGEuYXJyYXkuc3ViYXJyYXkoaW5kZXggKyA0NiArIGVudHJ5LmZpbGVuYW1lTGVuZ3RoICsgZW50cnkuZXh0cmFGaWVsZExlbmd0aCwgaW5kZXggKyA0NgoJCQkJCQkJCQkrIGVudHJ5LmZpbGVuYW1lTGVuZ3RoICsgZW50cnkuZXh0cmFGaWVsZExlbmd0aCArIGVudHJ5LmNvbW1lbnRMZW5ndGgpKTsKCQkJCQkJCWVudHJ5LmNvbW1lbnQgPSAoKGVudHJ5LmJpdEZsYWcgJiAweDA4MDApID09PSAweDA4MDApID8gZGVjb2RlVVRGOChjb21tZW50KSA6IGRlY29kZUFTQ0lJKGNvbW1lbnQpOwoJCQkJCQkJZW50cmllcy5wdXNoKGVudHJ5KTsKCQkJCQkJCWluZGV4ICs9IDQ2ICsgZW50cnkuZmlsZW5hbWVMZW5ndGggKyBlbnRyeS5leHRyYUZpZWxkTGVuZ3RoICsgZW50cnkuY29tbWVudExlbmd0aDsKCQkJCQkJfQoJCQkJCQljYWxsYmFjayhlbnRyaWVzKTsKCQkJCQl9LCBmdW5jdGlvbigpIHsKCQkJCQkJb25lcnJvcihFUlJfUkVBRCk7CgkJCQkJfSk7CgkJCQl9KTsKCQkJfSwKCQkJY2xvc2UgOiBmdW5jdGlvbihjYWxsYmFjaykgewoJCQkJaWYgKHRoaXMuX3dvcmtlcikgewoJCQkJCXRoaXMuX3dvcmtlci50ZXJtaW5hdGUoKTsKCQkJCQl0aGlzLl93b3JrZXIgPSBudWxsOwoJCQkJfQoJCQkJaWYgKGNhbGxiYWNrKQoJCQkJCWNhbGxiYWNrKCk7CgkJCX0sCgkJCV93b3JrZXI6IG51bGwKCQl9OwoKCQlpZiAoIW9iai56aXAudXNlV2ViV29ya2VycykKCQkJY2FsbGJhY2soemlwUmVhZGVyKTsKCQllbHNlIHsKCQkJY3JlYXRlV29ya2VyKCdpbmZsYXRlcicsCgkJCQlmdW5jdGlvbih3b3JrZXIpIHsKCQkJCQl6aXBSZWFkZXIuX3dvcmtlciA9IHdvcmtlcjsKCQkJCQljYWxsYmFjayh6aXBSZWFkZXIpOwoJCQkJfSwKCQkJCWZ1bmN0aW9uKGVycikgewoJCQkJCW9uZXJyb3IoZXJyKTsKCQkJCX0KCQkJKTsKCQl9Cgl9CgoJLy8gWmlwV3JpdGVyCgoJZnVuY3Rpb24gZW5jb2RlVVRGOChzdHJpbmcpIHsKCQlyZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykpOwoJfQoKCWZ1bmN0aW9uIGdldEJ5dGVzKHN0cikgewoJCXZhciBpLCBhcnJheSA9IFtdOwoJCWZvciAoaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspCgkJCWFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkpOwoJCXJldHVybiBhcnJheTsKCX0KCglmdW5jdGlvbiBjcmVhdGVaaXBXcml0ZXIod3JpdGVyLCBjYWxsYmFjaywgb25lcnJvciwgZG9udERlZmxhdGUpIHsKCQl2YXIgZmlsZXMgPSB7fSwgZmlsZW5hbWVzID0gW10sIGRhdGFsZW5ndGggPSAwOwoJCXZhciBkZWZsYXRlU04gPSAwOwoKCQlmdW5jdGlvbiBvbndyaXRlZXJyb3IoZXJyKSB7CgkJCW9uZXJyb3IoZXJyIHx8IEVSUl9XUklURSk7CgkJfQoKCQlmdW5jdGlvbiBvbnJlYWRlcnJvcihlcnIpIHsKCQkJb25lcnJvcihlcnIgfHwgRVJSX1JFQURfREFUQSk7CgkJfQoKCQl2YXIgemlwV3JpdGVyID0gewoJCQlhZGQgOiBmdW5jdGlvbihuYW1lLCByZWFkZXIsIG9uZW5kLCBvbnByb2dyZXNzLCBvcHRpb25zKSB7CgkJCQl2YXIgaGVhZGVyLCBmaWxlbmFtZSwgZGF0ZTsKCQkJCXZhciB3b3JrZXIgPSB0aGlzLl93b3JrZXI7CgoJCQkJZnVuY3Rpb24gd3JpdGVIZWFkZXIoY2FsbGJhY2spIHsKCQkJCQl2YXIgZGF0YTsKCQkJCQlkYXRlID0gb3B0aW9ucy5sYXN0TW9kRGF0ZSB8fCBuZXcgRGF0ZSgpOwoJCQkJCWhlYWRlciA9IGdldERhdGFIZWxwZXIoMjYpOwoJCQkJCWZpbGVzW25hbWVdID0gewoJCQkJCQloZWFkZXJBcnJheSA6IGhlYWRlci5hcnJheSwKCQkJCQkJZGlyZWN0b3J5IDogb3B0aW9ucy5kaXJlY3RvcnksCgkJCQkJCWZpbGVuYW1lIDogZmlsZW5hbWUsCgkJCQkJCW9mZnNldCA6IGRhdGFsZW5ndGgsCgkJCQkJCWNvbW1lbnQgOiBnZXRCeXRlcyhlbmNvZGVVVEY4KG9wdGlvbnMuY29tbWVudCB8fCAiIikpCgkJCQkJfTsKCQkJCQloZWFkZXIudmlldy5zZXRVaW50MzIoMCwgMHgxNDAwMDgwOCk7CgkJCQkJaWYgKG9wdGlvbnMudmVyc2lvbikKCQkJCQkJaGVhZGVyLnZpZXcuc2V0VWludDgoMCwgb3B0aW9ucy52ZXJzaW9uKTsKCQkJCQlpZiAoIWRvbnREZWZsYXRlICYmIG9wdGlvbnMubGV2ZWwgIT09IDAgJiYgIW9wdGlvbnMuZGlyZWN0b3J5KQoJCQkJCQloZWFkZXIudmlldy5zZXRVaW50MTYoNCwgMHgwODAwKTsKCQkJCQloZWFkZXIudmlldy5zZXRVaW50MTYoNiwgKCgoZGF0ZS5nZXRIb3VycygpIDw8IDYpIHwgZGF0ZS5nZXRNaW51dGVzKCkpIDw8IDUpIHwgZGF0ZS5nZXRTZWNvbmRzKCkgLyAyLCB0cnVlKTsKCQkJCQloZWFkZXIudmlldy5zZXRVaW50MTYoOCwgKCgoKGRhdGUuZ2V0RnVsbFllYXIoKSAtIDE5ODApIDw8IDQpIHwgKGRhdGUuZ2V0TW9udGgoKSArIDEpKSA8PCA1KSB8IGRhdGUuZ2V0RGF0ZSgpLCB0cnVlKTsKCQkJCQloZWFkZXIudmlldy5zZXRVaW50MTYoMjIsIGZpbGVuYW1lLmxlbmd0aCwgdHJ1ZSk7CgkJCQkJZGF0YSA9IGdldERhdGFIZWxwZXIoMzAgKyBmaWxlbmFtZS5sZW5ndGgpOwoJCQkJCWRhdGEudmlldy5zZXRVaW50MzIoMCwgMHg1MDRiMDMwNCk7CgkJCQkJZGF0YS5hcnJheS5zZXQoaGVhZGVyLmFycmF5LCA0KTsKCQkJCQlkYXRhLmFycmF5LnNldChmaWxlbmFtZSwgMzApOwoJCQkJCWRhdGFsZW5ndGggKz0gZGF0YS5hcnJheS5sZW5ndGg7CgkJCQkJd3JpdGVyLndyaXRlVWludDhBcnJheShkYXRhLmFycmF5LCBjYWxsYmFjaywgb253cml0ZWVycm9yKTsKCQkJCX0KCgkJCQlmdW5jdGlvbiB3cml0ZUZvb3Rlcihjb21wcmVzc2VkTGVuZ3RoLCBjcmMzMikgewoJCQkJCXZhciBmb290ZXIgPSBnZXREYXRhSGVscGVyKDE2KTsKCQkJCQlkYXRhbGVuZ3RoICs9IGNvbXByZXNzZWRMZW5ndGggfHwgMDsKCQkJCQlmb290ZXIudmlldy5zZXRVaW50MzIoMCwgMHg1MDRiMDcwOCk7CgkJCQkJaWYgKHR5cGVvZiBjcmMzMiAhPSAidW5kZWZpbmVkIikgewoJCQkJCQloZWFkZXIudmlldy5zZXRVaW50MzIoMTAsIGNyYzMyLCB0cnVlKTsKCQkJCQkJZm9vdGVyLnZpZXcuc2V0VWludDMyKDQsIGNyYzMyLCB0cnVlKTsKCQkJCQl9CgkJCQkJaWYgKHJlYWRlcikgewoJCQkJCQlmb290ZXIudmlldy5zZXRVaW50MzIoOCwgY29tcHJlc3NlZExlbmd0aCwgdHJ1ZSk7CgkJCQkJCWhlYWRlci52aWV3LnNldFVpbnQzMigxNCwgY29tcHJlc3NlZExlbmd0aCwgdHJ1ZSk7CgkJCQkJCWZvb3Rlci52aWV3LnNldFVpbnQzMigxMiwgcmVhZGVyLnNpemUsIHRydWUpOwoJCQkJCQloZWFkZXIudmlldy5zZXRVaW50MzIoMTgsIHJlYWRlci5zaXplLCB0cnVlKTsKCQkJCQl9CgkJCQkJd3JpdGVyLndyaXRlVWludDhBcnJheShmb290ZXIuYXJyYXksIGZ1bmN0aW9uKCkgewoJCQkJCQlkYXRhbGVuZ3RoICs9IDE2OwoJCQkJCQlvbmVuZCgpOwoJCQkJCX0sIG9ud3JpdGVlcnJvcik7CgkJCQl9CgoJCQkJZnVuY3Rpb24gd3JpdGVGaWxlKCkgewoJCQkJCW9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoJCQkJCW5hbWUgPSBuYW1lLnRyaW0oKTsKCQkJCQlpZiAob3B0aW9ucy5kaXJlY3RvcnkgJiYgbmFtZS5jaGFyQXQobmFtZS5sZW5ndGggLSAxKSAhPSAiLyIpCgkJCQkJCW5hbWUgKz0gIi8iOwoJCQkJCWlmIChmaWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewoJCQkJCQlvbmVycm9yKEVSUl9EVVBMSUNBVEVEX05BTUUpOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJCWZpbGVuYW1lID0gZ2V0Qnl0ZXMoZW5jb2RlVVRGOChuYW1lKSk7CgkJCQkJZmlsZW5hbWVzLnB1c2gobmFtZSk7CgkJCQkJd3JpdGVIZWFkZXIoZnVuY3Rpb24oKSB7CgkJCQkJCWlmIChyZWFkZXIpCgkJCQkJCQlpZiAoZG9udERlZmxhdGUgfHwgb3B0aW9ucy5sZXZlbCA9PT0gMCkKCQkJCQkJCQljb3B5KHdvcmtlciwgZGVmbGF0ZVNOKyssIHJlYWRlciwgd3JpdGVyLCAwLCByZWFkZXIuc2l6ZSwgdHJ1ZSwgd3JpdGVGb290ZXIsIG9ucHJvZ3Jlc3MsIG9ucmVhZGVycm9yLCBvbndyaXRlZXJyb3IpOwoJCQkJCQkJZWxzZQoJCQkJCQkJCWRlZmxhdGUod29ya2VyLCBkZWZsYXRlU04rKywgcmVhZGVyLCB3cml0ZXIsIG9wdGlvbnMubGV2ZWwsIHdyaXRlRm9vdGVyLCBvbnByb2dyZXNzLCBvbnJlYWRlcnJvciwgb253cml0ZWVycm9yKTsKCQkJCQkJZWxzZQoJCQkJCQkJd3JpdGVGb290ZXIoKTsKCQkJCQl9LCBvbndyaXRlZXJyb3IpOwoJCQkJfQoKCQkJCWlmIChyZWFkZXIpCgkJCQkJcmVhZGVyLmluaXQod3JpdGVGaWxlLCBvbnJlYWRlcnJvcik7CgkJCQllbHNlCgkJCQkJd3JpdGVGaWxlKCk7CgkJCX0sCgkJCWNsb3NlIDogZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkJCWlmICh0aGlzLl93b3JrZXIpIHsKCQkJCQl0aGlzLl93b3JrZXIudGVybWluYXRlKCk7CgkJCQkJdGhpcy5fd29ya2VyID0gbnVsbDsKCQkJCX0KCgkJCQl2YXIgZGF0YSwgbGVuZ3RoID0gMCwgaW5kZXggPSAwLCBpbmRleEZpbGVuYW1lLCBmaWxlOwoJCQkJZm9yIChpbmRleEZpbGVuYW1lID0gMDsgaW5kZXhGaWxlbmFtZSA8IGZpbGVuYW1lcy5sZW5ndGg7IGluZGV4RmlsZW5hbWUrKykgewoJCQkJCWZpbGUgPSBmaWxlc1tmaWxlbmFtZXNbaW5kZXhGaWxlbmFtZV1dOwoJCQkJCWxlbmd0aCArPSA0NiArIGZpbGUuZmlsZW5hbWUubGVuZ3RoICsgZmlsZS5jb21tZW50Lmxlbmd0aDsKCQkJCX0KCQkJCWRhdGEgPSBnZXREYXRhSGVscGVyKGxlbmd0aCArIDIyKTsKCQkJCWZvciAoaW5kZXhGaWxlbmFtZSA9IDA7IGluZGV4RmlsZW5hbWUgPCBmaWxlbmFtZXMubGVuZ3RoOyBpbmRleEZpbGVuYW1lKyspIHsKCQkJCQlmaWxlID0gZmlsZXNbZmlsZW5hbWVzW2luZGV4RmlsZW5hbWVdXTsKCQkJCQlkYXRhLnZpZXcuc2V0VWludDMyKGluZGV4LCAweDUwNGIwMTAyKTsKCQkJCQlkYXRhLnZpZXcuc2V0VWludDE2KGluZGV4ICsgNCwgMHgxNDAwKTsKCQkJCQlkYXRhLmFycmF5LnNldChmaWxlLmhlYWRlckFycmF5LCBpbmRleCArIDYpOwoJCQkJCWRhdGEudmlldy5zZXRVaW50MTYoaW5kZXggKyAzMiwgZmlsZS5jb21tZW50Lmxlbmd0aCwgdHJ1ZSk7CgkJCQkJaWYgKGZpbGUuZGlyZWN0b3J5KQoJCQkJCQlkYXRhLnZpZXcuc2V0VWludDgoaW5kZXggKyAzOCwgMHgxMCk7CgkJCQkJZGF0YS52aWV3LnNldFVpbnQzMihpbmRleCArIDQyLCBmaWxlLm9mZnNldCwgdHJ1ZSk7CgkJCQkJZGF0YS5hcnJheS5zZXQoZmlsZS5maWxlbmFtZSwgaW5kZXggKyA0Nik7CgkJCQkJZGF0YS5hcnJheS5zZXQoZmlsZS5jb21tZW50LCBpbmRleCArIDQ2ICsgZmlsZS5maWxlbmFtZS5sZW5ndGgpOwoJCQkJCWluZGV4ICs9IDQ2ICsgZmlsZS5maWxlbmFtZS5sZW5ndGggKyBmaWxlLmNvbW1lbnQubGVuZ3RoOwoJCQkJfQoJCQkJZGF0YS52aWV3LnNldFVpbnQzMihpbmRleCwgMHg1MDRiMDUwNik7CgkJCQlkYXRhLnZpZXcuc2V0VWludDE2KGluZGV4ICsgOCwgZmlsZW5hbWVzLmxlbmd0aCwgdHJ1ZSk7CgkJCQlkYXRhLnZpZXcuc2V0VWludDE2KGluZGV4ICsgMTAsIGZpbGVuYW1lcy5sZW5ndGgsIHRydWUpOwoJCQkJZGF0YS52aWV3LnNldFVpbnQzMihpbmRleCArIDEyLCBsZW5ndGgsIHRydWUpOwoJCQkJZGF0YS52aWV3LnNldFVpbnQzMihpbmRleCArIDE2LCBkYXRhbGVuZ3RoLCB0cnVlKTsKCQkJCXdyaXRlci53cml0ZVVpbnQ4QXJyYXkoZGF0YS5hcnJheSwgZnVuY3Rpb24oKSB7CgkJCQkJd3JpdGVyLmdldERhdGEoY2FsbGJhY2spOwoJCQkJfSwgb253cml0ZWVycm9yKTsKCQkJfSwKCQkJX3dvcmtlcjogbnVsbAoJCX07CgoJCWlmICghb2JqLnppcC51c2VXZWJXb3JrZXJzKQoJCQljYWxsYmFjayh6aXBXcml0ZXIpOwoJCWVsc2UgewoJCQljcmVhdGVXb3JrZXIoJ2RlZmxhdGVyJywKCQkJCWZ1bmN0aW9uKHdvcmtlcikgewoJCQkJCXppcFdyaXRlci5fd29ya2VyID0gd29ya2VyOwoJCQkJCWNhbGxiYWNrKHppcFdyaXRlcik7CgkJCQl9LAoJCQkJZnVuY3Rpb24oZXJyKSB7CgkJCQkJb25lcnJvcihlcnIpOwoJCQkJfQoJCQkpOwoJCX0KCX0KCglmdW5jdGlvbiByZXNvbHZlVVJMcyh1cmxzKSB7CgkJdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CgkJcmV0dXJuIHVybHMubWFwKGZ1bmN0aW9uKHVybCkgewoJCQlhLmhyZWYgPSB1cmw7CgkJCXJldHVybiBhLmhyZWY7CgkJfSk7Cgl9CgoJdmFyIERFRkFVTFRfV09SS0VSX1NDUklQVFMgPSB7CgkJZGVmbGF0ZXI6IFsnei13b3JrZXIuanMnLCAnZGVmbGF0ZS5qcyddLAoJCWluZmxhdGVyOiBbJ3otd29ya2VyLmpzJywgJ2luZmxhdGUuanMnXQoJfTsKCWZ1bmN0aW9uIGNyZWF0ZVdvcmtlcih0eXBlLCBjYWxsYmFjaywgb25lcnJvcikgewoJCWlmIChvYmouemlwLndvcmtlclNjcmlwdHMgIT09IG51bGwgJiYgb2JqLnppcC53b3JrZXJTY3JpcHRzUGF0aCAhPT0gbnVsbCkgewoJCQlvbmVycm9yKG5ldyBFcnJvcignRWl0aGVyIHppcC53b3JrZXJTY3JpcHRzIG9yIHppcC53b3JrZXJTY3JpcHRzUGF0aCBtYXkgYmUgc2V0LCBub3QgYm90aC4nKSk7CgkJCXJldHVybjsKCQl9CgkJdmFyIHNjcmlwdHM7CgkJaWYgKG9iai56aXAud29ya2VyU2NyaXB0cykgewoJCQlzY3JpcHRzID0gb2JqLnppcC53b3JrZXJTY3JpcHRzW3R5cGVdOwoJCQlpZiAoIUFycmF5LmlzQXJyYXkoc2NyaXB0cykpIHsKCQkJCW9uZXJyb3IobmV3IEVycm9yKCd6aXAud29ya2VyU2NyaXB0cy4nICsgdHlwZSArICcgaXMgbm90IGFuIGFycmF5IScpKTsKCQkJCXJldHVybjsKCQkJfQoJCQlzY3JpcHRzID0gcmVzb2x2ZVVSTHMoc2NyaXB0cyk7CgkJfSBlbHNlIHsKCQkJc2NyaXB0cyA9IERFRkFVTFRfV09SS0VSX1NDUklQVFNbdHlwZV0uc2xpY2UoMCk7CgkJCXNjcmlwdHNbMF0gPSAob2JqLnppcC53b3JrZXJTY3JpcHRzUGF0aCB8fCAnJykgKyBzY3JpcHRzWzBdOwoJCX0KCQl2YXIgd29ya2VyID0gbmV3IFdvcmtlcihzY3JpcHRzWzBdKTsKCQkvLyByZWNvcmQgdG90YWwgY29uc3VtZWQgdGltZSBieSBpbmZsYXRlci9kZWZsYXRlci9jcmMzMiBpbiB0aGlzIHdvcmtlcgoJCXdvcmtlci5jb2RlY1RpbWUgPSB3b3JrZXIuY3JjVGltZSA9IDA7CgkJd29ya2VyLnBvc3RNZXNzYWdlKHsgdHlwZTogJ2ltcG9ydFNjcmlwdHMnLCBzY3JpcHRzOiBzY3JpcHRzLnNsaWNlKDEpIH0pOwoJCXdvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgb25tZXNzYWdlKTsKCQlmdW5jdGlvbiBvbm1lc3NhZ2UoZXYpIHsKCQkJdmFyIG1zZyA9IGV2LmRhdGE7CgkJCWlmIChtc2cuZXJyb3IpIHsKCQkJCXdvcmtlci50ZXJtaW5hdGUoKTsgLy8gc2hvdWxkIGJlZm9yZSBvbmVycm9yKCksIGJlY2F1c2Ugb25lcnJvcigpIG1heSB0aHJvdy4KCQkJCW9uZXJyb3IobXNnLmVycm9yKTsKCQkJCXJldHVybjsKCQkJfQoJCQlpZiAobXNnLnR5cGUgPT09ICdpbXBvcnRTY3JpcHRzJykgewoJCQkJd29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBvbm1lc3NhZ2UpOwoJCQkJd29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTsKCQkJCWNhbGxiYWNrKHdvcmtlcik7CgkJCX0KCQl9CgkJLy8gY2F0Y2ggZW50cnkgc2NyaXB0IGxvYWRpbmcgZXJyb3IgYW5kIG90aGVyIHVuaGFuZGxlZCBlcnJvcnMKCQl3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvckhhbmRsZXIpOwoJCWZ1bmN0aW9uIGVycm9ySGFuZGxlcihlcnIpIHsKCQkJd29ya2VyLnRlcm1pbmF0ZSgpOwoJCQlvbmVycm9yKGVycik7CgkJfQoJfQoKCWZ1bmN0aW9uIG9uZXJyb3JfZGVmYXVsdChlcnJvcikgewoJCWNvbnNvbGUuZXJyb3IoZXJyb3IpOwoJfQoJb2JqLnppcCA9IHsKCQlSZWFkZXIgOiBSZWFkZXIsCgkJV3JpdGVyIDogV3JpdGVyLAoJCUJsb2JSZWFkZXIgOiBCbG9iUmVhZGVyLAoJCURhdGE2NFVSSVJlYWRlciA6IERhdGE2NFVSSVJlYWRlciwKCQlUZXh0UmVhZGVyIDogVGV4dFJlYWRlciwKCQlCbG9iV3JpdGVyIDogQmxvYldyaXRlciwKCQlEYXRhNjRVUklXcml0ZXIgOiBEYXRhNjRVUklXcml0ZXIsCgkJVGV4dFdyaXRlciA6IFRleHRXcml0ZXIsCgkJY3JlYXRlUmVhZGVyIDogZnVuY3Rpb24ocmVhZGVyLCBjYWxsYmFjaywgb25lcnJvcikgewoJCQlvbmVycm9yID0gb25lcnJvciB8fCBvbmVycm9yX2RlZmF1bHQ7CgoJCQlyZWFkZXIuaW5pdChmdW5jdGlvbigpIHsKCQkJCWNyZWF0ZVppcFJlYWRlcihyZWFkZXIsIGNhbGxiYWNrLCBvbmVycm9yKTsKCQkJfSwgb25lcnJvcik7CgkJfSwKCQljcmVhdGVXcml0ZXIgOiBmdW5jdGlvbih3cml0ZXIsIGNhbGxiYWNrLCBvbmVycm9yLCBkb250RGVmbGF0ZSkgewoJCQlvbmVycm9yID0gb25lcnJvciB8fCBvbmVycm9yX2RlZmF1bHQ7CgkJCWRvbnREZWZsYXRlID0gISFkb250RGVmbGF0ZTsKCgkJCXdyaXRlci5pbml0KGZ1bmN0aW9uKCkgewoJCQkJY3JlYXRlWmlwV3JpdGVyKHdyaXRlciwgY2FsbGJhY2ssIG9uZXJyb3IsIGRvbnREZWZsYXRlKTsKCQkJfSwgb25lcnJvcik7CgkJfSwKCQl1c2VXZWJXb3JrZXJzIDogdHJ1ZSwKCQkvKioKCQkgKiBEaXJlY3RvcnkgY29udGFpbmluZyB0aGUgZGVmYXVsdCB3b3JrZXIgc2NyaXB0cyAoei13b3JrZXIuanMsIGRlZmxhdGUuanMsIGFuZCBpbmZsYXRlLmpzKSwgcmVsYXRpdmUgdG8gY3VycmVudCBiYXNlIHVybC4KCQkgKiBFLmcuOiB6aXAud29ya2VyU2NyaXB0cyA9ICcuLyc7CgkJICovCgkJd29ya2VyU2NyaXB0c1BhdGggOiBudWxsLAoJCS8qKgoJCSAqIEFkdmFuY2VkIG9wdGlvbiB0byBjb250cm9sIHdoaWNoIHNjcmlwdHMgYXJlIGxvYWRlZCBpbiB0aGUgV2ViIHdvcmtlci4gSWYgdGhpcyBvcHRpb24gaXMgc3BlY2lmaWVkLCB0aGVuIHdvcmtlclNjcmlwdHNQYXRoIG11c3Qgbm90IGJlIHNldC4KCQkgKiB3b3JrZXJTY3JpcHRzLmRlZmxhdGVyL3dvcmtlclNjcmlwdHMuaW5mbGF0ZXIgc2hvdWxkIGJlIGFycmF5cyBvZiB1cmxzIHRvIHNjcmlwdHMgZm9yIGRlZmxhdGVyL2luZmxhdGVyLCByZXNwZWN0aXZlbHkuCgkJICogU2NyaXB0cyBpbiB0aGUgYXJyYXkgYXJlIGV4ZWN1dGVkIGluIG9yZGVyLCBhbmQgdGhlIGZpcnN0IG9uZSBzaG91bGQgYmUgei13b3JrZXIuanMsIHdoaWNoIGlzIHVzZWQgdG8gc3RhcnQgdGhlIHdvcmtlci4KCQkgKiBBbGwgdXJscyBhcmUgcmVsYXRpdmUgdG8gY3VycmVudCBiYXNlIHVybC4KCQkgKiBFLmcuOgoJCSAqIHppcC53b3JrZXJTY3JpcHRzID0gewoJCSAqICAgZGVmbGF0ZXI6IFsnei13b3JrZXIuanMnLCAnZGVmbGF0ZS5qcyddLAoJCSAqICAgaW5mbGF0ZXI6IFsnei13b3JrZXIuanMnLCAnaW5mbGF0ZS5qcyddCgkJICogfTsKCQkgKi8KCQl3b3JrZXJTY3JpcHRzIDogbnVsbCwKCX07Cgp9KSh0aGlzKTsK"></script>
  <script src="data:application/javascript;base64,LyoKIENvcHlyaWdodCAoYykgMjAxMyBHaWxkYXMgTG9ybWVhdS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KCiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OgoKIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwKIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuCgogMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgCiBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gCiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi4KCiAzLiBUaGUgbmFtZXMgb2YgdGhlIGF1dGhvcnMgbWF5IG5vdCBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cwogZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uCgogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBgYEFTIElTJycgQU5EIEFOWSBFWFBSRVNTRUQgT1IgSU1QTElFRCBXQVJSQU5USUVTLAogSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORAogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIEpDUkFGVCwKIElOQy4gT1IgQU5ZIENPTlRSSUJVVE9SUyBUTyBUSElTIFNPRlRXQVJFIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsCiBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UCiBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwKIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YKIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVCAoSU5DTFVESU5HCiBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsCiBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLgogKi8KCi8qCiAqIFRoaXMgcHJvZ3JhbSBpcyBiYXNlZCBvbiBKWmxpYiAxLjAuMiB5bW5rLCBKQ3JhZnQsSW5jLgogKiBKWmxpYiBpcyBiYXNlZCBvbiB6bGliLTEuMS4zLCBzbyBhbGwgY3JlZGl0IHNob3VsZCBnbyBhdXRob3JzCiAqIEplYW4tbG91cCBHYWlsbHkoamxvdXBAZ3ppcC5vcmcpIGFuZCBNYXJrIEFkbGVyKG1hZGxlckBhbHVtbmkuY2FsdGVjaC5lZHUpCiAqIGFuZCBjb250cmlidXRvcnMgb2YgemxpYi4KICovCgooZnVuY3Rpb24oZ2xvYmFsKSB7CgkidXNlIHN0cmljdCI7CgoJLy8gR2xvYmFsCgl2YXIgTUFYX0JJVFMgPSAxNTsKCgl2YXIgWl9PSyA9IDA7Cgl2YXIgWl9TVFJFQU1fRU5EID0gMTsKCXZhciBaX05FRURfRElDVCA9IDI7Cgl2YXIgWl9TVFJFQU1fRVJST1IgPSAtMjsKCXZhciBaX0RBVEFfRVJST1IgPSAtMzsKCXZhciBaX01FTV9FUlJPUiA9IC00OwoJdmFyIFpfQlVGX0VSUk9SID0gLTU7CgoJdmFyIGluZmxhdGVfbWFzayA9IFsgMHgwMDAwMDAwMCwgMHgwMDAwMDAwMSwgMHgwMDAwMDAwMywgMHgwMDAwMDAwNywgMHgwMDAwMDAwZiwgMHgwMDAwMDAxZiwgMHgwMDAwMDAzZiwgMHgwMDAwMDA3ZiwgMHgwMDAwMDBmZiwgMHgwMDAwMDFmZiwgMHgwMDAwMDNmZiwKCQkJMHgwMDAwMDdmZiwgMHgwMDAwMGZmZiwgMHgwMDAwMWZmZiwgMHgwMDAwM2ZmZiwgMHgwMDAwN2ZmZiwgMHgwMDAwZmZmZiBdOwoKCXZhciBNQU5ZID0gMTQ0MDsKCgkvLyBKWmxpYiB2ZXJzaW9uIDogIjEuMC4yIgoJdmFyIFpfTk9fRkxVU0ggPSAwOwoJdmFyIFpfRklOSVNIID0gNDsKCgkvLyBJbmZUcmVlCgl2YXIgZml4ZWRfYmwgPSA5OwoJdmFyIGZpeGVkX2JkID0gNTsKCgl2YXIgZml4ZWRfdGwgPSBbIDk2LCA3LCAyNTYsIDAsIDgsIDgwLCAwLCA4LCAxNiwgODQsIDgsIDExNSwgODIsIDcsIDMxLCAwLCA4LCAxMTIsIDAsIDgsIDQ4LCAwLCA5LCAxOTIsIDgwLCA3LCAxMCwgMCwgOCwgOTYsIDAsIDgsIDMyLCAwLCA5LCAxNjAsIDAsIDgsIDAsCgkJCTAsIDgsIDEyOCwgMCwgOCwgNjQsIDAsIDksIDIyNCwgODAsIDcsIDYsIDAsIDgsIDg4LCAwLCA4LCAyNCwgMCwgOSwgMTQ0LCA4MywgNywgNTksIDAsIDgsIDEyMCwgMCwgOCwgNTYsIDAsIDksIDIwOCwgODEsIDcsIDE3LCAwLCA4LCAxMDQsIDAsIDgsIDQwLAoJCQkwLCA5LCAxNzYsIDAsIDgsIDgsIDAsIDgsIDEzNiwgMCwgOCwgNzIsIDAsIDksIDI0MCwgODAsIDcsIDQsIDAsIDgsIDg0LCAwLCA4LCAyMCwgODUsIDgsIDIyNywgODMsIDcsIDQzLCAwLCA4LCAxMTYsIDAsIDgsIDUyLCAwLCA5LCAyMDAsIDgxLCA3LCAxMywKCQkJMCwgOCwgMTAwLCAwLCA4LCAzNiwgMCwgOSwgMTY4LCAwLCA4LCA0LCAwLCA4LCAxMzIsIDAsIDgsIDY4LCAwLCA5LCAyMzIsIDgwLCA3LCA4LCAwLCA4LCA5MiwgMCwgOCwgMjgsIDAsIDksIDE1MiwgODQsIDcsIDgzLCAwLCA4LCAxMjQsIDAsIDgsIDYwLAoJCQkwLCA5LCAyMTYsIDgyLCA3LCAyMywgMCwgOCwgMTA4LCAwLCA4LCA0NCwgMCwgOSwgMTg0LCAwLCA4LCAxMiwgMCwgOCwgMTQwLCAwLCA4LCA3NiwgMCwgOSwgMjQ4LCA4MCwgNywgMywgMCwgOCwgODIsIDAsIDgsIDE4LCA4NSwgOCwgMTYzLCA4MywgNywKCQkJMzUsIDAsIDgsIDExNCwgMCwgOCwgNTAsIDAsIDksIDE5NiwgODEsIDcsIDExLCAwLCA4LCA5OCwgMCwgOCwgMzQsIDAsIDksIDE2NCwgMCwgOCwgMiwgMCwgOCwgMTMwLCAwLCA4LCA2NiwgMCwgOSwgMjI4LCA4MCwgNywgNywgMCwgOCwgOTAsIDAsIDgsCgkJCTI2LCAwLCA5LCAxNDgsIDg0LCA3LCA2NywgMCwgOCwgMTIyLCAwLCA4LCA1OCwgMCwgOSwgMjEyLCA4MiwgNywgMTksIDAsIDgsIDEwNiwgMCwgOCwgNDIsIDAsIDksIDE4MCwgMCwgOCwgMTAsIDAsIDgsIDEzOCwgMCwgOCwgNzQsIDAsIDksIDI0NCwgODAsCgkJCTcsIDUsIDAsIDgsIDg2LCAwLCA4LCAyMiwgMTkyLCA4LCAwLCA4MywgNywgNTEsIDAsIDgsIDExOCwgMCwgOCwgNTQsIDAsIDksIDIwNCwgODEsIDcsIDE1LCAwLCA4LCAxMDIsIDAsIDgsIDM4LCAwLCA5LCAxNzIsIDAsIDgsIDYsIDAsIDgsIDEzNCwgMCwKCQkJOCwgNzAsIDAsIDksIDIzNiwgODAsIDcsIDksIDAsIDgsIDk0LCAwLCA4LCAzMCwgMCwgOSwgMTU2LCA4NCwgNywgOTksIDAsIDgsIDEyNiwgMCwgOCwgNjIsIDAsIDksIDIyMCwgODIsIDcsIDI3LCAwLCA4LCAxMTAsIDAsIDgsIDQ2LCAwLCA5LCAxODgsIDAsCgkJCTgsIDE0LCAwLCA4LCAxNDIsIDAsIDgsIDc4LCAwLCA5LCAyNTIsIDk2LCA3LCAyNTYsIDAsIDgsIDgxLCAwLCA4LCAxNywgODUsIDgsIDEzMSwgODIsIDcsIDMxLCAwLCA4LCAxMTMsIDAsIDgsIDQ5LCAwLCA5LCAxOTQsIDgwLCA3LCAxMCwgMCwgOCwgOTcsCgkJCTAsIDgsIDMzLCAwLCA5LCAxNjIsIDAsIDgsIDEsIDAsIDgsIDEyOSwgMCwgOCwgNjUsIDAsIDksIDIyNiwgODAsIDcsIDYsIDAsIDgsIDg5LCAwLCA4LCAyNSwgMCwgOSwgMTQ2LCA4MywgNywgNTksIDAsIDgsIDEyMSwgMCwgOCwgNTcsIDAsIDksIDIxMCwKCQkJODEsIDcsIDE3LCAwLCA4LCAxMDUsIDAsIDgsIDQxLCAwLCA5LCAxNzgsIDAsIDgsIDksIDAsIDgsIDEzNywgMCwgOCwgNzMsIDAsIDksIDI0MiwgODAsIDcsIDQsIDAsIDgsIDg1LCAwLCA4LCAyMSwgODAsIDgsIDI1OCwgODMsIDcsIDQzLCAwLCA4LCAxMTcsCgkJCTAsIDgsIDUzLCAwLCA5LCAyMDIsIDgxLCA3LCAxMywgMCwgOCwgMTAxLCAwLCA4LCAzNywgMCwgOSwgMTcwLCAwLCA4LCA1LCAwLCA4LCAxMzMsIDAsIDgsIDY5LCAwLCA5LCAyMzQsIDgwLCA3LCA4LCAwLCA4LCA5MywgMCwgOCwgMjksIDAsIDksIDE1NCwKCQkJODQsIDcsIDgzLCAwLCA4LCAxMjUsIDAsIDgsIDYxLCAwLCA5LCAyMTgsIDgyLCA3LCAyMywgMCwgOCwgMTA5LCAwLCA4LCA0NSwgMCwgOSwgMTg2LCAwLCA4LCAxMywgMCwgOCwgMTQxLCAwLCA4LCA3NywgMCwgOSwgMjUwLCA4MCwgNywgMywgMCwgOCwgODMsCgkJCTAsIDgsIDE5LCA4NSwgOCwgMTk1LCA4MywgNywgMzUsIDAsIDgsIDExNSwgMCwgOCwgNTEsIDAsIDksIDE5OCwgODEsIDcsIDExLCAwLCA4LCA5OSwgMCwgOCwgMzUsIDAsIDksIDE2NiwgMCwgOCwgMywgMCwgOCwgMTMxLCAwLCA4LCA2NywgMCwgOSwgMjMwLAoJCQk4MCwgNywgNywgMCwgOCwgOTEsIDAsIDgsIDI3LCAwLCA5LCAxNTAsIDg0LCA3LCA2NywgMCwgOCwgMTIzLCAwLCA4LCA1OSwgMCwgOSwgMjE0LCA4MiwgNywgMTksIDAsIDgsIDEwNywgMCwgOCwgNDMsIDAsIDksIDE4MiwgMCwgOCwgMTEsIDAsIDgsIDEzOSwKCQkJMCwgOCwgNzUsIDAsIDksIDI0NiwgODAsIDcsIDUsIDAsIDgsIDg3LCAwLCA4LCAyMywgMTkyLCA4LCAwLCA4MywgNywgNTEsIDAsIDgsIDExOSwgMCwgOCwgNTUsIDAsIDksIDIwNiwgODEsIDcsIDE1LCAwLCA4LCAxMDMsIDAsIDgsIDM5LCAwLCA5LCAxNzQsCgkJCTAsIDgsIDcsIDAsIDgsIDEzNSwgMCwgOCwgNzEsIDAsIDksIDIzOCwgODAsIDcsIDksIDAsIDgsIDk1LCAwLCA4LCAzMSwgMCwgOSwgMTU4LCA4NCwgNywgOTksIDAsIDgsIDEyNywgMCwgOCwgNjMsIDAsIDksIDIyMiwgODIsIDcsIDI3LCAwLCA4LCAxMTEsCgkJCTAsIDgsIDQ3LCAwLCA5LCAxOTAsIDAsIDgsIDE1LCAwLCA4LCAxNDMsIDAsIDgsIDc5LCAwLCA5LCAyNTQsIDk2LCA3LCAyNTYsIDAsIDgsIDgwLCAwLCA4LCAxNiwgODQsIDgsIDExNSwgODIsIDcsIDMxLCAwLCA4LCAxMTIsIDAsIDgsIDQ4LCAwLCA5LAoJCQkxOTMsIDgwLCA3LCAxMCwgMCwgOCwgOTYsIDAsIDgsIDMyLCAwLCA5LCAxNjEsIDAsIDgsIDAsIDAsIDgsIDEyOCwgMCwgOCwgNjQsIDAsIDksIDIyNSwgODAsIDcsIDYsIDAsIDgsIDg4LCAwLCA4LCAyNCwgMCwgOSwgMTQ1LCA4MywgNywgNTksIDAsIDgsCgkJCTEyMCwgMCwgOCwgNTYsIDAsIDksIDIwOSwgODEsIDcsIDE3LCAwLCA4LCAxMDQsIDAsIDgsIDQwLCAwLCA5LCAxNzcsIDAsIDgsIDgsIDAsIDgsIDEzNiwgMCwgOCwgNzIsIDAsIDksIDI0MSwgODAsIDcsIDQsIDAsIDgsIDg0LCAwLCA4LCAyMCwgODUsIDgsCgkJCTIyNywgODMsIDcsIDQzLCAwLCA4LCAxMTYsIDAsIDgsIDUyLCAwLCA5LCAyMDEsIDgxLCA3LCAxMywgMCwgOCwgMTAwLCAwLCA4LCAzNiwgMCwgOSwgMTY5LCAwLCA4LCA0LCAwLCA4LCAxMzIsIDAsIDgsIDY4LCAwLCA5LCAyMzMsIDgwLCA3LCA4LCAwLCA4LAoJCQk5MiwgMCwgOCwgMjgsIDAsIDksIDE1MywgODQsIDcsIDgzLCAwLCA4LCAxMjQsIDAsIDgsIDYwLCAwLCA5LCAyMTcsIDgyLCA3LCAyMywgMCwgOCwgMTA4LCAwLCA4LCA0NCwgMCwgOSwgMTg1LCAwLCA4LCAxMiwgMCwgOCwgMTQwLCAwLCA4LCA3NiwgMCwgOSwKCQkJMjQ5LCA4MCwgNywgMywgMCwgOCwgODIsIDAsIDgsIDE4LCA4NSwgOCwgMTYzLCA4MywgNywgMzUsIDAsIDgsIDExNCwgMCwgOCwgNTAsIDAsIDksIDE5NywgODEsIDcsIDExLCAwLCA4LCA5OCwgMCwgOCwgMzQsIDAsIDksIDE2NSwgMCwgOCwgMiwgMCwgOCwKCQkJMTMwLCAwLCA4LCA2NiwgMCwgOSwgMjI5LCA4MCwgNywgNywgMCwgOCwgOTAsIDAsIDgsIDI2LCAwLCA5LCAxNDksIDg0LCA3LCA2NywgMCwgOCwgMTIyLCAwLCA4LCA1OCwgMCwgOSwgMjEzLCA4MiwgNywgMTksIDAsIDgsIDEwNiwgMCwgOCwgNDIsIDAsIDksCgkJCTE4MSwgMCwgOCwgMTAsIDAsIDgsIDEzOCwgMCwgOCwgNzQsIDAsIDksIDI0NSwgODAsIDcsIDUsIDAsIDgsIDg2LCAwLCA4LCAyMiwgMTkyLCA4LCAwLCA4MywgNywgNTEsIDAsIDgsIDExOCwgMCwgOCwgNTQsIDAsIDksIDIwNSwgODEsIDcsIDE1LCAwLCA4LAoJCQkxMDIsIDAsIDgsIDM4LCAwLCA5LCAxNzMsIDAsIDgsIDYsIDAsIDgsIDEzNCwgMCwgOCwgNzAsIDAsIDksIDIzNywgODAsIDcsIDksIDAsIDgsIDk0LCAwLCA4LCAzMCwgMCwgOSwgMTU3LCA4NCwgNywgOTksIDAsIDgsIDEyNiwgMCwgOCwgNjIsIDAsIDksCgkJCTIyMSwgODIsIDcsIDI3LCAwLCA4LCAxMTAsIDAsIDgsIDQ2LCAwLCA5LCAxODksIDAsIDgsIDE0LCAwLCA4LCAxNDIsIDAsIDgsIDc4LCAwLCA5LCAyNTMsIDk2LCA3LCAyNTYsIDAsIDgsIDgxLCAwLCA4LCAxNywgODUsIDgsIDEzMSwgODIsIDcsIDMxLCAwLAoJCQk4LCAxMTMsIDAsIDgsIDQ5LCAwLCA5LCAxOTUsIDgwLCA3LCAxMCwgMCwgOCwgOTcsIDAsIDgsIDMzLCAwLCA5LCAxNjMsIDAsIDgsIDEsIDAsIDgsIDEyOSwgMCwgOCwgNjUsIDAsIDksIDIyNywgODAsIDcsIDYsIDAsIDgsIDg5LCAwLCA4LCAyNSwgMCwgOSwKCQkJMTQ3LCA4MywgNywgNTksIDAsIDgsIDEyMSwgMCwgOCwgNTcsIDAsIDksIDIxMSwgODEsIDcsIDE3LCAwLCA4LCAxMDUsIDAsIDgsIDQxLCAwLCA5LCAxNzksIDAsIDgsIDksIDAsIDgsIDEzNywgMCwgOCwgNzMsIDAsIDksIDI0MywgODAsIDcsIDQsIDAsIDgsCgkJCTg1LCAwLCA4LCAyMSwgODAsIDgsIDI1OCwgODMsIDcsIDQzLCAwLCA4LCAxMTcsIDAsIDgsIDUzLCAwLCA5LCAyMDMsIDgxLCA3LCAxMywgMCwgOCwgMTAxLCAwLCA4LCAzNywgMCwgOSwgMTcxLCAwLCA4LCA1LCAwLCA4LCAxMzMsIDAsIDgsIDY5LCAwLCA5LAoJCQkyMzUsIDgwLCA3LCA4LCAwLCA4LCA5MywgMCwgOCwgMjksIDAsIDksIDE1NSwgODQsIDcsIDgzLCAwLCA4LCAxMjUsIDAsIDgsIDYxLCAwLCA5LCAyMTksIDgyLCA3LCAyMywgMCwgOCwgMTA5LCAwLCA4LCA0NSwgMCwgOSwgMTg3LCAwLCA4LCAxMywgMCwgOCwKCQkJMTQxLCAwLCA4LCA3NywgMCwgOSwgMjUxLCA4MCwgNywgMywgMCwgOCwgODMsIDAsIDgsIDE5LCA4NSwgOCwgMTk1LCA4MywgNywgMzUsIDAsIDgsIDExNSwgMCwgOCwgNTEsIDAsIDksIDE5OSwgODEsIDcsIDExLCAwLCA4LCA5OSwgMCwgOCwgMzUsIDAsIDksCgkJCTE2NywgMCwgOCwgMywgMCwgOCwgMTMxLCAwLCA4LCA2NywgMCwgOSwgMjMxLCA4MCwgNywgNywgMCwgOCwgOTEsIDAsIDgsIDI3LCAwLCA5LCAxNTEsIDg0LCA3LCA2NywgMCwgOCwgMTIzLCAwLCA4LCA1OSwgMCwgOSwgMjE1LCA4MiwgNywgMTksIDAsIDgsCgkJCTEwNywgMCwgOCwgNDMsIDAsIDksIDE4MywgMCwgOCwgMTEsIDAsIDgsIDEzOSwgMCwgOCwgNzUsIDAsIDksIDI0NywgODAsIDcsIDUsIDAsIDgsIDg3LCAwLCA4LCAyMywgMTkyLCA4LCAwLCA4MywgNywgNTEsIDAsIDgsIDExOSwgMCwgOCwgNTUsIDAsIDksCgkJCTIwNywgODEsIDcsIDE1LCAwLCA4LCAxMDMsIDAsIDgsIDM5LCAwLCA5LCAxNzUsIDAsIDgsIDcsIDAsIDgsIDEzNSwgMCwgOCwgNzEsIDAsIDksIDIzOSwgODAsIDcsIDksIDAsIDgsIDk1LCAwLCA4LCAzMSwgMCwgOSwgMTU5LCA4NCwgNywgOTksIDAsIDgsCgkJCTEyNywgMCwgOCwgNjMsIDAsIDksIDIyMywgODIsIDcsIDI3LCAwLCA4LCAxMTEsIDAsIDgsIDQ3LCAwLCA5LCAxOTEsIDAsIDgsIDE1LCAwLCA4LCAxNDMsIDAsIDgsIDc5LCAwLCA5LCAyNTUgXTsKCXZhciBmaXhlZF90ZCA9IFsgODAsIDUsIDEsIDg3LCA1LCAyNTcsIDgzLCA1LCAxNywgOTEsIDUsIDQwOTcsIDgxLCA1LCA1LCA4OSwgNSwgMTAyNSwgODUsIDUsIDY1LCA5MywgNSwgMTYzODUsIDgwLCA1LCAzLCA4OCwgNSwgNTEzLCA4NCwgNSwgMzMsIDkyLCA1LAoJCQk4MTkzLCA4MiwgNSwgOSwgOTAsIDUsIDIwNDksIDg2LCA1LCAxMjksIDE5MiwgNSwgMjQ1NzcsIDgwLCA1LCAyLCA4NywgNSwgMzg1LCA4MywgNSwgMjUsIDkxLCA1LCA2MTQ1LCA4MSwgNSwgNywgODksIDUsIDE1MzcsIDg1LCA1LCA5NywgOTMsIDUsCgkJCTI0NTc3LCA4MCwgNSwgNCwgODgsIDUsIDc2OSwgODQsIDUsIDQ5LCA5MiwgNSwgMTIyODksIDgyLCA1LCAxMywgOTAsIDUsIDMwNzMsIDg2LCA1LCAxOTMsIDE5MiwgNSwgMjQ1NzcgXTsKCgkvLyBUYWJsZXMgZm9yIGRlZmxhdGUgZnJvbSBQS1pJUCdzIGFwcG5vdGUudHh0LgoJdmFyIGNwbGVucyA9IFsgLy8gQ29weSBsZW5ndGhzIGZvciBsaXRlcmFsIGNvZGVzIDI1Ny4uMjg1CgkzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDEzLCAxNSwgMTcsIDE5LCAyMywgMjcsIDMxLCAzNSwgNDMsIDUxLCA1OSwgNjcsIDgzLCA5OSwgMTE1LCAxMzEsIDE2MywgMTk1LCAyMjcsIDI1OCwgMCwgMCBdOwoKCS8vIHNlZSBub3RlICMxMyBhYm92ZSBhYm91dCAyNTgKCXZhciBjcGxleHQgPSBbIC8vIEV4dHJhIGJpdHMgZm9yIGxpdGVyYWwgY29kZXMgMjU3Li4yODUKCTAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDIsIDIsIDIsIDIsIDMsIDMsIDMsIDMsIDQsIDQsIDQsIDQsIDUsIDUsIDUsIDUsIDAsIDExMiwgMTEyIC8vIDExMj09aW52YWxpZAoJXTsKCgl2YXIgY3BkaXN0ID0gWyAvLyBDb3B5IG9mZnNldHMgZm9yIGRpc3RhbmNlIGNvZGVzIDAuLjI5CgkxLCAyLCAzLCA0LCA1LCA3LCA5LCAxMywgMTcsIDI1LCAzMywgNDksIDY1LCA5NywgMTI5LCAxOTMsIDI1NywgMzg1LCA1MTMsIDc2OSwgMTAyNSwgMTUzNywgMjA0OSwgMzA3MywgNDA5NywgNjE0NSwgODE5MywgMTIyODksIDE2Mzg1LCAyNDU3NyBdOwoKCXZhciBjcGRleHQgPSBbIC8vIEV4dHJhIGJpdHMgZm9yIGRpc3RhbmNlIGNvZGVzCgkwLCAwLCAwLCAwLCAxLCAxLCAyLCAyLCAzLCAzLCA0LCA0LCA1LCA1LCA2LCA2LCA3LCA3LCA4LCA4LCA5LCA5LCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMgXTsKCgkvLyBJZiBCTUFYIG5lZWRzIHRvIGJlIGxhcmdlciB0aGFuIDE2LCB0aGVuIGggYW5kIHhbXSBzaG91bGQgYmUgdUxvbmcuCgl2YXIgQk1BWCA9IDE1OyAvLyBtYXhpbXVtIGJpdCBsZW5ndGggb2YgYW55IGNvZGUKCglmdW5jdGlvbiBJbmZUcmVlKCkgewoJCXZhciB0aGF0ID0gdGhpczsKCgkJdmFyIGhuOyAvLyBodWZ0cyB1c2VkIGluIHNwYWNlCgkJdmFyIHY7IC8vIHdvcmsgYXJlYSBmb3IgaHVmdF9idWlsZAoJCXZhciBjOyAvLyBiaXQgbGVuZ3RoIGNvdW50IHRhYmxlCgkJdmFyIHI7IC8vIHRhYmxlIGVudHJ5IGZvciBzdHJ1Y3R1cmUgYXNzaWdubWVudAoJCXZhciB1OyAvLyB0YWJsZSBzdGFjawoJCXZhciB4OyAvLyBiaXQgb2Zmc2V0cywgdGhlbiBjb2RlIHN0YWNrCgoJCWZ1bmN0aW9uIGh1ZnRfYnVpbGQoYiwgLy8gY29kZSBsZW5ndGhzIGluIGJpdHMgKGFsbCBhc3N1bWVkIDw9CgkJLy8gQk1BWCkKCQliaW5kZXgsIG4sIC8vIG51bWJlciBvZiBjb2RlcyAoYXNzdW1lZCA8PSAyODgpCgkJcywgLy8gbnVtYmVyIG9mIHNpbXBsZS12YWx1ZWQgY29kZXMgKDAuLnMtMSkKCQlkLCAvLyBsaXN0IG9mIGJhc2UgdmFsdWVzIGZvciBub24tc2ltcGxlIGNvZGVzCgkJZSwgLy8gbGlzdCBvZiBleHRyYSBiaXRzIGZvciBub24tc2ltcGxlIGNvZGVzCgkJdCwgLy8gcmVzdWx0OiBzdGFydGluZyB0YWJsZQoJCW0sIC8vIG1heGltdW0gbG9va3VwIGJpdHMsIHJldHVybnMgYWN0dWFsCgkJaHAsLy8gc3BhY2UgZm9yIHRyZWVzCgkJaG4sLy8gaHVmdHMgdXNlZCBpbiBzcGFjZQoJCXYgLy8gd29ya2luZyBhcmVhOiB2YWx1ZXMgaW4gb3JkZXIgb2YgYml0IGxlbmd0aAoJCSkgewoJCQkvLyBHaXZlbiBhIGxpc3Qgb2YgY29kZSBsZW5ndGhzIGFuZCBhIG1heGltdW0gdGFibGUgc2l6ZSwgbWFrZSBhIHNldCBvZgoJCQkvLyB0YWJsZXMgdG8gZGVjb2RlIHRoYXQgc2V0IG9mIGNvZGVzLiBSZXR1cm4gWl9PSyBvbiBzdWNjZXNzLAoJCQkvLyBaX0JVRl9FUlJPUgoJCQkvLyBpZiB0aGUgZ2l2ZW4gY29kZSBzZXQgaXMgaW5jb21wbGV0ZSAodGhlIHRhYmxlcyBhcmUgc3RpbGwgYnVpbHQgaW4KCQkJLy8gdGhpcwoJCQkvLyBjYXNlKSwgWl9EQVRBX0VSUk9SIGlmIHRoZSBpbnB1dCBpcyBpbnZhbGlkIChhbiBvdmVyLXN1YnNjcmliZWQgc2V0CgkJCS8vIG9mCgkJCS8vIGxlbmd0aHMpLCBvciBaX01FTV9FUlJPUiBpZiBub3QgZW5vdWdoIG1lbW9yeS4KCgkJCXZhciBhOyAvLyBjb3VudGVyIGZvciBjb2RlcyBvZiBsZW5ndGggawoJCQl2YXIgZjsgLy8gaSByZXBlYXRzIGluIHRhYmxlIGV2ZXJ5IGYgZW50cmllcwoJCQl2YXIgZzsgLy8gbWF4aW11bSBjb2RlIGxlbmd0aAoJCQl2YXIgaDsgLy8gdGFibGUgbGV2ZWwKCQkJdmFyIGk7IC8vIGNvdW50ZXIsIGN1cnJlbnQgY29kZQoJCQl2YXIgajsgLy8gY291bnRlcgoJCQl2YXIgazsgLy8gbnVtYmVyIG9mIGJpdHMgaW4gY3VycmVudCBjb2RlCgkJCXZhciBsOyAvLyBiaXRzIHBlciB0YWJsZSAocmV0dXJuZWQgaW4gbSkKCQkJdmFyIG1hc2s7IC8vICgxIDw8IHcpIC0gMSwgdG8gYXZvaWQgY2MgLU8gYnVnIG9uIEhQCgkJCXZhciBwOyAvLyBwb2ludGVyIGludG8gY1tdLCBiW10sIG9yIHZbXQoJCQl2YXIgcTsgLy8gcG9pbnRzIHRvIGN1cnJlbnQgdGFibGUKCQkJdmFyIHc7IC8vIGJpdHMgYmVmb3JlIHRoaXMgdGFibGUgPT0gKGwgKiBoKQoJCQl2YXIgeHA7IC8vIHBvaW50ZXIgaW50byB4CgkJCXZhciB5OyAvLyBudW1iZXIgb2YgZHVtbXkgY29kZXMgYWRkZWQKCQkJdmFyIHo7IC8vIG51bWJlciBvZiBlbnRyaWVzIGluIGN1cnJlbnQgdGFibGUKCgkJCS8vIEdlbmVyYXRlIGNvdW50cyBmb3IgZWFjaCBiaXQgbGVuZ3RoCgoJCQlwID0gMDsKCQkJaSA9IG47CgkJCWRvIHsKCQkJCWNbYltiaW5kZXggKyBwXV0rKzsKCQkJCXArKzsKCQkJCWktLTsgLy8gYXNzdW1lIGFsbCBlbnRyaWVzIDw9IEJNQVgKCQkJfSB3aGlsZSAoaSAhPT0gMCk7CgoJCQlpZiAoY1swXSA9PSBuKSB7IC8vIG51bGwgaW5wdXQtLWFsbCB6ZXJvIGxlbmd0aCBjb2RlcwoJCQkJdFswXSA9IC0xOwoJCQkJbVswXSA9IDA7CgkJCQlyZXR1cm4gWl9PSzsKCQkJfQoKCQkJLy8gRmluZCBtaW5pbXVtIGFuZCBtYXhpbXVtIGxlbmd0aCwgYm91bmQgKm0gYnkgdGhvc2UKCQkJbCA9IG1bMF07CgkJCWZvciAoaiA9IDE7IGogPD0gQk1BWDsgaisrKQoJCQkJaWYgKGNbal0gIT09IDApCgkJCQkJYnJlYWs7CgkJCWsgPSBqOyAvLyBtaW5pbXVtIGNvZGUgbGVuZ3RoCgkJCWlmIChsIDwgaikgewoJCQkJbCA9IGo7CgkJCX0KCQkJZm9yIChpID0gQk1BWDsgaSAhPT0gMDsgaS0tKSB7CgkJCQlpZiAoY1tpXSAhPT0gMCkKCQkJCQlicmVhazsKCQkJfQoJCQlnID0gaTsgLy8gbWF4aW11bSBjb2RlIGxlbmd0aAoJCQlpZiAobCA+IGkpIHsKCQkJCWwgPSBpOwoJCQl9CgkJCW1bMF0gPSBsOwoKCQkJLy8gQWRqdXN0IGxhc3QgbGVuZ3RoIGNvdW50IHRvIGZpbGwgb3V0IGNvZGVzLCBpZiBuZWVkZWQKCQkJZm9yICh5ID0gMSA8PCBqOyBqIDwgaTsgaisrLCB5IDw8PSAxKSB7CgkJCQlpZiAoKHkgLT0gY1tqXSkgPCAwKSB7CgkJCQkJcmV0dXJuIFpfREFUQV9FUlJPUjsKCQkJCX0KCQkJfQoJCQlpZiAoKHkgLT0gY1tpXSkgPCAwKSB7CgkJCQlyZXR1cm4gWl9EQVRBX0VSUk9SOwoJCQl9CgkJCWNbaV0gKz0geTsKCgkJCS8vIEdlbmVyYXRlIHN0YXJ0aW5nIG9mZnNldHMgaW50byB0aGUgdmFsdWUgdGFibGUgZm9yIGVhY2ggbGVuZ3RoCgkJCXhbMV0gPSBqID0gMDsKCQkJcCA9IDE7CgkJCXhwID0gMjsKCQkJd2hpbGUgKC0taSAhPT0gMCkgeyAvLyBub3RlIHRoYXQgaSA9PSBnIGZyb20gYWJvdmUKCQkJCXhbeHBdID0gKGogKz0gY1twXSk7CgkJCQl4cCsrOwoJCQkJcCsrOwoJCQl9CgoJCQkvLyBNYWtlIGEgdGFibGUgb2YgdmFsdWVzIGluIG9yZGVyIG9mIGJpdCBsZW5ndGhzCgkJCWkgPSAwOwoJCQlwID0gMDsKCQkJZG8gewoJCQkJaWYgKChqID0gYltiaW5kZXggKyBwXSkgIT09IDApIHsKCQkJCQl2W3hbal0rK10gPSBpOwoJCQkJfQoJCQkJcCsrOwoJCQl9IHdoaWxlICgrK2kgPCBuKTsKCQkJbiA9IHhbZ107IC8vIHNldCBuIHRvIGxlbmd0aCBvZiB2CgoJCQkvLyBHZW5lcmF0ZSB0aGUgSHVmZm1hbiBjb2RlcyBhbmQgZm9yIGVhY2gsIG1ha2UgdGhlIHRhYmxlIGVudHJpZXMKCQkJeFswXSA9IGkgPSAwOyAvLyBmaXJzdCBIdWZmbWFuIGNvZGUgaXMgemVybwoJCQlwID0gMDsgLy8gZ3JhYiB2YWx1ZXMgaW4gYml0IG9yZGVyCgkJCWggPSAtMTsgLy8gbm8gdGFibGVzIHlldC0tbGV2ZWwgLTEKCQkJdyA9IC1sOyAvLyBiaXRzIGRlY29kZWQgPT0gKGwgKiBoKQoJCQl1WzBdID0gMDsgLy8ganVzdCB0byBrZWVwIGNvbXBpbGVycyBoYXBweQoJCQlxID0gMDsgLy8gZGl0dG8KCQkJeiA9IDA7IC8vIGRpdHRvCgoJCQkvLyBnbyB0aHJvdWdoIHRoZSBiaXQgbGVuZ3RocyAoayBhbHJlYWR5IGlzIGJpdHMgaW4gc2hvcnRlc3QgY29kZSkKCQkJZm9yICg7IGsgPD0gZzsgaysrKSB7CgkJCQlhID0gY1trXTsKCQkJCXdoaWxlIChhLS0gIT09IDApIHsKCQkJCQkvLyBoZXJlIGkgaXMgdGhlIEh1ZmZtYW4gY29kZSBvZiBsZW5ndGggayBiaXRzIGZvciB2YWx1ZSAqcAoJCQkJCS8vIG1ha2UgdGFibGVzIHVwIHRvIHJlcXVpcmVkIGxldmVsCgkJCQkJd2hpbGUgKGsgPiB3ICsgbCkgewoJCQkJCQloKys7CgkJCQkJCXcgKz0gbDsgLy8gcHJldmlvdXMgdGFibGUgYWx3YXlzIGwgYml0cwoJCQkJCQkvLyBjb21wdXRlIG1pbmltdW0gc2l6ZSB0YWJsZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gbCBiaXRzCgkJCQkJCXogPSBnIC0gdzsKCQkJCQkJeiA9ICh6ID4gbCkgPyBsIDogejsgLy8gdGFibGUgc2l6ZSB1cHBlciBsaW1pdAoJCQkJCQlpZiAoKGYgPSAxIDw8IChqID0gayAtIHcpKSA+IGEgKyAxKSB7IC8vIHRyeSBhIGstdyBiaXQgdGFibGUKCQkJCQkJCS8vIHRvbyBmZXcgY29kZXMgZm9yCgkJCQkJCQkvLyBrLXcgYml0IHRhYmxlCgkJCQkJCQlmIC09IGEgKyAxOyAvLyBkZWR1Y3QgY29kZXMgZnJvbSBwYXR0ZXJucyBsZWZ0CgkJCQkJCQl4cCA9IGs7CgkJCQkJCQlpZiAoaiA8IHopIHsKCQkJCQkJCQl3aGlsZSAoKytqIDwgeikgeyAvLyB0cnkgc21hbGxlciB0YWJsZXMgdXAgdG8geiBiaXRzCgkJCQkJCQkJCWlmICgoZiA8PD0gMSkgPD0gY1srK3hwXSkKCQkJCQkJCQkJCWJyZWFrOyAvLyBlbm91Z2ggY29kZXMgdG8gdXNlIHVwIGogYml0cwoJCQkJCQkJCQlmIC09IGNbeHBdOyAvLyBlbHNlIGRlZHVjdCBjb2RlcyBmcm9tIHBhdHRlcm5zCgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXogPSAxIDw8IGo7IC8vIHRhYmxlIGVudHJpZXMgZm9yIGotYml0IHRhYmxlCgoJCQkJCQkvLyBhbGxvY2F0ZSBuZXcgdGFibGUKCQkJCQkJaWYgKGhuWzBdICsgeiA+IE1BTlkpIHsgLy8gKG5vdGU6IGRvZXNuJ3QgbWF0dGVyIGZvciBmaXhlZCkKCQkJCQkJCXJldHVybiBaX0RBVEFfRVJST1I7IC8vIG92ZXJmbG93IG9mIE1BTlkKCQkJCQkJfQoJCQkJCQl1W2hdID0gcSA9IC8qIGhwKyAqL2huWzBdOyAvLyBERUJVRwoJCQkJCQloblswXSArPSB6OwoKCQkJCQkJLy8gY29ubmVjdCB0byBsYXN0IHRhYmxlLCBpZiB0aGVyZSBpcyBvbmUKCQkJCQkJaWYgKGggIT09IDApIHsKCQkJCQkJCXhbaF0gPSBpOyAvLyBzYXZlIHBhdHRlcm4gZm9yIGJhY2tpbmcgdXAKCQkJCQkJCXJbMF0gPSAvKiAoYnl0ZSkgKi9qOyAvLyBiaXRzIGluIHRoaXMgdGFibGUKCQkJCQkJCXJbMV0gPSAvKiAoYnl0ZSkgKi9sOyAvLyBiaXRzIHRvIGR1bXAgYmVmb3JlIHRoaXMgdGFibGUKCQkJCQkJCWogPSBpID4+PiAodyAtIGwpOwoJCQkJCQkJclsyXSA9IC8qIChpbnQpICovKHEgLSB1W2ggLSAxXSAtIGopOyAvLyBvZmZzZXQgdG8gdGhpcyB0YWJsZQoJCQkJCQkJaHAuc2V0KHIsICh1W2ggLSAxXSArIGopICogMyk7CgkJCQkJCQkvLyB0bwoJCQkJCQkJLy8gbGFzdAoJCQkJCQkJLy8gdGFibGUKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCXRbMF0gPSBxOyAvLyBmaXJzdCB0YWJsZSBpcyByZXR1cm5lZCByZXN1bHQKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gc2V0IHVwIHRhYmxlIGVudHJ5IGluIHIKCQkJCQlyWzFdID0gLyogKGJ5dGUpICovKGsgLSB3KTsKCQkJCQlpZiAocCA+PSBuKSB7CgkJCQkJCXJbMF0gPSAxMjggKyA2NDsgLy8gb3V0IG9mIHZhbHVlcy0taW52YWxpZCBjb2RlCgkJCQkJfSBlbHNlIGlmICh2W3BdIDwgcykgewoJCQkJCQlyWzBdID0gLyogKGJ5dGUpICovKHZbcF0gPCAyNTYgPyAwIDogMzIgKyA2NCk7IC8vIDI1NiBpcwoJCQkJCQkvLyBlbmQtb2YtYmxvY2sKCQkJCQkJclsyXSA9IHZbcCsrXTsgLy8gc2ltcGxlIGNvZGUgaXMganVzdCB0aGUgdmFsdWUKCQkJCQl9IGVsc2UgewoJCQkJCQlyWzBdID0gLyogKGJ5dGUpICovKGVbdltwXSAtIHNdICsgMTYgKyA2NCk7IC8vIG5vbi1zaW1wbGUtLWxvb2sKCQkJCQkJLy8gdXAgaW4gbGlzdHMKCQkJCQkJclsyXSA9IGRbdltwKytdIC0gc107CgkJCQkJfQoKCQkJCQkvLyBmaWxsIGNvZGUtbGlrZSBlbnRyaWVzIHdpdGggcgoJCQkJCWYgPSAxIDw8IChrIC0gdyk7CgkJCQkJZm9yIChqID0gaSA+Pj4gdzsgaiA8IHo7IGogKz0gZikgewoJCQkJCQlocC5zZXQociwgKHEgKyBqKSAqIDMpOwoJCQkJCX0KCgkJCQkJLy8gYmFja3dhcmRzIGluY3JlbWVudCB0aGUgay1iaXQgY29kZSBpCgkJCQkJZm9yIChqID0gMSA8PCAoayAtIDEpOyAoaSAmIGopICE9PSAwOyBqID4+Pj0gMSkgewoJCQkJCQlpIF49IGo7CgkJCQkJfQoJCQkJCWkgXj0gajsKCgkJCQkJLy8gYmFja3VwIG92ZXIgZmluaXNoZWQgdGFibGVzCgkJCQkJbWFzayA9ICgxIDw8IHcpIC0gMTsgLy8gbmVlZGVkIG9uIEhQLCBjYyAtTyBidWcKCQkJCQl3aGlsZSAoKGkgJiBtYXNrKSAhPSB4W2hdKSB7CgkJCQkJCWgtLTsgLy8gZG9uJ3QgbmVlZCB0byB1cGRhdGUgcQoJCQkJCQl3IC09IGw7CgkJCQkJCW1hc2sgPSAoMSA8PCB3KSAtIDE7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCS8vIFJldHVybiBaX0JVRl9FUlJPUiBpZiB3ZSB3ZXJlIGdpdmVuIGFuIGluY29tcGxldGUgdGFibGUKCQkJcmV0dXJuIHkgIT09IDAgJiYgZyAhPSAxID8gWl9CVUZfRVJST1IgOiBaX09LOwoJCX0KCgkJZnVuY3Rpb24gaW5pdFdvcmtBcmVhKHZzaXplKSB7CgkJCXZhciBpOwoJCQlpZiAoIWhuKSB7CgkJCQlobiA9IFtdOyAvLyBbXTsgLy9uZXcgQXJyYXkoMSk7CgkJCQl2ID0gW107IC8vIG5ldyBBcnJheSh2c2l6ZSk7CgkJCQljID0gbmV3IEludDMyQXJyYXkoQk1BWCArIDEpOyAvLyBuZXcgQXJyYXkoQk1BWCArIDEpOwoJCQkJciA9IFtdOyAvLyBuZXcgQXJyYXkoMyk7CgkJCQl1ID0gbmV3IEludDMyQXJyYXkoQk1BWCk7IC8vIG5ldyBBcnJheShCTUFYKTsKCQkJCXggPSBuZXcgSW50MzJBcnJheShCTUFYICsgMSk7IC8vIG5ldyBBcnJheShCTUFYICsgMSk7CgkJCX0KCQkJaWYgKHYubGVuZ3RoIDwgdnNpemUpIHsKCQkJCXYgPSBbXTsgLy8gbmV3IEFycmF5KHZzaXplKTsKCQkJfQoJCQlmb3IgKGkgPSAwOyBpIDwgdnNpemU7IGkrKykgewoJCQkJdltpXSA9IDA7CgkJCX0KCQkJZm9yIChpID0gMDsgaSA8IEJNQVggKyAxOyBpKyspIHsKCQkJCWNbaV0gPSAwOwoJCQl9CgkJCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKCQkJCXJbaV0gPSAwOwoJCQl9CgkJCS8vIGZvcihpbnQgaT0wOyBpPEJNQVg7IGkrKyl7dVtpXT0wO30KCQkJdS5zZXQoYy5zdWJhcnJheSgwLCBCTUFYKSwgMCk7CgkJCS8vIGZvcihpbnQgaT0wOyBpPEJNQVgrMTsgaSsrKXt4W2ldPTA7fQoJCQl4LnNldChjLnN1YmFycmF5KDAsIEJNQVggKyAxKSwgMCk7CgkJfQoKCQl0aGF0LmluZmxhdGVfdHJlZXNfYml0cyA9IGZ1bmN0aW9uKGMsIC8vIDE5IGNvZGUgbGVuZ3RocwoJCWJiLCAvLyBiaXRzIHRyZWUgZGVzaXJlZC9hY3R1YWwgZGVwdGgKCQl0YiwgLy8gYml0cyB0cmVlIHJlc3VsdAoJCWhwLCAvLyBzcGFjZSBmb3IgdHJlZXMKCQl6IC8vIGZvciBtZXNzYWdlcwoJCSkgewoJCQl2YXIgcmVzdWx0OwoJCQlpbml0V29ya0FyZWEoMTkpOwoJCQloblswXSA9IDA7CgkJCXJlc3VsdCA9IGh1ZnRfYnVpbGQoYywgMCwgMTksIDE5LCBudWxsLCBudWxsLCB0YiwgYmIsIGhwLCBobiwgdik7CgoJCQlpZiAocmVzdWx0ID09IFpfREFUQV9FUlJPUikgewoJCQkJei5tc2cgPSAib3ZlcnN1YnNjcmliZWQgZHluYW1pYyBiaXQgbGVuZ3RocyB0cmVlIjsKCQkJfSBlbHNlIGlmIChyZXN1bHQgPT0gWl9CVUZfRVJST1IgfHwgYmJbMF0gPT09IDApIHsKCQkJCXoubXNnID0gImluY29tcGxldGUgZHluYW1pYyBiaXQgbGVuZ3RocyB0cmVlIjsKCQkJCXJlc3VsdCA9IFpfREFUQV9FUlJPUjsKCQkJfQoJCQlyZXR1cm4gcmVzdWx0OwoJCX07CgoJCXRoYXQuaW5mbGF0ZV90cmVlc19keW5hbWljID0gZnVuY3Rpb24obmwsIC8vIG51bWJlciBvZiBsaXRlcmFsL2xlbmd0aCBjb2RlcwoJCW5kLCAvLyBudW1iZXIgb2YgZGlzdGFuY2UgY29kZXMKCQljLCAvLyB0aGF0IG1hbnkgKHRvdGFsKSBjb2RlIGxlbmd0aHMKCQlibCwgLy8gbGl0ZXJhbCBkZXNpcmVkL2FjdHVhbCBiaXQgZGVwdGgKCQliZCwgLy8gZGlzdGFuY2UgZGVzaXJlZC9hY3R1YWwgYml0IGRlcHRoCgkJdGwsIC8vIGxpdGVyYWwvbGVuZ3RoIHRyZWUgcmVzdWx0CgkJdGQsIC8vIGRpc3RhbmNlIHRyZWUgcmVzdWx0CgkJaHAsIC8vIHNwYWNlIGZvciB0cmVlcwoJCXogLy8gZm9yIG1lc3NhZ2VzCgkJKSB7CgkJCXZhciByZXN1bHQ7CgoJCQkvLyBidWlsZCBsaXRlcmFsL2xlbmd0aCB0cmVlCgkJCWluaXRXb3JrQXJlYSgyODgpOwoJCQloblswXSA9IDA7CgkJCXJlc3VsdCA9IGh1ZnRfYnVpbGQoYywgMCwgbmwsIDI1NywgY3BsZW5zLCBjcGxleHQsIHRsLCBibCwgaHAsIGhuLCB2KTsKCQkJaWYgKHJlc3VsdCAhPSBaX09LIHx8IGJsWzBdID09PSAwKSB7CgkJCQlpZiAocmVzdWx0ID09IFpfREFUQV9FUlJPUikgewoJCQkJCXoubXNnID0gIm92ZXJzdWJzY3JpYmVkIGxpdGVyYWwvbGVuZ3RoIHRyZWUiOwoJCQkJfSBlbHNlIGlmIChyZXN1bHQgIT0gWl9NRU1fRVJST1IpIHsKCQkJCQl6Lm1zZyA9ICJpbmNvbXBsZXRlIGxpdGVyYWwvbGVuZ3RoIHRyZWUiOwoJCQkJCXJlc3VsdCA9IFpfREFUQV9FUlJPUjsKCQkJCX0KCQkJCXJldHVybiByZXN1bHQ7CgkJCX0KCgkJCS8vIGJ1aWxkIGRpc3RhbmNlIHRyZWUKCQkJaW5pdFdvcmtBcmVhKDI4OCk7CgkJCXJlc3VsdCA9IGh1ZnRfYnVpbGQoYywgbmwsIG5kLCAwLCBjcGRpc3QsIGNwZGV4dCwgdGQsIGJkLCBocCwgaG4sIHYpOwoKCQkJaWYgKHJlc3VsdCAhPSBaX09LIHx8IChiZFswXSA9PT0gMCAmJiBubCA+IDI1NykpIHsKCQkJCWlmIChyZXN1bHQgPT0gWl9EQVRBX0VSUk9SKSB7CgkJCQkJei5tc2cgPSAib3ZlcnN1YnNjcmliZWQgZGlzdGFuY2UgdHJlZSI7CgkJCQl9IGVsc2UgaWYgKHJlc3VsdCA9PSBaX0JVRl9FUlJPUikgewoJCQkJCXoubXNnID0gImluY29tcGxldGUgZGlzdGFuY2UgdHJlZSI7CgkJCQkJcmVzdWx0ID0gWl9EQVRBX0VSUk9SOwoJCQkJfSBlbHNlIGlmIChyZXN1bHQgIT0gWl9NRU1fRVJST1IpIHsKCQkJCQl6Lm1zZyA9ICJlbXB0eSBkaXN0YW5jZSB0cmVlIHdpdGggbGVuZ3RocyI7CgkJCQkJcmVzdWx0ID0gWl9EQVRBX0VSUk9SOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3VsdDsKCQkJfQoKCQkJcmV0dXJuIFpfT0s7CgkJfTsKCgl9CgoJSW5mVHJlZS5pbmZsYXRlX3RyZWVzX2ZpeGVkID0gZnVuY3Rpb24oYmwsIC8vIGxpdGVyYWwgZGVzaXJlZC9hY3R1YWwgYml0IGRlcHRoCgliZCwgLy8gZGlzdGFuY2UgZGVzaXJlZC9hY3R1YWwgYml0IGRlcHRoCgl0bCwvLyBsaXRlcmFsL2xlbmd0aCB0cmVlIHJlc3VsdAoJdGQvLyBkaXN0YW5jZSB0cmVlIHJlc3VsdAoJKSB7CgkJYmxbMF0gPSBmaXhlZF9ibDsKCQliZFswXSA9IGZpeGVkX2JkOwoJCXRsWzBdID0gZml4ZWRfdGw7CgkJdGRbMF0gPSBmaXhlZF90ZDsKCQlyZXR1cm4gWl9PSzsKCX07CgoJLy8gSW5mQ29kZXMKCgkvLyB3YWl0aW5nIGZvciAiaToiPWlucHV0LAoJLy8gIm86Ij1vdXRwdXQsCgkvLyAieDoiPW5vdGhpbmcKCXZhciBTVEFSVCA9IDA7IC8vIHg6IHNldCB1cCBmb3IgTEVOCgl2YXIgTEVOID0gMTsgLy8gaTogZ2V0IGxlbmd0aC9saXRlcmFsL2VvYiBuZXh0Cgl2YXIgTEVORVhUID0gMjsgLy8gaTogZ2V0dGluZyBsZW5ndGggZXh0cmEgKGhhdmUgYmFzZSkKCXZhciBESVNUID0gMzsgLy8gaTogZ2V0IGRpc3RhbmNlIG5leHQKCXZhciBESVNURVhUID0gNDsvLyBpOiBnZXR0aW5nIGRpc3RhbmNlIGV4dHJhCgl2YXIgQ09QWSA9IDU7IC8vIG86IGNvcHlpbmcgYnl0ZXMgaW4gd2luZG93LCB3YWl0aW5nCgkvLyBmb3Igc3BhY2UKCXZhciBMSVQgPSA2OyAvLyBvOiBnb3QgbGl0ZXJhbCwgd2FpdGluZyBmb3Igb3V0cHV0CgkvLyBzcGFjZQoJdmFyIFdBU0ggPSA3OyAvLyBvOiBnb3QgZW9iLCBwb3NzaWJseSBzdGlsbCBvdXRwdXQKCS8vIHdhaXRpbmcKCXZhciBFTkQgPSA4OyAvLyB4OiBnb3QgZW9iIGFuZCBhbGwgZGF0YSBmbHVzaGVkCgl2YXIgQkFEQ09ERSA9IDk7Ly8geDogZ290IGVycm9yCgoJZnVuY3Rpb24gSW5mQ29kZXMoKSB7CgkJdmFyIHRoYXQgPSB0aGlzOwoKCQl2YXIgbW9kZTsgLy8gY3VycmVudCBpbmZsYXRlX2NvZGVzIG1vZGUKCgkJLy8gbW9kZSBkZXBlbmRlbnQgaW5mb3JtYXRpb24KCQl2YXIgbGVuID0gMDsKCgkJdmFyIHRyZWU7IC8vIHBvaW50ZXIgaW50byB0cmVlCgkJdmFyIHRyZWVfaW5kZXggPSAwOwoJCXZhciBuZWVkID0gMDsgLy8gYml0cyBuZWVkZWQKCgkJdmFyIGxpdCA9IDA7CgoJCS8vIGlmIEVYVCBvciBDT1BZLCB3aGVyZSBhbmQgaG93IG11Y2gKCQl2YXIgZ2V0ID0gMDsgLy8gYml0cyB0byBnZXQgZm9yIGV4dHJhCgkJdmFyIGRpc3QgPSAwOyAvLyBkaXN0YW5jZSBiYWNrIHRvIGNvcHkgZnJvbQoKCQl2YXIgbGJpdHMgPSAwOyAvLyBsdHJlZSBiaXRzIGRlY29kZWQgcGVyIGJyYW5jaAoJCXZhciBkYml0cyA9IDA7IC8vIGR0cmVlIGJpdHMgZGVjb2RlciBwZXIgYnJhbmNoCgkJdmFyIGx0cmVlOyAvLyBsaXRlcmFsL2xlbmd0aC9lb2IgdHJlZQoJCXZhciBsdHJlZV9pbmRleCA9IDA7IC8vIGxpdGVyYWwvbGVuZ3RoL2VvYiB0cmVlCgkJdmFyIGR0cmVlOyAvLyBkaXN0YW5jZSB0cmVlCgkJdmFyIGR0cmVlX2luZGV4ID0gMDsgLy8gZGlzdGFuY2UgdHJlZQoKCQkvLyBDYWxsZWQgd2l0aCBudW1iZXIgb2YgYnl0ZXMgbGVmdCB0byB3cml0ZSBpbiB3aW5kb3cgYXQgbGVhc3QgMjU4CgkJLy8gKHRoZSBtYXhpbXVtIHN0cmluZyBsZW5ndGgpIGFuZCBudW1iZXIgb2YgaW5wdXQgYnl0ZXMgYXZhaWxhYmxlCgkJLy8gYXQgbGVhc3QgdGVuLiBUaGUgdGVuIGJ5dGVzIGFyZSBzaXggYnl0ZXMgZm9yIHRoZSBsb25nZXN0IGxlbmd0aC8KCQkvLyBkaXN0YW5jZSBwYWlyIHBsdXMgZm91ciBieXRlcyBmb3Igb3ZlcmxvYWRpbmcgdGhlIGJpdCBidWZmZXIuCgoJCWZ1bmN0aW9uIGluZmxhdGVfZmFzdChibCwgYmQsIHRsLCB0bF9pbmRleCwgdGQsIHRkX2luZGV4LCBzLCB6KSB7CgkJCXZhciB0OyAvLyB0ZW1wb3JhcnkgcG9pbnRlcgoJCQl2YXIgdHA7IC8vIHRlbXBvcmFyeSBwb2ludGVyCgkJCXZhciB0cF9pbmRleDsgLy8gdGVtcG9yYXJ5IHBvaW50ZXIKCQkJdmFyIGU7IC8vIGV4dHJhIGJpdHMgb3Igb3BlcmF0aW9uCgkJCXZhciBiOyAvLyBiaXQgYnVmZmVyCgkJCXZhciBrOyAvLyBiaXRzIGluIGJpdCBidWZmZXIKCQkJdmFyIHA7IC8vIGlucHV0IGRhdGEgcG9pbnRlcgoJCQl2YXIgbjsgLy8gYnl0ZXMgYXZhaWxhYmxlIHRoZXJlCgkJCXZhciBxOyAvLyBvdXRwdXQgd2luZG93IHdyaXRlIHBvaW50ZXIKCQkJdmFyIG07IC8vIGJ5dGVzIHRvIGVuZCBvZiB3aW5kb3cgb3IgcmVhZCBwb2ludGVyCgkJCXZhciBtbDsgLy8gbWFzayBmb3IgbGl0ZXJhbC9sZW5ndGggdHJlZQoJCQl2YXIgbWQ7IC8vIG1hc2sgZm9yIGRpc3RhbmNlIHRyZWUKCQkJdmFyIGM7IC8vIGJ5dGVzIHRvIGNvcHkKCQkJdmFyIGQ7IC8vIGRpc3RhbmNlIGJhY2sgdG8gY29weSBmcm9tCgkJCXZhciByOyAvLyBjb3B5IHNvdXJjZSBwb2ludGVyCgoJCQl2YXIgdHBfaW5kZXhfdF8zOyAvLyAodHBfaW5kZXgrdCkqMwoKCQkJLy8gbG9hZCBpbnB1dCwgb3V0cHV0LCBiaXQgdmFsdWVzCgkJCXAgPSB6Lm5leHRfaW5faW5kZXg7CgkJCW4gPSB6LmF2YWlsX2luOwoJCQliID0gcy5iaXRiOwoJCQlrID0gcy5iaXRrOwoJCQlxID0gcy53cml0ZTsKCQkJbSA9IHEgPCBzLnJlYWQgPyBzLnJlYWQgLSBxIC0gMSA6IHMuZW5kIC0gcTsKCgkJCS8vIGluaXRpYWxpemUgbWFza3MKCQkJbWwgPSBpbmZsYXRlX21hc2tbYmxdOwoJCQltZCA9IGluZmxhdGVfbWFza1tiZF07CgoJCQkvLyBkbyB1bnRpbCBub3QgZW5vdWdoIGlucHV0IG9yIG91dHB1dCBzcGFjZSBmb3IgZmFzdCBsb29wCgkJCWRvIHsgLy8gYXNzdW1lIGNhbGxlZCB3aXRoIG0gPj0gMjU4ICYmIG4gPj0gMTAKCQkJCS8vIGdldCBsaXRlcmFsL2xlbmd0aCBjb2RlCgkJCQl3aGlsZSAoayA8ICgyMCkpIHsgLy8gbWF4IGJpdHMgZm9yIGxpdGVyYWwvbGVuZ3RoIGNvZGUKCQkJCQluLS07CgkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJayArPSA4OwoJCQkJfQoKCQkJCXQgPSBiICYgbWw7CgkJCQl0cCA9IHRsOwoJCQkJdHBfaW5kZXggPSB0bF9pbmRleDsKCQkJCXRwX2luZGV4X3RfMyA9ICh0cF9pbmRleCArIHQpICogMzsKCQkJCWlmICgoZSA9IHRwW3RwX2luZGV4X3RfM10pID09PSAwKSB7CgkJCQkJYiA+Pj0gKHRwW3RwX2luZGV4X3RfMyArIDFdKTsKCQkJCQlrIC09ICh0cFt0cF9pbmRleF90XzMgKyAxXSk7CgoJCQkJCXMud2luZG93W3ErK10gPSAvKiAoYnl0ZSkgKi90cFt0cF9pbmRleF90XzMgKyAyXTsKCQkJCQltLS07CgkJCQkJY29udGludWU7CgkJCQl9CgkJCQlkbyB7CgoJCQkJCWIgPj49ICh0cFt0cF9pbmRleF90XzMgKyAxXSk7CgkJCQkJayAtPSAodHBbdHBfaW5kZXhfdF8zICsgMV0pOwoKCQkJCQlpZiAoKGUgJiAxNikgIT09IDApIHsKCQkJCQkJZSAmPSAxNTsKCQkJCQkJYyA9IHRwW3RwX2luZGV4X3RfMyArIDJdICsgKC8qIChpbnQpICovYiAmIGluZmxhdGVfbWFza1tlXSk7CgoJCQkJCQliID4+PSBlOwoJCQkJCQlrIC09IGU7CgoJCQkJCQkvLyBkZWNvZGUgZGlzdGFuY2UgYmFzZSBvZiBibG9jayB0byBjb3B5CgkJCQkJCXdoaWxlIChrIDwgKDE1KSkgeyAvLyBtYXggYml0cyBmb3IgZGlzdGFuY2UgY29kZQoJCQkJCQkJbi0tOwoJCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCQlrICs9IDg7CgkJCQkJCX0KCgkJCQkJCXQgPSBiICYgbWQ7CgkJCQkJCXRwID0gdGQ7CgkJCQkJCXRwX2luZGV4ID0gdGRfaW5kZXg7CgkJCQkJCXRwX2luZGV4X3RfMyA9ICh0cF9pbmRleCArIHQpICogMzsKCQkJCQkJZSA9IHRwW3RwX2luZGV4X3RfM107CgoJCQkJCQlkbyB7CgoJCQkJCQkJYiA+Pj0gKHRwW3RwX2luZGV4X3RfMyArIDFdKTsKCQkJCQkJCWsgLT0gKHRwW3RwX2luZGV4X3RfMyArIDFdKTsKCgkJCQkJCQlpZiAoKGUgJiAxNikgIT09IDApIHsKCQkJCQkJCQkvLyBnZXQgZXh0cmEgYml0cyB0byBhZGQgdG8gZGlzdGFuY2UgYmFzZQoJCQkJCQkJCWUgJj0gMTU7CgkJCQkJCQkJd2hpbGUgKGsgPCAoZSkpIHsgLy8gZ2V0IGV4dHJhIGJpdHMgKHVwIHRvIDEzKQoJCQkJCQkJCQluLS07CgkJCQkJCQkJCWIgfD0gKHoucmVhZF9ieXRlKHArKykgJiAweGZmKSA8PCBrOwoJCQkJCQkJCQlrICs9IDg7CgkJCQkJCQkJfQoKCQkJCQkJCQlkID0gdHBbdHBfaW5kZXhfdF8zICsgMl0gKyAoYiAmIGluZmxhdGVfbWFza1tlXSk7CgoJCQkJCQkJCWIgPj49IChlKTsKCQkJCQkJCQlrIC09IChlKTsKCgkJCQkJCQkJLy8gZG8gdGhlIGNvcHkKCQkJCQkJCQltIC09IGM7CgkJCQkJCQkJaWYgKHEgPj0gZCkgeyAvLyBvZmZzZXQgYmVmb3JlIGRlc3QKCQkJCQkJCQkJLy8ganVzdCBjb3B5CgkJCQkJCQkJCXIgPSBxIC0gZDsKCQkJCQkJCQkJaWYgKHEgLSByID4gMCAmJiAyID4gKHEgLSByKSkgewoJCQkJCQkJCQkJcy53aW5kb3dbcSsrXSA9IHMud2luZG93W3IrK107IC8vIG1pbmltdW0KCQkJCQkJCQkJCS8vIGNvdW50IGlzCgkJCQkJCQkJCQkvLyB0aHJlZSwKCQkJCQkJCQkJCXMud2luZG93W3ErK10gPSBzLndpbmRvd1tyKytdOyAvLyBzbyB1bnJvbGwKCQkJCQkJCQkJCS8vIGxvb3AgYQoJCQkJCQkJCQkJLy8gbGl0dGxlCgkJCQkJCQkJCQljIC09IDI7CgkJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCQlzLndpbmRvdy5zZXQocy53aW5kb3cuc3ViYXJyYXkociwgciArIDIpLCBxKTsKCQkJCQkJCQkJCXEgKz0gMjsKCQkJCQkJCQkJCXIgKz0gMjsKCQkJCQkJCQkJCWMgLT0gMjsKCQkJCQkJCQkJfQoJCQkJCQkJCX0gZWxzZSB7IC8vIGVsc2Ugb2Zmc2V0IGFmdGVyIGRlc3RpbmF0aW9uCgkJCQkJCQkJCXIgPSBxIC0gZDsKCQkJCQkJCQkJZG8gewoJCQkJCQkJCQkJciArPSBzLmVuZDsgLy8gZm9yY2UgcG9pbnRlciBpbiB3aW5kb3cKCQkJCQkJCQkJfSB3aGlsZSAociA8IDApOyAvLyBjb3ZlcnMgaW52YWxpZCBkaXN0YW5jZXMKCQkJCQkJCQkJZSA9IHMuZW5kIC0gcjsKCQkJCQkJCQkJaWYgKGMgPiBlKSB7IC8vIGlmIHNvdXJjZSBjcm9zc2VzLAoJCQkJCQkJCQkJYyAtPSBlOyAvLyB3cmFwcGVkIGNvcHkKCQkJCQkJCQkJCWlmIChxIC0gciA+IDAgJiYgZSA+IChxIC0gcikpIHsKCQkJCQkJCQkJCQlkbyB7CgkJCQkJCQkJCQkJCXMud2luZG93W3ErK10gPSBzLndpbmRvd1tyKytdOwoJCQkJCQkJCQkJCX0gd2hpbGUgKC0tZSAhPT0gMCk7CgkJCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQkJCXMud2luZG93LnNldChzLndpbmRvdy5zdWJhcnJheShyLCByICsgZSksIHEpOwoJCQkJCQkJCQkJCXEgKz0gZTsKCQkJCQkJCQkJCQlyICs9IGU7CgkJCQkJCQkJCQkJZSA9IDA7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCQlyID0gMDsgLy8gY29weSByZXN0IGZyb20gc3RhcnQgb2Ygd2luZG93CgkJCQkJCQkJCX0KCgkJCQkJCQkJfQoKCQkJCQkJCQkvLyBjb3B5IGFsbCBvciB3aGF0J3MgbGVmdAoJCQkJCQkJCWlmIChxIC0gciA+IDAgJiYgYyA+IChxIC0gcikpIHsKCQkJCQkJCQkJZG8gewoJCQkJCQkJCQkJcy53aW5kb3dbcSsrXSA9IHMud2luZG93W3IrK107CgkJCQkJCQkJCX0gd2hpbGUgKC0tYyAhPT0gMCk7CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJcy53aW5kb3cuc2V0KHMud2luZG93LnN1YmFycmF5KHIsIHIgKyBjKSwgcSk7CgkJCQkJCQkJCXEgKz0gYzsKCQkJCQkJCQkJciArPSBjOwoJCQkJCQkJCQljID0gMDsKCQkJCQkJCQl9CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9IGVsc2UgaWYgKChlICYgNjQpID09PSAwKSB7CgkJCQkJCQkJdCArPSB0cFt0cF9pbmRleF90XzMgKyAyXTsKCQkJCQkJCQl0ICs9IChiICYgaW5mbGF0ZV9tYXNrW2VdKTsKCQkJCQkJCQl0cF9pbmRleF90XzMgPSAodHBfaW5kZXggKyB0KSAqIDM7CgkJCQkJCQkJZSA9IHRwW3RwX2luZGV4X3RfM107CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCXoubXNnID0gImludmFsaWQgZGlzdGFuY2UgY29kZSI7CgoJCQkJCQkJCWMgPSB6LmF2YWlsX2luIC0gbjsKCQkJCQkJCQljID0gKGsgPj4gMykgPCBjID8gayA+PiAzIDogYzsKCQkJCQkJCQluICs9IGM7CgkJCQkJCQkJcCAtPSBjOwoJCQkJCQkJCWsgLT0gYyA8PCAzOwoKCQkJCQkJCQlzLmJpdGIgPSBiOwoJCQkJCQkJCXMuYml0ayA9IGs7CgkJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQkJcy53cml0ZSA9IHE7CgoJCQkJCQkJCXJldHVybiBaX0RBVEFfRVJST1I7CgkJCQkJCQl9CgkJCQkJCX0gd2hpbGUgKHRydWUpOwoJCQkJCQlicmVhazsKCQkJCQl9CgoJCQkJCWlmICgoZSAmIDY0KSA9PT0gMCkgewoJCQkJCQl0ICs9IHRwW3RwX2luZGV4X3RfMyArIDJdOwoJCQkJCQl0ICs9IChiICYgaW5mbGF0ZV9tYXNrW2VdKTsKCQkJCQkJdHBfaW5kZXhfdF8zID0gKHRwX2luZGV4ICsgdCkgKiAzOwoJCQkJCQlpZiAoKGUgPSB0cFt0cF9pbmRleF90XzNdKSA9PT0gMCkgewoKCQkJCQkJCWIgPj49ICh0cFt0cF9pbmRleF90XzMgKyAxXSk7CgkJCQkJCQlrIC09ICh0cFt0cF9pbmRleF90XzMgKyAxXSk7CgoJCQkJCQkJcy53aW5kb3dbcSsrXSA9IC8qIChieXRlKSAqL3RwW3RwX2luZGV4X3RfMyArIDJdOwoJCQkJCQkJbS0tOwoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9IGVsc2UgaWYgKChlICYgMzIpICE9PSAwKSB7CgoJCQkJCQljID0gei5hdmFpbF9pbiAtIG47CgkJCQkJCWMgPSAoayA+PiAzKSA8IGMgPyBrID4+IDMgOiBjOwoJCQkJCQluICs9IGM7CgkJCQkJCXAgLT0gYzsKCQkJCQkJayAtPSBjIDw8IDM7CgoJCQkJCQlzLmJpdGIgPSBiOwoJCQkJCQlzLmJpdGsgPSBrOwoJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQlzLndyaXRlID0gcTsKCgkJCQkJCXJldHVybiBaX1NUUkVBTV9FTkQ7CgkJCQkJfSBlbHNlIHsKCQkJCQkJei5tc2cgPSAiaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlIjsKCgkJCQkJCWMgPSB6LmF2YWlsX2luIC0gbjsKCQkJCQkJYyA9IChrID4+IDMpIDwgYyA/IGsgPj4gMyA6IGM7CgkJCQkJCW4gKz0gYzsKCQkJCQkJcCAtPSBjOwoJCQkJCQlrIC09IGMgPDwgMzsKCgkJCQkJCXMuYml0YiA9IGI7CgkJCQkJCXMuYml0ayA9IGs7CgkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCXMud3JpdGUgPSBxOwoKCQkJCQkJcmV0dXJuIFpfREFUQV9FUlJPUjsKCQkJCQl9CgkJCQl9IHdoaWxlICh0cnVlKTsKCQkJfSB3aGlsZSAobSA+PSAyNTggJiYgbiA+PSAxMCk7CgoJCQkvLyBub3QgZW5vdWdoIGlucHV0IG9yIG91dHB1dC0tcmVzdG9yZSBwb2ludGVycyBhbmQgcmV0dXJuCgkJCWMgPSB6LmF2YWlsX2luIC0gbjsKCQkJYyA9IChrID4+IDMpIDwgYyA/IGsgPj4gMyA6IGM7CgkJCW4gKz0gYzsKCQkJcCAtPSBjOwoJCQlrIC09IGMgPDwgMzsKCgkJCXMuYml0YiA9IGI7CgkJCXMuYml0ayA9IGs7CgkJCXouYXZhaWxfaW4gPSBuOwoJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCXMud3JpdGUgPSBxOwoKCQkJcmV0dXJuIFpfT0s7CgkJfQoKCQl0aGF0LmluaXQgPSBmdW5jdGlvbihibCwgYmQsIHRsLCB0bF9pbmRleCwgdGQsIHRkX2luZGV4KSB7CgkJCW1vZGUgPSBTVEFSVDsKCQkJbGJpdHMgPSAvKiAoYnl0ZSkgKi9ibDsKCQkJZGJpdHMgPSAvKiAoYnl0ZSkgKi9iZDsKCQkJbHRyZWUgPSB0bDsKCQkJbHRyZWVfaW5kZXggPSB0bF9pbmRleDsKCQkJZHRyZWUgPSB0ZDsKCQkJZHRyZWVfaW5kZXggPSB0ZF9pbmRleDsKCQkJdHJlZSA9IG51bGw7CgkJfTsKCgkJdGhhdC5wcm9jID0gZnVuY3Rpb24ocywgeiwgcikgewoJCQl2YXIgajsgLy8gdGVtcG9yYXJ5IHN0b3JhZ2UKCQkJdmFyIHRpbmRleDsgLy8gdGVtcG9yYXJ5IHBvaW50ZXIKCQkJdmFyIGU7IC8vIGV4dHJhIGJpdHMgb3Igb3BlcmF0aW9uCgkJCXZhciBiID0gMDsgLy8gYml0IGJ1ZmZlcgoJCQl2YXIgayA9IDA7IC8vIGJpdHMgaW4gYml0IGJ1ZmZlcgoJCQl2YXIgcCA9IDA7IC8vIGlucHV0IGRhdGEgcG9pbnRlcgoJCQl2YXIgbjsgLy8gYnl0ZXMgYXZhaWxhYmxlIHRoZXJlCgkJCXZhciBxOyAvLyBvdXRwdXQgd2luZG93IHdyaXRlIHBvaW50ZXIKCQkJdmFyIG07IC8vIGJ5dGVzIHRvIGVuZCBvZiB3aW5kb3cgb3IgcmVhZCBwb2ludGVyCgkJCXZhciBmOyAvLyBwb2ludGVyIHRvIGNvcHkgc3RyaW5ncyBmcm9tCgoJCQkvLyBjb3B5IGlucHV0L291dHB1dCBpbmZvcm1hdGlvbiB0byBsb2NhbHMgKFVQREFURSBtYWNybyByZXN0b3JlcykKCQkJcCA9IHoubmV4dF9pbl9pbmRleDsKCQkJbiA9IHouYXZhaWxfaW47CgkJCWIgPSBzLmJpdGI7CgkJCWsgPSBzLmJpdGs7CgkJCXEgPSBzLndyaXRlOwoJCQltID0gcSA8IHMucmVhZCA/IHMucmVhZCAtIHEgLSAxIDogcy5lbmQgLSBxOwoKCQkJLy8gcHJvY2VzcyBpbnB1dCBhbmQgb3V0cHV0IGJhc2VkIG9uIGN1cnJlbnQgc3RhdGUKCQkJd2hpbGUgKHRydWUpIHsKCQkJCXN3aXRjaCAobW9kZSkgewoJCQkJLy8gd2FpdGluZyBmb3IgImk6Ij1pbnB1dCwgIm86Ij1vdXRwdXQsICJ4OiI9bm90aGluZwoJCQkJY2FzZSBTVEFSVDogLy8geDogc2V0IHVwIGZvciBMRU4KCQkJCQlpZiAobSA+PSAyNTggJiYgbiA+PSAxMCkgewoKCQkJCQkJcy5iaXRiID0gYjsKCQkJCQkJcy5iaXRrID0gazsKCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJcy53cml0ZSA9IHE7CgkJCQkJCXIgPSBpbmZsYXRlX2Zhc3QobGJpdHMsIGRiaXRzLCBsdHJlZSwgbHRyZWVfaW5kZXgsIGR0cmVlLCBkdHJlZV9pbmRleCwgcywgeik7CgoJCQkJCQlwID0gei5uZXh0X2luX2luZGV4OwoJCQkJCQluID0gei5hdmFpbF9pbjsKCQkJCQkJYiA9IHMuYml0YjsKCQkJCQkJayA9IHMuYml0azsKCQkJCQkJcSA9IHMud3JpdGU7CgkJCQkJCW0gPSBxIDwgcy5yZWFkID8gcy5yZWFkIC0gcSAtIDEgOiBzLmVuZCAtIHE7CgoJCQkJCQlpZiAociAhPSBaX09LKSB7CgkJCQkJCQltb2RlID0gciA9PSBaX1NUUkVBTV9FTkQgPyBXQVNIIDogQkFEQ09ERTsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCW5lZWQgPSBsYml0czsKCQkJCQl0cmVlID0gbHRyZWU7CgkJCQkJdHJlZV9pbmRleCA9IGx0cmVlX2luZGV4OwoKCQkJCQltb2RlID0gTEVOOwoJCQkJCS8qIGZhbGxzIHRocm91Z2ggKi8KCQkJCWNhc2UgTEVOOiAvLyBpOiBnZXQgbGVuZ3RoL2xpdGVyYWwvZW9iIG5leHQKCQkJCQlqID0gbmVlZDsKCgkJCQkJd2hpbGUgKGsgPCAoaikpIHsKCQkJCQkJaWYgKG4gIT09IDApCgkJCQkJCQlyID0gWl9PSzsKCQkJCQkJZWxzZSB7CgoJCQkJCQkJcy5iaXRiID0gYjsKCQkJCQkJCXMuYml0ayA9IGs7CgkJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQlzLndyaXRlID0gcTsKCQkJCQkJCXJldHVybiBzLmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJCX0KCQkJCQkJbi0tOwoJCQkJCQliIHw9ICh6LnJlYWRfYnl0ZShwKyspICYgMHhmZikgPDwgazsKCQkJCQkJayArPSA4OwoJCQkJCX0KCgkJCQkJdGluZGV4ID0gKHRyZWVfaW5kZXggKyAoYiAmIGluZmxhdGVfbWFza1tqXSkpICogMzsKCgkJCQkJYiA+Pj49ICh0cmVlW3RpbmRleCArIDFdKTsKCQkJCQlrIC09ICh0cmVlW3RpbmRleCArIDFdKTsKCgkJCQkJZSA9IHRyZWVbdGluZGV4XTsKCgkJCQkJaWYgKGUgPT09IDApIHsgLy8gbGl0ZXJhbAoJCQkJCQlsaXQgPSB0cmVlW3RpbmRleCArIDJdOwoJCQkJCQltb2RlID0gTElUOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJaWYgKChlICYgMTYpICE9PSAwKSB7IC8vIGxlbmd0aAoJCQkJCQlnZXQgPSBlICYgMTU7CgkJCQkJCWxlbiA9IHRyZWVbdGluZGV4ICsgMl07CgkJCQkJCW1vZGUgPSBMRU5FWFQ7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQlpZiAoKGUgJiA2NCkgPT09IDApIHsgLy8gbmV4dCB0YWJsZQoJCQkJCQluZWVkID0gZTsKCQkJCQkJdHJlZV9pbmRleCA9IHRpbmRleCAvIDMgKyB0cmVlW3RpbmRleCArIDJdOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJaWYgKChlICYgMzIpICE9PSAwKSB7IC8vIGVuZCBvZiBibG9jawoJCQkJCQltb2RlID0gV0FTSDsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCW1vZGUgPSBCQURDT0RFOyAvLyBpbnZhbGlkIGNvZGUKCQkJCQl6Lm1zZyA9ICJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGUiOwoJCQkJCXIgPSBaX0RBVEFfRVJST1I7CgoJCQkJCXMuYml0YiA9IGI7CgkJCQkJcy5iaXRrID0gazsKCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQlzLndyaXRlID0gcTsKCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoKCQkJCWNhc2UgTEVORVhUOiAvLyBpOiBnZXR0aW5nIGxlbmd0aCBleHRyYSAoaGF2ZSBiYXNlKQoJCQkJCWogPSBnZXQ7CgoJCQkJCXdoaWxlIChrIDwgKGopKSB7CgkJCQkJCWlmIChuICE9PSAwKQoJCQkJCQkJciA9IFpfT0s7CgkJCQkJCWVsc2UgewoKCQkJCQkJCXMuYml0YiA9IGI7CgkJCQkJCQlzLmJpdGsgPSBrOwoJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQkJcy53cml0ZSA9IHE7CgkJCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQl9CgkJCQkJCW4tLTsKCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCWsgKz0gODsKCQkJCQl9CgoJCQkJCWxlbiArPSAoYiAmIGluZmxhdGVfbWFza1tqXSk7CgoJCQkJCWIgPj49IGo7CgkJCQkJayAtPSBqOwoKCQkJCQluZWVkID0gZGJpdHM7CgkJCQkJdHJlZSA9IGR0cmVlOwoJCQkJCXRyZWVfaW5kZXggPSBkdHJlZV9pbmRleDsKCQkJCQltb2RlID0gRElTVDsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIERJU1Q6IC8vIGk6IGdldCBkaXN0YW5jZSBuZXh0CgkJCQkJaiA9IG5lZWQ7CgoJCQkJCXdoaWxlIChrIDwgKGopKSB7CgkJCQkJCWlmIChuICE9PSAwKQoJCQkJCQkJciA9IFpfT0s7CgkJCQkJCWVsc2UgewoKCQkJCQkJCXMuYml0YiA9IGI7CgkJCQkJCQlzLmJpdGsgPSBrOwoJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQkJcy53cml0ZSA9IHE7CgkJCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQl9CgkJCQkJCW4tLTsKCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCWsgKz0gODsKCQkJCQl9CgoJCQkJCXRpbmRleCA9ICh0cmVlX2luZGV4ICsgKGIgJiBpbmZsYXRlX21hc2tbal0pKSAqIDM7CgoJCQkJCWIgPj49IHRyZWVbdGluZGV4ICsgMV07CgkJCQkJayAtPSB0cmVlW3RpbmRleCArIDFdOwoKCQkJCQllID0gKHRyZWVbdGluZGV4XSk7CgkJCQkJaWYgKChlICYgMTYpICE9PSAwKSB7IC8vIGRpc3RhbmNlCgkJCQkJCWdldCA9IGUgJiAxNTsKCQkJCQkJZGlzdCA9IHRyZWVbdGluZGV4ICsgMl07CgkJCQkJCW1vZGUgPSBESVNURVhUOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJaWYgKChlICYgNjQpID09PSAwKSB7IC8vIG5leHQgdGFibGUKCQkJCQkJbmVlZCA9IGU7CgkJCQkJCXRyZWVfaW5kZXggPSB0aW5kZXggLyAzICsgdHJlZVt0aW5kZXggKyAyXTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCW1vZGUgPSBCQURDT0RFOyAvLyBpbnZhbGlkIGNvZGUKCQkJCQl6Lm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIGNvZGUiOwoJCQkJCXIgPSBaX0RBVEFfRVJST1I7CgoJCQkJCXMuYml0YiA9IGI7CgkJCQkJcy5iaXRrID0gazsKCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQlzLndyaXRlID0gcTsKCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoKCQkJCWNhc2UgRElTVEVYVDogLy8gaTogZ2V0dGluZyBkaXN0YW5jZSBleHRyYQoJCQkJCWogPSBnZXQ7CgoJCQkJCXdoaWxlIChrIDwgKGopKSB7CgkJCQkJCWlmIChuICE9PSAwKQoJCQkJCQkJciA9IFpfT0s7CgkJCQkJCWVsc2UgewoKCQkJCQkJCXMuYml0YiA9IGI7CgkJCQkJCQlzLmJpdGsgPSBrOwoJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQkJcy53cml0ZSA9IHE7CgkJCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQl9CgkJCQkJCW4tLTsKCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCWsgKz0gODsKCQkJCQl9CgoJCQkJCWRpc3QgKz0gKGIgJiBpbmZsYXRlX21hc2tbal0pOwoKCQkJCQliID4+PSBqOwoJCQkJCWsgLT0gajsKCgkJCQkJbW9kZSA9IENPUFk7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBDT1BZOiAvLyBvOiBjb3B5aW5nIGJ5dGVzIGluIHdpbmRvdywgd2FpdGluZyBmb3Igc3BhY2UKCQkJCQlmID0gcSAtIGRpc3Q7CgkJCQkJd2hpbGUgKGYgPCAwKSB7IC8vIG1vZHVsbyB3aW5kb3cgc2l6ZS0id2hpbGUiIGluc3RlYWQKCQkJCQkJZiArPSBzLmVuZDsgLy8gb2YgImlmIiBoYW5kbGVzIGludmFsaWQgZGlzdGFuY2VzCgkJCQkJfQoJCQkJCXdoaWxlIChsZW4gIT09IDApIHsKCgkJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCQlpZiAocSA9PSBzLmVuZCAmJiBzLnJlYWQgIT09IDApIHsKCQkJCQkJCQlxID0gMDsKCQkJCQkJCQltID0gcSA8IHMucmVhZCA/IHMucmVhZCAtIHEgLSAxIDogcy5lbmQgLSBxOwoJCQkJCQkJfQoJCQkJCQkJaWYgKG0gPT09IDApIHsKCQkJCQkJCQlzLndyaXRlID0gcTsKCQkJCQkJCQlyID0gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJCXEgPSBzLndyaXRlOwoJCQkJCQkJCW0gPSBxIDwgcy5yZWFkID8gcy5yZWFkIC0gcSAtIDEgOiBzLmVuZCAtIHE7CgoJCQkJCQkJCWlmIChxID09IHMuZW5kICYmIHMucmVhZCAhPT0gMCkgewoJCQkJCQkJCQlxID0gMDsKCQkJCQkJCQkJbSA9IHEgPCBzLnJlYWQgPyBzLnJlYWQgLSBxIC0gMSA6IHMuZW5kIC0gcTsKCQkJCQkJCQl9CgoJCQkJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCQkJCXMuYml0YiA9IGI7CgkJCQkJCQkJCXMuYml0ayA9IGs7CgkJCQkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQkJCXMud3JpdGUgPSBxOwoJCQkJCQkJCQlyZXR1cm4gcy5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJcy53aW5kb3dbcSsrXSA9IHMud2luZG93W2YrK107CgkJCQkJCW0tLTsKCgkJCQkJCWlmIChmID09IHMuZW5kKQoJCQkJCQkJZiA9IDA7CgkJCQkJCWxlbi0tOwoJCQkJCX0KCQkJCQltb2RlID0gU1RBUlQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIExJVDogLy8gbzogZ290IGxpdGVyYWwsIHdhaXRpbmcgZm9yIG91dHB1dCBzcGFjZQoJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCWlmIChxID09IHMuZW5kICYmIHMucmVhZCAhPT0gMCkgewoJCQkJCQkJcSA9IDA7CgkJCQkJCQltID0gcSA8IHMucmVhZCA/IHMucmVhZCAtIHEgLSAxIDogcy5lbmQgLSBxOwoJCQkJCQl9CgkJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCQlzLndyaXRlID0gcTsKCQkJCQkJCXIgPSBzLmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJCQlxID0gcy53cml0ZTsKCQkJCQkJCW0gPSBxIDwgcy5yZWFkID8gcy5yZWFkIC0gcSAtIDEgOiBzLmVuZCAtIHE7CgoJCQkJCQkJaWYgKHEgPT0gcy5lbmQgJiYgcy5yZWFkICE9PSAwKSB7CgkJCQkJCQkJcSA9IDA7CgkJCQkJCQkJbSA9IHEgPCBzLnJlYWQgPyBzLnJlYWQgLSBxIC0gMSA6IHMuZW5kIC0gcTsKCQkJCQkJCX0KCQkJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCQkJcy5iaXRiID0gYjsKCQkJCQkJCQlzLmJpdGsgPSBrOwoJCQkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQkJCXMud3JpdGUgPSBxOwoJCQkJCQkJCXJldHVybiBzLmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJciA9IFpfT0s7CgoJCQkJCXMud2luZG93W3ErK10gPSAvKiAoYnl0ZSkgKi9saXQ7CgkJCQkJbS0tOwoKCQkJCQltb2RlID0gU1RBUlQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIFdBU0g6IC8vIG86IGdvdCBlb2IsIHBvc3NpYmx5IG1vcmUgb3V0cHV0CgkJCQkJaWYgKGsgPiA3KSB7IC8vIHJldHVybiB1bnVzZWQgYnl0ZSwgaWYgYW55CgkJCQkJCWsgLT0gODsKCQkJCQkJbisrOwoJCQkJCQlwLS07IC8vIGNhbiBhbHdheXMgcmV0dXJuIG9uZQoJCQkJCX0KCgkJCQkJcy53cml0ZSA9IHE7CgkJCQkJciA9IHMuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQlxID0gcy53cml0ZTsKCQkJCQltID0gcSA8IHMucmVhZCA/IHMucmVhZCAtIHEgLSAxIDogcy5lbmQgLSBxOwoKCQkJCQlpZiAocy5yZWFkICE9IHMud3JpdGUpIHsKCQkJCQkJcy5iaXRiID0gYjsKCQkJCQkJcy5iaXRrID0gazsKCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJcy53cml0ZSA9IHE7CgkJCQkJCXJldHVybiBzLmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJfQoJCQkJCW1vZGUgPSBFTkQ7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBFTkQ6CgkJCQkJciA9IFpfU1RSRUFNX0VORDsKCQkJCQlzLmJpdGIgPSBiOwoJCQkJCXMuYml0ayA9IGs7CgkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJcy53cml0ZSA9IHE7CgkJCQkJcmV0dXJuIHMuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCgkJCQljYXNlIEJBRENPREU6IC8vIHg6IGdvdCBlcnJvcgoKCQkJCQlyID0gWl9EQVRBX0VSUk9SOwoKCQkJCQlzLmJpdGIgPSBiOwoJCQkJCXMuYml0ayA9IGs7CgkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJcy53cml0ZSA9IHE7CgkJCQkJcmV0dXJuIHMuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCgkJCQlkZWZhdWx0OgoJCQkJCXIgPSBaX1NUUkVBTV9FUlJPUjsKCgkJCQkJcy5iaXRiID0gYjsKCQkJCQlzLmJpdGsgPSBrOwoJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCXMud3JpdGUgPSBxOwoJCQkJCXJldHVybiBzLmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQl9CgkJCX0KCQl9OwoKCQl0aGF0LmZyZWUgPSBmdW5jdGlvbigpIHsKCQkJLy8gWkZSRUUoeiwgYyk7CgkJfTsKCgl9CgoJLy8gSW5mQmxvY2tzCgoJLy8gVGFibGUgZm9yIGRlZmxhdGUgZnJvbSBQS1pJUCdzIGFwcG5vdGUudHh0LgoJdmFyIGJvcmRlciA9IFsgLy8gT3JkZXIgb2YgdGhlIGJpdCBsZW5ndGggY29kZSBsZW5ndGhzCgkxNiwgMTcsIDE4LCAwLCA4LCA3LCA5LCA2LCAxMCwgNSwgMTEsIDQsIDEyLCAzLCAxMywgMiwgMTQsIDEsIDE1IF07CgoJdmFyIFRZUEUgPSAwOyAvLyBnZXQgdHlwZSBiaXRzICgzLCBpbmNsdWRpbmcgZW5kIGJpdCkKCXZhciBMRU5TID0gMTsgLy8gZ2V0IGxlbmd0aHMgZm9yIHN0b3JlZAoJdmFyIFNUT1JFRCA9IDI7Ly8gcHJvY2Vzc2luZyBzdG9yZWQgYmxvY2sKCXZhciBUQUJMRSA9IDM7IC8vIGdldCB0YWJsZSBsZW5ndGhzCgl2YXIgQlRSRUUgPSA0OyAvLyBnZXQgYml0IGxlbmd0aHMgdHJlZSBmb3IgYSBkeW5hbWljCgkvLyBibG9jawoJdmFyIERUUkVFID0gNTsgLy8gZ2V0IGxlbmd0aCwgZGlzdGFuY2UgdHJlZXMgZm9yIGEKCS8vIGR5bmFtaWMgYmxvY2sKCXZhciBDT0RFUyA9IDY7IC8vIHByb2Nlc3NpbmcgZml4ZWQgb3IgZHluYW1pYyBibG9jawoJdmFyIERSWSA9IDc7IC8vIG91dHB1dCByZW1haW5pbmcgd2luZG93IGJ5dGVzCgl2YXIgRE9ORUxPQ0tTID0gODsgLy8gZmluaXNoZWQgbGFzdCBibG9jaywgZG9uZQoJdmFyIEJBREJMT0NLUyA9IDk7IC8vIG90IGEgZGF0YSBlcnJvci0tc3R1Y2sgaGVyZQoKCWZ1bmN0aW9uIEluZkJsb2Nrcyh6LCB3KSB7CgkJdmFyIHRoYXQgPSB0aGlzOwoKCQl2YXIgbW9kZSA9IFRZUEU7IC8vIGN1cnJlbnQgaW5mbGF0ZV9ibG9jayBtb2RlCgoJCXZhciBsZWZ0ID0gMDsgLy8gaWYgU1RPUkVELCBieXRlcyBsZWZ0IHRvIGNvcHkKCgkJdmFyIHRhYmxlID0gMDsgLy8gdGFibGUgbGVuZ3RocyAoMTQgYml0cykKCQl2YXIgaW5kZXggPSAwOyAvLyBpbmRleCBpbnRvIGJsZW5zIChvciBib3JkZXIpCgkJdmFyIGJsZW5zOyAvLyBiaXQgbGVuZ3RocyBvZiBjb2RlcwoJCXZhciBiYiA9IFsgMCBdOyAvLyBiaXQgbGVuZ3RoIHRyZWUgZGVwdGgKCQl2YXIgdGIgPSBbIDAgXTsgLy8gYml0IGxlbmd0aCBkZWNvZGluZyB0cmVlCgoJCXZhciBjb2RlcyA9IG5ldyBJbmZDb2RlcygpOyAvLyBpZiBDT0RFUywgY3VycmVudCBzdGF0ZQoKCQl2YXIgbGFzdCA9IDA7IC8vIHRydWUgaWYgdGhpcyBibG9jayBpcyB0aGUgbGFzdCBibG9jawoKCQl2YXIgaHVmdHMgPSBuZXcgSW50MzJBcnJheShNQU5ZICogMyk7IC8vIHNpbmdsZSBtYWxsb2MgZm9yIHRyZWUgc3BhY2UKCQl2YXIgY2hlY2sgPSAwOyAvLyBjaGVjayBvbiBvdXRwdXQKCQl2YXIgaW5mdHJlZSA9IG5ldyBJbmZUcmVlKCk7CgoJCXRoYXQuYml0ayA9IDA7IC8vIGJpdHMgaW4gYml0IGJ1ZmZlcgoJCXRoYXQuYml0YiA9IDA7IC8vIGJpdCBidWZmZXIKCQl0aGF0LndpbmRvdyA9IG5ldyBVaW50OEFycmF5KHcpOyAvLyBzbGlkaW5nIHdpbmRvdwoJCXRoYXQuZW5kID0gdzsgLy8gb25lIGJ5dGUgYWZ0ZXIgc2xpZGluZyB3aW5kb3cKCQl0aGF0LnJlYWQgPSAwOyAvLyB3aW5kb3cgcmVhZCBwb2ludGVyCgkJdGhhdC53cml0ZSA9IDA7IC8vIHdpbmRvdyB3cml0ZSBwb2ludGVyCgoJCXRoYXQucmVzZXQgPSBmdW5jdGlvbih6LCBjKSB7CgkJCWlmIChjKQoJCQkJY1swXSA9IGNoZWNrOwoJCQkvLyBpZiAobW9kZSA9PSBCVFJFRSB8fCBtb2RlID09IERUUkVFKSB7CgkJCS8vIH0KCQkJaWYgKG1vZGUgPT0gQ09ERVMpIHsKCQkJCWNvZGVzLmZyZWUoeik7CgkJCX0KCQkJbW9kZSA9IFRZUEU7CgkJCXRoYXQuYml0ayA9IDA7CgkJCXRoYXQuYml0YiA9IDA7CgkJCXRoYXQucmVhZCA9IHRoYXQud3JpdGUgPSAwOwoJCX07CgoJCXRoYXQucmVzZXQoeiwgbnVsbCk7CgoJCS8vIGNvcHkgYXMgbXVjaCBhcyBwb3NzaWJsZSBmcm9tIHRoZSBzbGlkaW5nIHdpbmRvdyB0byB0aGUgb3V0cHV0IGFyZWEKCQl0aGF0LmluZmxhdGVfZmx1c2ggPSBmdW5jdGlvbih6LCByKSB7CgkJCXZhciBuOwoJCQl2YXIgcDsKCQkJdmFyIHE7CgoJCQkvLyBsb2NhbCBjb3BpZXMgb2Ygc291cmNlIGFuZCBkZXN0aW5hdGlvbiBwb2ludGVycwoJCQlwID0gei5uZXh0X291dF9pbmRleDsKCQkJcSA9IHRoYXQucmVhZDsKCgkJCS8vIGNvbXB1dGUgbnVtYmVyIG9mIGJ5dGVzIHRvIGNvcHkgYXMgZmFyIGFzIGVuZCBvZiB3aW5kb3cKCQkJbiA9IC8qIChpbnQpICovKChxIDw9IHRoYXQud3JpdGUgPyB0aGF0LndyaXRlIDogdGhhdC5lbmQpIC0gcSk7CgkJCWlmIChuID4gei5hdmFpbF9vdXQpCgkJCQluID0gei5hdmFpbF9vdXQ7CgkJCWlmIChuICE9PSAwICYmIHIgPT0gWl9CVUZfRVJST1IpCgkJCQlyID0gWl9PSzsKCgkJCS8vIHVwZGF0ZSBjb3VudGVycwoJCQl6LmF2YWlsX291dCAtPSBuOwoJCQl6LnRvdGFsX291dCArPSBuOwoKCQkJLy8gY29weSBhcyBmYXIgYXMgZW5kIG9mIHdpbmRvdwoJCQl6Lm5leHRfb3V0LnNldCh0aGF0LndpbmRvdy5zdWJhcnJheShxLCBxICsgbiksIHApOwoJCQlwICs9IG47CgkJCXEgKz0gbjsKCgkJCS8vIHNlZSBpZiBtb3JlIHRvIGNvcHkgYXQgYmVnaW5uaW5nIG9mIHdpbmRvdwoJCQlpZiAocSA9PSB0aGF0LmVuZCkgewoJCQkJLy8gd3JhcCBwb2ludGVycwoJCQkJcSA9IDA7CgkJCQlpZiAodGhhdC53cml0ZSA9PSB0aGF0LmVuZCkKCQkJCQl0aGF0LndyaXRlID0gMDsKCgkJCQkvLyBjb21wdXRlIGJ5dGVzIHRvIGNvcHkKCQkJCW4gPSB0aGF0LndyaXRlIC0gcTsKCQkJCWlmIChuID4gei5hdmFpbF9vdXQpCgkJCQkJbiA9IHouYXZhaWxfb3V0OwoJCQkJaWYgKG4gIT09IDAgJiYgciA9PSBaX0JVRl9FUlJPUikKCQkJCQlyID0gWl9PSzsKCgkJCQkvLyB1cGRhdGUgY291bnRlcnMKCQkJCXouYXZhaWxfb3V0IC09IG47CgkJCQl6LnRvdGFsX291dCArPSBuOwoKCQkJCS8vIGNvcHkKCQkJCXoubmV4dF9vdXQuc2V0KHRoYXQud2luZG93LnN1YmFycmF5KHEsIHEgKyBuKSwgcCk7CgkJCQlwICs9IG47CgkJCQlxICs9IG47CgkJCX0KCgkJCS8vIHVwZGF0ZSBwb2ludGVycwoJCQl6Lm5leHRfb3V0X2luZGV4ID0gcDsKCQkJdGhhdC5yZWFkID0gcTsKCgkJCS8vIGRvbmUKCQkJcmV0dXJuIHI7CgkJfTsKCgkJdGhhdC5wcm9jID0gZnVuY3Rpb24oeiwgcikgewoJCQl2YXIgdDsgLy8gdGVtcG9yYXJ5IHN0b3JhZ2UKCQkJdmFyIGI7IC8vIGJpdCBidWZmZXIKCQkJdmFyIGs7IC8vIGJpdHMgaW4gYml0IGJ1ZmZlcgoJCQl2YXIgcDsgLy8gaW5wdXQgZGF0YSBwb2ludGVyCgkJCXZhciBuOyAvLyBieXRlcyBhdmFpbGFibGUgdGhlcmUKCQkJdmFyIHE7IC8vIG91dHB1dCB3aW5kb3cgd3JpdGUgcG9pbnRlcgoJCQl2YXIgbTsgLy8gYnl0ZXMgdG8gZW5kIG9mIHdpbmRvdyBvciByZWFkIHBvaW50ZXIKCgkJCXZhciBpOwoKCQkJLy8gY29weSBpbnB1dC9vdXRwdXQgaW5mb3JtYXRpb24gdG8gbG9jYWxzIChVUERBVEUgbWFjcm8gcmVzdG9yZXMpCgkJCS8vIHsKCQkJcCA9IHoubmV4dF9pbl9pbmRleDsKCQkJbiA9IHouYXZhaWxfaW47CgkJCWIgPSB0aGF0LmJpdGI7CgkJCWsgPSB0aGF0LmJpdGs7CgkJCS8vIH0KCQkJLy8gewoJCQlxID0gdGhhdC53cml0ZTsKCQkJbSA9IC8qIChpbnQpICovKHEgPCB0aGF0LnJlYWQgPyB0aGF0LnJlYWQgLSBxIC0gMSA6IHRoYXQuZW5kIC0gcSk7CgkJCS8vIH0KCgkJCS8vIHByb2Nlc3MgaW5wdXQgYmFzZWQgb24gY3VycmVudCBzdGF0ZQoJCQkvLyBERUJVRyBkdHJlZQoJCQl3aGlsZSAodHJ1ZSkgewoJCQkJc3dpdGNoIChtb2RlKSB7CgkJCQljYXNlIFRZUEU6CgoJCQkJCXdoaWxlIChrIDwgKDMpKSB7CgkJCQkJCWlmIChuICE9PSAwKSB7CgkJCQkJCQlyID0gWl9PSzsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQl9CgkJCQkJCW4tLTsKCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCWsgKz0gODsKCQkJCQl9CgkJCQkJdCA9IC8qIChpbnQpICovKGIgJiA3KTsKCQkJCQlsYXN0ID0gdCAmIDE7CgoJCQkJCXN3aXRjaCAodCA+Pj4gMSkgewoJCQkJCWNhc2UgMDogLy8gc3RvcmVkCgkJCQkJCS8vIHsKCQkJCQkJYiA+Pj49ICgzKTsKCQkJCQkJayAtPSAoMyk7CgkJCQkJCS8vIH0KCQkJCQkJdCA9IGsgJiA3OyAvLyBnbyB0byBieXRlIGJvdW5kYXJ5CgoJCQkJCQkvLyB7CgkJCQkJCWIgPj4+PSAodCk7CgkJCQkJCWsgLT0gKHQpOwoJCQkJCQkvLyB9CgkJCQkJCW1vZGUgPSBMRU5TOyAvLyBnZXQgbGVuZ3RoIG9mIHN0b3JlZCBibG9jawoJCQkJCQlicmVhazsKCQkJCQljYXNlIDE6IC8vIGZpeGVkCgkJCQkJCS8vIHsKCQkJCQkJdmFyIGJsID0gW107IC8vIG5ldyBBcnJheSgxKTsKCQkJCQkJdmFyIGJkID0gW107IC8vIG5ldyBBcnJheSgxKTsKCQkJCQkJdmFyIHRsID0gWyBbXSBdOyAvLyBuZXcgQXJyYXkoMSk7CgkJCQkJCXZhciB0ZCA9IFsgW10gXTsgLy8gbmV3IEFycmF5KDEpOwoKCQkJCQkJSW5mVHJlZS5pbmZsYXRlX3RyZWVzX2ZpeGVkKGJsLCBiZCwgdGwsIHRkKTsKCQkJCQkJY29kZXMuaW5pdChibFswXSwgYmRbMF0sIHRsWzBdLCAwLCB0ZFswXSwgMCk7CgkJCQkJCS8vIH0KCgkJCQkJCS8vIHsKCQkJCQkJYiA+Pj49ICgzKTsKCQkJCQkJayAtPSAoMyk7CgkJCQkJCS8vIH0KCgkJCQkJCW1vZGUgPSBDT0RFUzsKCQkJCQkJYnJlYWs7CgkJCQkJY2FzZSAyOiAvLyBkeW5hbWljCgoJCQkJCQkvLyB7CgkJCQkJCWIgPj4+PSAoMyk7CgkJCQkJCWsgLT0gKDMpOwoJCQkJCQkvLyB9CgoJCQkJCQltb2RlID0gVEFCTEU7CgkJCQkJCWJyZWFrOwoJCQkJCWNhc2UgMzogLy8gaWxsZWdhbAoKCQkJCQkJLy8gewoJCQkJCQliID4+Pj0gKDMpOwoJCQkJCQlrIC09ICgzKTsKCQkJCQkJLy8gfQoJCQkJCQltb2RlID0gQkFEQkxPQ0tTOwoJCQkJCQl6Lm1zZyA9ICJpbnZhbGlkIGJsb2NrIHR5cGUiOwoJCQkJCQlyID0gWl9EQVRBX0VSUk9SOwoKCQkJCQkJdGhhdC5iaXRiID0gYjsKCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSBMRU5TOgoKCQkJCQl3aGlsZSAoayA8ICgzMikpIHsKCQkJCQkJaWYgKG4gIT09IDApIHsKCQkJCQkJCXIgPSBaX09LOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdGhhdC5iaXRiID0gYjsKCQkJCQkJCXRoYXQuYml0ayA9IGs7CgkJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJCX0KCQkJCQkJbi0tOwoJCQkJCQliIHw9ICh6LnJlYWRfYnl0ZShwKyspICYgMHhmZikgPDwgazsKCQkJCQkJayArPSA4OwoJCQkJCX0KCgkJCQkJaWYgKCgoKH5iKSA+Pj4gMTYpICYgMHhmZmZmKSAhPSAoYiAmIDB4ZmZmZikpIHsKCQkJCQkJbW9kZSA9IEJBREJMT0NLUzsKCQkJCQkJei5tc2cgPSAiaW52YWxpZCBzdG9yZWQgYmxvY2sgbGVuZ3RocyI7CgkJCQkJCXIgPSBaX0RBVEFfRVJST1I7CgoJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQl9CgkJCQkJbGVmdCA9IChiICYgMHhmZmZmKTsKCQkJCQliID0gayA9IDA7IC8vIGR1bXAgYml0cwoJCQkJCW1vZGUgPSBsZWZ0ICE9PSAwID8gU1RPUkVEIDogKGxhc3QgIT09IDAgPyBEUlkgOiBUWVBFKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgU1RPUkVEOgoJCQkJCWlmIChuID09PSAwKSB7CgkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCXRoYXQuYml0ayA9IGs7CgkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCXRoYXQud3JpdGUgPSBxOwoJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCX0KCgkJCQkJaWYgKG0gPT09IDApIHsKCQkJCQkJaWYgKHEgPT0gdGhhdC5lbmQgJiYgdGhhdC5yZWFkICE9PSAwKSB7CgkJCQkJCQlxID0gMDsKCQkJCQkJCW0gPSAvKiAoaW50KSAqLyhxIDwgdGhhdC5yZWFkID8gdGhhdC5yZWFkIC0gcSAtIDEgOiB0aGF0LmVuZCAtIHEpOwoJCQkJCQl9CgkJCQkJCWlmIChtID09PSAwKSB7CgkJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJCXIgPSB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJCQlxID0gdGhhdC53cml0ZTsKCQkJCQkJCW0gPSAvKiAoaW50KSAqLyhxIDwgdGhhdC5yZWFkID8gdGhhdC5yZWFkIC0gcSAtIDEgOiB0aGF0LmVuZCAtIHEpOwoJCQkJCQkJaWYgKHEgPT0gdGhhdC5lbmQgJiYgdGhhdC5yZWFkICE9PSAwKSB7CgkJCQkJCQkJcSA9IDA7CgkJCQkJCQkJbSA9IC8qIChpbnQpICovKHEgPCB0aGF0LnJlYWQgPyB0aGF0LnJlYWQgLSBxIC0gMSA6IHRoYXQuZW5kIC0gcSk7CgkJCQkJCQl9CgkJCQkJCQlpZiAobSA9PT0gMCkgewoJCQkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJCXIgPSBaX09LOwoKCQkJCQl0ID0gbGVmdDsKCQkJCQlpZiAodCA+IG4pCgkJCQkJCXQgPSBuOwoJCQkJCWlmICh0ID4gbSkKCQkJCQkJdCA9IG07CgkJCQkJdGhhdC53aW5kb3cuc2V0KHoucmVhZF9idWYocCwgdCksIHEpOwoJCQkJCXAgKz0gdDsKCQkJCQluIC09IHQ7CgkJCQkJcSArPSB0OwoJCQkJCW0gLT0gdDsKCQkJCQlpZiAoKGxlZnQgLT0gdCkgIT09IDApCgkJCQkJCWJyZWFrOwoJCQkJCW1vZGUgPSBsYXN0ICE9PSAwID8gRFJZIDogVFlQRTsKCQkJCQlicmVhazsKCQkJCWNhc2UgVEFCTEU6CgoJCQkJCXdoaWxlIChrIDwgKDE0KSkgewoJCQkJCQlpZiAobiAhPT0gMCkgewoJCQkJCQkJciA9IFpfT0s7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJCXRoYXQud3JpdGUgPSBxOwoJCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQkJfQoKCQkJCQkJbi0tOwoJCQkJCQliIHw9ICh6LnJlYWRfYnl0ZShwKyspICYgMHhmZikgPDwgazsKCQkJCQkJayArPSA4OwoJCQkJCX0KCgkJCQkJdGFibGUgPSB0ID0gKGIgJiAweDNmZmYpOwoJCQkJCWlmICgodCAmIDB4MWYpID4gMjkgfHwgKCh0ID4+IDUpICYgMHgxZikgPiAyOSkgewoJCQkJCQltb2RlID0gQkFEQkxPQ0tTOwoJCQkJCQl6Lm1zZyA9ICJ0b28gbWFueSBsZW5ndGggb3IgZGlzdGFuY2Ugc3ltYm9scyI7CgkJCQkJCXIgPSBaX0RBVEFfRVJST1I7CgoJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQl9CgkJCQkJdCA9IDI1OCArICh0ICYgMHgxZikgKyAoKHQgPj4gNSkgJiAweDFmKTsKCQkJCQlpZiAoIWJsZW5zIHx8IGJsZW5zLmxlbmd0aCA8IHQpIHsKCQkJCQkJYmxlbnMgPSBbXTsgLy8gbmV3IEFycmF5KHQpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWZvciAoaSA9IDA7IGkgPCB0OyBpKyspIHsKCQkJCQkJCWJsZW5zW2ldID0gMDsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gewoJCQkJCWIgPj4+PSAoMTQpOwoJCQkJCWsgLT0gKDE0KTsKCQkJCQkvLyB9CgoJCQkJCWluZGV4ID0gMDsKCQkJCQltb2RlID0gQlRSRUU7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBCVFJFRToKCQkJCQl3aGlsZSAoaW5kZXggPCA0ICsgKHRhYmxlID4+PiAxMCkpIHsKCQkJCQkJd2hpbGUgKGsgPCAoMykpIHsKCQkJCQkJCWlmIChuICE9PSAwKSB7CgkJCQkJCQkJciA9IFpfT0s7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJfQoJCQkJCQkJbi0tOwoJCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCQlrICs9IDg7CgkJCQkJCX0KCgkJCQkJCWJsZW5zW2JvcmRlcltpbmRleCsrXV0gPSBiICYgNzsKCgkJCQkJCS8vIHsKCQkJCQkJYiA+Pj49ICgzKTsKCQkJCQkJayAtPSAoMyk7CgkJCQkJCS8vIH0KCQkJCQl9CgoJCQkJCXdoaWxlIChpbmRleCA8IDE5KSB7CgkJCQkJCWJsZW5zW2JvcmRlcltpbmRleCsrXV0gPSAwOwoJCQkJCX0KCgkJCQkJYmJbMF0gPSA3OwoJCQkJCXQgPSBpbmZ0cmVlLmluZmxhdGVfdHJlZXNfYml0cyhibGVucywgYmIsIHRiLCBodWZ0cywgeik7CgkJCQkJaWYgKHQgIT0gWl9PSykgewoJCQkJCQlyID0gdDsKCQkJCQkJaWYgKHIgPT0gWl9EQVRBX0VSUk9SKSB7CgkJCQkJCQlibGVucyA9IG51bGw7CgkJCQkJCQltb2RlID0gQkFEQkxPQ0tTOwoJCQkJCQl9CgoJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQl9CgoJCQkJCWluZGV4ID0gMDsKCQkJCQltb2RlID0gRFRSRUU7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBEVFJFRToKCQkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCQl0ID0gdGFibGU7CgkJCQkJCWlmIChpbmRleCA+PSAyNTggKyAodCAmIDB4MWYpICsgKCh0ID4+IDUpICYgMHgxZikpIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgoJCQkJCQl2YXIgaiwgYzsKCgkJCQkJCXQgPSBiYlswXTsKCgkJCQkJCXdoaWxlIChrIDwgKHQpKSB7CgkJCQkJCQlpZiAobiAhPT0gMCkgewoJCQkJCQkJCXIgPSBaX09LOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQkJCXRoYXQuYml0ayA9IGs7CgkJCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQkJCX0KCQkJCQkJCW4tLTsKCQkJCQkJCWIgfD0gKHoucmVhZF9ieXRlKHArKykgJiAweGZmKSA8PCBrOwoJCQkJCQkJayArPSA4OwoJCQkJCQl9CgoJCQkJCQkvLyBpZiAodGJbMF0gPT0gLTEpIHsKCQkJCQkJLy8gU3lzdGVtLmVyci5wcmludGxuKCJudWxsLi4uIik7CgkJCQkJCS8vIH0KCgkJCQkJCXQgPSBodWZ0c1sodGJbMF0gKyAoYiAmIGluZmxhdGVfbWFza1t0XSkpICogMyArIDFdOwoJCQkJCQljID0gaHVmdHNbKHRiWzBdICsgKGIgJiBpbmZsYXRlX21hc2tbdF0pKSAqIDMgKyAyXTsKCgkJCQkJCWlmIChjIDwgMTYpIHsKCQkJCQkJCWIgPj4+PSAodCk7CgkJCQkJCQlrIC09ICh0KTsKCQkJCQkJCWJsZW5zW2luZGV4KytdID0gYzsKCQkJCQkJfSBlbHNlIHsgLy8gYyA9PSAxNi4uMTgKCQkJCQkJCWkgPSBjID09IDE4ID8gNyA6IGMgLSAxNDsKCQkJCQkJCWogPSBjID09IDE4ID8gMTEgOiAzOwoKCQkJCQkJCXdoaWxlIChrIDwgKHQgKyBpKSkgewoJCQkJCQkJCWlmIChuICE9PSAwKSB7CgkJCQkJCQkJCXIgPSBaX09LOwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCQkJCXRoYXQuYml0ayA9IGs7CgkJCQkJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJCQkJCXRoYXQud3JpdGUgPSBxOwoJCQkJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJCX0KCQkJCQkJCQluLS07CgkJCQkJCQkJYiB8PSAoei5yZWFkX2J5dGUocCsrKSAmIDB4ZmYpIDw8IGs7CgkJCQkJCQkJayArPSA4OwoJCQkJCQkJfQoKCQkJCQkJCWIgPj4+PSAodCk7CgkJCQkJCQlrIC09ICh0KTsKCgkJCQkJCQlqICs9IChiICYgaW5mbGF0ZV9tYXNrW2ldKTsKCgkJCQkJCQliID4+Pj0gKGkpOwoJCQkJCQkJayAtPSAoaSk7CgoJCQkJCQkJaSA9IGluZGV4OwoJCQkJCQkJdCA9IHRhYmxlOwoJCQkJCQkJaWYgKGkgKyBqID4gMjU4ICsgKHQgJiAweDFmKSArICgodCA+PiA1KSAmIDB4MWYpIHx8IChjID09IDE2ICYmIGkgPCAxKSkgewoJCQkJCQkJCWJsZW5zID0gbnVsbDsKCQkJCQkJCQltb2RlID0gQkFEQkxPQ0tTOwoJCQkJCQkJCXoubXNnID0gImludmFsaWQgYml0IGxlbmd0aCByZXBlYXQiOwoJCQkJCQkJCXIgPSBaX0RBVEFfRVJST1I7CgoJCQkJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJCQlyZXR1cm4gdGhhdC5pbmZsYXRlX2ZsdXNoKHosIHIpOwoJCQkJCQkJfQoKCQkJCQkJCWMgPSBjID09IDE2ID8gYmxlbnNbaSAtIDFdIDogMDsKCQkJCQkJCWRvIHsKCQkJCQkJCQlibGVuc1tpKytdID0gYzsKCQkJCQkJCX0gd2hpbGUgKC0taiAhPT0gMCk7CgkJCQkJCQlpbmRleCA9IGk7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCXRiWzBdID0gLTE7CgkJCQkJLy8gewoJCQkJCXZhciBibF8gPSBbXTsgLy8gbmV3IEFycmF5KDEpOwoJCQkJCXZhciBiZF8gPSBbXTsgLy8gbmV3IEFycmF5KDEpOwoJCQkJCXZhciB0bF8gPSBbXTsgLy8gbmV3IEFycmF5KDEpOwoJCQkJCXZhciB0ZF8gPSBbXTsgLy8gbmV3IEFycmF5KDEpOwoJCQkJCWJsX1swXSA9IDk7IC8vIG11c3QgYmUgPD0gOSBmb3IgbG9va2FoZWFkIGFzc3VtcHRpb25zCgkJCQkJYmRfWzBdID0gNjsgLy8gbXVzdCBiZSA8PSA5IGZvciBsb29rYWhlYWQgYXNzdW1wdGlvbnMKCgkJCQkJdCA9IHRhYmxlOwoJCQkJCXQgPSBpbmZ0cmVlLmluZmxhdGVfdHJlZXNfZHluYW1pYygyNTcgKyAodCAmIDB4MWYpLCAxICsgKCh0ID4+IDUpICYgMHgxZiksIGJsZW5zLCBibF8sIGJkXywgdGxfLCB0ZF8sIGh1ZnRzLCB6KTsKCgkJCQkJaWYgKHQgIT0gWl9PSykgewoJCQkJCQlpZiAodCA9PSBaX0RBVEFfRVJST1IpIHsKCQkJCQkJCWJsZW5zID0gbnVsbDsKCQkJCQkJCW1vZGUgPSBCQURCTE9DS1M7CgkJCQkJCX0KCQkJCQkJciA9IHQ7CgoJCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCQl0aGF0LndyaXRlID0gcTsKCQkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQl9CgkJCQkJY29kZXMuaW5pdChibF9bMF0sIGJkX1swXSwgaHVmdHMsIHRsX1swXSwgaHVmdHMsIHRkX1swXSk7CgkJCQkJLy8gfQoJCQkJCW1vZGUgPSBDT0RFUzsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIENPREVTOgoJCQkJCXRoYXQuYml0YiA9IGI7CgkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQl6LmF2YWlsX2luID0gbjsKCQkJCQl6LnRvdGFsX2luICs9IHAgLSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQl0aGF0LndyaXRlID0gcTsKCgkJCQkJaWYgKChyID0gY29kZXMucHJvYyh0aGF0LCB6LCByKSkgIT0gWl9TVFJFQU1fRU5EKSB7CgkJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJfQoJCQkJCXIgPSBaX09LOwoJCQkJCWNvZGVzLmZyZWUoeik7CgoJCQkJCXAgPSB6Lm5leHRfaW5faW5kZXg7CgkJCQkJbiA9IHouYXZhaWxfaW47CgkJCQkJYiA9IHRoYXQuYml0YjsKCQkJCQlrID0gdGhhdC5iaXRrOwoJCQkJCXEgPSB0aGF0LndyaXRlOwoJCQkJCW0gPSAvKiAoaW50KSAqLyhxIDwgdGhhdC5yZWFkID8gdGhhdC5yZWFkIC0gcSAtIDEgOiB0aGF0LmVuZCAtIHEpOwoKCQkJCQlpZiAobGFzdCA9PT0gMCkgewoJCQkJCQltb2RlID0gVFlQRTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCW1vZGUgPSBEUlk7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBEUlk6CgkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJciA9IHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCQkJCQlxID0gdGhhdC53cml0ZTsKCQkJCQltID0gLyogKGludCkgKi8ocSA8IHRoYXQucmVhZCA/IHRoYXQucmVhZCAtIHEgLSAxIDogdGhhdC5lbmQgLSBxKTsKCQkJCQlpZiAodGhhdC5yZWFkICE9IHRoYXQud3JpdGUpIHsKCQkJCQkJdGhhdC5iaXRiID0gYjsKCQkJCQkJdGhhdC5iaXRrID0gazsKCQkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQkJfQoJCQkJCW1vZGUgPSBET05FTE9DS1M7CgkJCQkJLyogZmFsbHMgdGhyb3VnaCAqLwoJCQkJY2FzZSBET05FTE9DS1M6CgkJCQkJciA9IFpfU1RSRUFNX0VORDsKCgkJCQkJdGhhdC5iaXRiID0gYjsKCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCXRoYXQud3JpdGUgPSBxOwoJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQljYXNlIEJBREJMT0NLUzoKCQkJCQlyID0gWl9EQVRBX0VSUk9SOwoKCQkJCQl0aGF0LmJpdGIgPSBiOwoJCQkJCXRoYXQuYml0ayA9IGs7CgkJCQkJei5hdmFpbF9pbiA9IG47CgkJCQkJei50b3RhbF9pbiArPSBwIC0gei5uZXh0X2luX2luZGV4OwoJCQkJCXoubmV4dF9pbl9pbmRleCA9IHA7CgkJCQkJdGhhdC53cml0ZSA9IHE7CgkJCQkJcmV0dXJuIHRoYXQuaW5mbGF0ZV9mbHVzaCh6LCByKTsKCgkJCQlkZWZhdWx0OgoJCQkJCXIgPSBaX1NUUkVBTV9FUlJPUjsKCgkJCQkJdGhhdC5iaXRiID0gYjsKCQkJCQl0aGF0LmJpdGsgPSBrOwoJCQkJCXouYXZhaWxfaW4gPSBuOwoJCQkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJCQl6Lm5leHRfaW5faW5kZXggPSBwOwoJCQkJCXRoYXQud3JpdGUgPSBxOwoJCQkJCXJldHVybiB0aGF0LmluZmxhdGVfZmx1c2goeiwgcik7CgkJCQl9CgkJCX0KCQl9OwoKCQl0aGF0LmZyZWUgPSBmdW5jdGlvbih6KSB7CgkJCXRoYXQucmVzZXQoeiwgbnVsbCk7CgkJCXRoYXQud2luZG93ID0gbnVsbDsKCQkJaHVmdHMgPSBudWxsOwoJCQkvLyBaRlJFRSh6LCBzKTsKCQl9OwoKCQl0aGF0LnNldF9kaWN0aW9uYXJ5ID0gZnVuY3Rpb24oZCwgc3RhcnQsIG4pIHsKCQkJdGhhdC53aW5kb3cuc2V0KGQuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbiksIDApOwoJCQl0aGF0LnJlYWQgPSB0aGF0LndyaXRlID0gbjsKCQl9OwoKCQkvLyBSZXR1cm5zIHRydWUgaWYgaW5mbGF0ZSBpcyBjdXJyZW50bHkgYXQgdGhlIGVuZCBvZiBhIGJsb2NrIGdlbmVyYXRlZAoJCS8vIGJ5IFpfU1lOQ19GTFVTSCBvciBaX0ZVTExfRkxVU0guCgkJdGhhdC5zeW5jX3BvaW50ID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBtb2RlID09IExFTlMgPyAxIDogMDsKCQl9OwoKCX0KCgkvLyBJbmZsYXRlCgoJLy8gcHJlc2V0IGRpY3Rpb25hcnkgZmxhZyBpbiB6bGliIGhlYWRlcgoJdmFyIFBSRVNFVF9ESUNUID0gMHgyMDsKCgl2YXIgWl9ERUZMQVRFRCA9IDg7CgoJdmFyIE1FVEhPRCA9IDA7IC8vIHdhaXRpbmcgZm9yIG1ldGhvZCBieXRlCgl2YXIgRkxBRyA9IDE7IC8vIHdhaXRpbmcgZm9yIGZsYWcgYnl0ZQoJdmFyIERJQ1Q0ID0gMjsgLy8gZm91ciBkaWN0aW9uYXJ5IGNoZWNrIGJ5dGVzIHRvIGdvCgl2YXIgRElDVDMgPSAzOyAvLyB0aHJlZSBkaWN0aW9uYXJ5IGNoZWNrIGJ5dGVzIHRvIGdvCgl2YXIgRElDVDIgPSA0OyAvLyB0d28gZGljdGlvbmFyeSBjaGVjayBieXRlcyB0byBnbwoJdmFyIERJQ1QxID0gNTsgLy8gb25lIGRpY3Rpb25hcnkgY2hlY2sgYnl0ZSB0byBnbwoJdmFyIERJQ1QwID0gNjsgLy8gd2FpdGluZyBmb3IgaW5mbGF0ZVNldERpY3Rpb25hcnkKCXZhciBCTE9DS1MgPSA3OyAvLyBkZWNvbXByZXNzaW5nIGJsb2NrcwoJdmFyIERPTkUgPSAxMjsgLy8gZmluaXNoZWQgY2hlY2ssIGRvbmUKCXZhciBCQUQgPSAxMzsgLy8gZ290IGFuIGVycm9yLS1zdGF5IGhlcmUKCgl2YXIgbWFyayA9IFsgMCwgMCwgMHhmZiwgMHhmZiBdOwoKCWZ1bmN0aW9uIEluZmxhdGUoKSB7CgkJdmFyIHRoYXQgPSB0aGlzOwoKCQl0aGF0Lm1vZGUgPSAwOyAvLyBjdXJyZW50IGluZmxhdGUgbW9kZQoKCQkvLyBtb2RlIGRlcGVuZGVudCBpbmZvcm1hdGlvbgoJCXRoYXQubWV0aG9kID0gMDsgLy8gaWYgRkxBR1MsIG1ldGhvZCBieXRlCgoJCS8vIGlmIENIRUNLLCBjaGVjayB2YWx1ZXMgdG8gY29tcGFyZQoJCXRoYXQud2FzID0gWyAwIF07IC8vIG5ldyBBcnJheSgxKTsgLy8gY29tcHV0ZWQgY2hlY2sgdmFsdWUKCQl0aGF0Lm5lZWQgPSAwOyAvLyBzdHJlYW0gY2hlY2sgdmFsdWUKCgkJLy8gaWYgQkFELCBpbmZsYXRlU3luYydzIG1hcmtlciBieXRlcyBjb3VudAoJCXRoYXQubWFya2VyID0gMDsKCgkJLy8gbW9kZSBpbmRlcGVuZGVudCBpbmZvcm1hdGlvbgoJCXRoYXQud2JpdHMgPSAwOyAvLyBsb2cyKHdpbmRvdyBzaXplKSAoOC4uMTUsIGRlZmF1bHRzIHRvIDE1KQoKCQkvLyB0aGlzLmJsb2NrczsgLy8gY3VycmVudCBpbmZsYXRlX2Jsb2NrcyBzdGF0ZQoKCQlmdW5jdGlvbiBpbmZsYXRlUmVzZXQoeikgewoJCQlpZiAoIXogfHwgIXouaXN0YXRlKQoJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoKCQkJei50b3RhbF9pbiA9IHoudG90YWxfb3V0ID0gMDsKCQkJei5tc2cgPSBudWxsOwoJCQl6LmlzdGF0ZS5tb2RlID0gQkxPQ0tTOwoJCQl6LmlzdGF0ZS5ibG9ja3MucmVzZXQoeiwgbnVsbCk7CgkJCXJldHVybiBaX09LOwoJCX0KCgkJdGhhdC5pbmZsYXRlRW5kID0gZnVuY3Rpb24oeikgewoJCQlpZiAodGhhdC5ibG9ja3MpCgkJCQl0aGF0LmJsb2Nrcy5mcmVlKHopOwoJCQl0aGF0LmJsb2NrcyA9IG51bGw7CgkJCS8vIFpGUkVFKHosIHotPnN0YXRlKTsKCQkJcmV0dXJuIFpfT0s7CgkJfTsKCgkJdGhhdC5pbmZsYXRlSW5pdCA9IGZ1bmN0aW9uKHosIHcpIHsKCQkJei5tc2cgPSBudWxsOwoJCQl0aGF0LmJsb2NrcyA9IG51bGw7CgoJCQkvLyBzZXQgd2luZG93IHNpemUKCQkJaWYgKHcgPCA4IHx8IHcgPiAxNSkgewoJCQkJdGhhdC5pbmZsYXRlRW5kKHopOwoJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoJCQl9CgkJCXRoYXQud2JpdHMgPSB3OwoKCQkJei5pc3RhdGUuYmxvY2tzID0gbmV3IEluZkJsb2Nrcyh6LCAxIDw8IHcpOwoKCQkJLy8gcmVzZXQgc3RhdGUKCQkJaW5mbGF0ZVJlc2V0KHopOwoJCQlyZXR1cm4gWl9PSzsKCQl9OwoKCQl0aGF0LmluZmxhdGUgPSBmdW5jdGlvbih6LCBmKSB7CgkJCXZhciByOwoJCQl2YXIgYjsKCgkJCWlmICgheiB8fCAhei5pc3RhdGUgfHwgIXoubmV4dF9pbikKCQkJCXJldHVybiBaX1NUUkVBTV9FUlJPUjsKCQkJZiA9IGYgPT0gWl9GSU5JU0ggPyBaX0JVRl9FUlJPUiA6IFpfT0s7CgkJCXIgPSBaX0JVRl9FUlJPUjsKCQkJd2hpbGUgKHRydWUpIHsKCQkJCS8vIFN5c3RlbS5vdXQucHJpbnRsbigibW9kZTogIit6LmlzdGF0ZS5tb2RlKTsKCQkJCXN3aXRjaCAoei5pc3RhdGUubW9kZSkgewoJCQkJY2FzZSBNRVRIT0Q6CgoJCQkJCWlmICh6LmF2YWlsX2luID09PSAwKQoJCQkJCQlyZXR1cm4gcjsKCQkJCQlyID0gZjsKCgkJCQkJei5hdmFpbF9pbi0tOwoJCQkJCXoudG90YWxfaW4rKzsKCQkJCQlpZiAoKCh6LmlzdGF0ZS5tZXRob2QgPSB6LnJlYWRfYnl0ZSh6Lm5leHRfaW5faW5kZXgrKykpICYgMHhmKSAhPSBaX0RFRkxBVEVEKSB7CgkJCQkJCXouaXN0YXRlLm1vZGUgPSBCQUQ7CgkJCQkJCXoubXNnID0gInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kIjsKCQkJCQkJei5pc3RhdGUubWFya2VyID0gNTsgLy8gY2FuJ3QgdHJ5IGluZmxhdGVTeW5jCgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQlpZiAoKHouaXN0YXRlLm1ldGhvZCA+PiA0KSArIDggPiB6LmlzdGF0ZS53Yml0cykgewoJCQkJCQl6LmlzdGF0ZS5tb2RlID0gQkFEOwoJCQkJCQl6Lm1zZyA9ICJpbnZhbGlkIHdpbmRvdyBzaXplIjsKCQkJCQkJei5pc3RhdGUubWFya2VyID0gNTsgLy8gY2FuJ3QgdHJ5IGluZmxhdGVTeW5jCgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQl6LmlzdGF0ZS5tb2RlID0gRkxBRzsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIEZMQUc6CgoJCQkJCWlmICh6LmF2YWlsX2luID09PSAwKQoJCQkJCQlyZXR1cm4gcjsKCQkJCQlyID0gZjsKCgkJCQkJei5hdmFpbF9pbi0tOwoJCQkJCXoudG90YWxfaW4rKzsKCQkJCQliID0gKHoucmVhZF9ieXRlKHoubmV4dF9pbl9pbmRleCsrKSkgJiAweGZmOwoKCQkJCQlpZiAoKCgoei5pc3RhdGUubWV0aG9kIDw8IDgpICsgYikgJSAzMSkgIT09IDApIHsKCQkJCQkJei5pc3RhdGUubW9kZSA9IEJBRDsKCQkJCQkJei5tc2cgPSAiaW5jb3JyZWN0IGhlYWRlciBjaGVjayI7CgkJCQkJCXouaXN0YXRlLm1hcmtlciA9IDU7IC8vIGNhbid0IHRyeSBpbmZsYXRlU3luYwoJCQkJCQlicmVhazsKCQkJCQl9CgoJCQkJCWlmICgoYiAmIFBSRVNFVF9ESUNUKSA9PT0gMCkgewoJCQkJCQl6LmlzdGF0ZS5tb2RlID0gQkxPQ0tTOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJei5pc3RhdGUubW9kZSA9IERJQ1Q0OwoJCQkJCS8qIGZhbGxzIHRocm91Z2ggKi8KCQkJCWNhc2UgRElDVDQ6CgoJCQkJCWlmICh6LmF2YWlsX2luID09PSAwKQoJCQkJCQlyZXR1cm4gcjsKCQkJCQlyID0gZjsKCgkJCQkJei5hdmFpbF9pbi0tOwoJCQkJCXoudG90YWxfaW4rKzsKCQkJCQl6LmlzdGF0ZS5uZWVkID0gKCh6LnJlYWRfYnl0ZSh6Lm5leHRfaW5faW5kZXgrKykgJiAweGZmKSA8PCAyNCkgJiAweGZmMDAwMDAwOwoJCQkJCXouaXN0YXRlLm1vZGUgPSBESUNUMzsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIERJQ1QzOgoKCQkJCQlpZiAoei5hdmFpbF9pbiA9PT0gMCkKCQkJCQkJcmV0dXJuIHI7CgkJCQkJciA9IGY7CgoJCQkJCXouYXZhaWxfaW4tLTsKCQkJCQl6LnRvdGFsX2luKys7CgkJCQkJei5pc3RhdGUubmVlZCArPSAoKHoucmVhZF9ieXRlKHoubmV4dF9pbl9pbmRleCsrKSAmIDB4ZmYpIDw8IDE2KSAmIDB4ZmYwMDAwOwoJCQkJCXouaXN0YXRlLm1vZGUgPSBESUNUMjsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIERJQ1QyOgoKCQkJCQlpZiAoei5hdmFpbF9pbiA9PT0gMCkKCQkJCQkJcmV0dXJuIHI7CgkJCQkJciA9IGY7CgoJCQkJCXouYXZhaWxfaW4tLTsKCQkJCQl6LnRvdGFsX2luKys7CgkJCQkJei5pc3RhdGUubmVlZCArPSAoKHoucmVhZF9ieXRlKHoubmV4dF9pbl9pbmRleCsrKSAmIDB4ZmYpIDw8IDgpICYgMHhmZjAwOwoJCQkJCXouaXN0YXRlLm1vZGUgPSBESUNUMTsKCQkJCQkvKiBmYWxscyB0aHJvdWdoICovCgkJCQljYXNlIERJQ1QxOgoKCQkJCQlpZiAoei5hdmFpbF9pbiA9PT0gMCkKCQkJCQkJcmV0dXJuIHI7CgkJCQkJciA9IGY7CgoJCQkJCXouYXZhaWxfaW4tLTsKCQkJCQl6LnRvdGFsX2luKys7CgkJCQkJei5pc3RhdGUubmVlZCArPSAoei5yZWFkX2J5dGUoei5uZXh0X2luX2luZGV4KyspICYgMHhmZik7CgkJCQkJei5pc3RhdGUubW9kZSA9IERJQ1QwOwoJCQkJCXJldHVybiBaX05FRURfRElDVDsKCQkJCWNhc2UgRElDVDA6CgkJCQkJei5pc3RhdGUubW9kZSA9IEJBRDsKCQkJCQl6Lm1zZyA9ICJuZWVkIGRpY3Rpb25hcnkiOwoJCQkJCXouaXN0YXRlLm1hcmtlciA9IDA7IC8vIGNhbiB0cnkgaW5mbGF0ZVN5bmMKCQkJCQlyZXR1cm4gWl9TVFJFQU1fRVJST1I7CgkJCQljYXNlIEJMT0NLUzoKCgkJCQkJciA9IHouaXN0YXRlLmJsb2Nrcy5wcm9jKHosIHIpOwoJCQkJCWlmIChyID09IFpfREFUQV9FUlJPUikgewoJCQkJCQl6LmlzdGF0ZS5tb2RlID0gQkFEOwoJCQkJCQl6LmlzdGF0ZS5tYXJrZXIgPSAwOyAvLyBjYW4gdHJ5IGluZmxhdGVTeW5jCgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQlpZiAociA9PSBaX09LKSB7CgkJCQkJCXIgPSBmOwoJCQkJCX0KCQkJCQlpZiAociAhPSBaX1NUUkVBTV9FTkQpIHsKCQkJCQkJcmV0dXJuIHI7CgkJCQkJfQoJCQkJCXIgPSBmOwoJCQkJCXouaXN0YXRlLmJsb2Nrcy5yZXNldCh6LCB6LmlzdGF0ZS53YXMpOwoJCQkJCXouaXN0YXRlLm1vZGUgPSBET05FOwoJCQkJCS8qIGZhbGxzIHRocm91Z2ggKi8KCQkJCWNhc2UgRE9ORToKCQkJCQlyZXR1cm4gWl9TVFJFQU1fRU5EOwoJCQkJY2FzZSBCQUQ6CgkJCQkJcmV0dXJuIFpfREFUQV9FUlJPUjsKCQkJCWRlZmF1bHQ6CgkJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoJCQkJfQoJCQl9CgkJfTsKCgkJdGhhdC5pbmZsYXRlU2V0RGljdGlvbmFyeSA9IGZ1bmN0aW9uKHosIGRpY3Rpb25hcnksIGRpY3RMZW5ndGgpIHsKCQkJdmFyIGluZGV4ID0gMDsKCQkJdmFyIGxlbmd0aCA9IGRpY3RMZW5ndGg7CgkJCWlmICgheiB8fCAhei5pc3RhdGUgfHwgei5pc3RhdGUubW9kZSAhPSBESUNUMCkKCQkJCXJldHVybiBaX1NUUkVBTV9FUlJPUjsKCgkJCWlmIChsZW5ndGggPj0gKDEgPDwgei5pc3RhdGUud2JpdHMpKSB7CgkJCQlsZW5ndGggPSAoMSA8PCB6LmlzdGF0ZS53Yml0cykgLSAxOwoJCQkJaW5kZXggPSBkaWN0TGVuZ3RoIC0gbGVuZ3RoOwoJCQl9CgkJCXouaXN0YXRlLmJsb2Nrcy5zZXRfZGljdGlvbmFyeShkaWN0aW9uYXJ5LCBpbmRleCwgbGVuZ3RoKTsKCQkJei5pc3RhdGUubW9kZSA9IEJMT0NLUzsKCQkJcmV0dXJuIFpfT0s7CgkJfTsKCgkJdGhhdC5pbmZsYXRlU3luYyA9IGZ1bmN0aW9uKHopIHsKCQkJdmFyIG47IC8vIG51bWJlciBvZiBieXRlcyB0byBsb29rIGF0CgkJCXZhciBwOyAvLyBwb2ludGVyIHRvIGJ5dGVzCgkJCXZhciBtOyAvLyBudW1iZXIgb2YgbWFya2VyIGJ5dGVzIGZvdW5kIGluIGEgcm93CgkJCXZhciByLCB3OyAvLyB0ZW1wb3JhcmllcyB0byBzYXZlIHRvdGFsX2luIGFuZCB0b3RhbF9vdXQKCgkJCS8vIHNldCB1cAoJCQlpZiAoIXogfHwgIXouaXN0YXRlKQoJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoJCQlpZiAoei5pc3RhdGUubW9kZSAhPSBCQUQpIHsKCQkJCXouaXN0YXRlLm1vZGUgPSBCQUQ7CgkJCQl6LmlzdGF0ZS5tYXJrZXIgPSAwOwoJCQl9CgkJCWlmICgobiA9IHouYXZhaWxfaW4pID09PSAwKQoJCQkJcmV0dXJuIFpfQlVGX0VSUk9SOwoJCQlwID0gei5uZXh0X2luX2luZGV4OwoJCQltID0gei5pc3RhdGUubWFya2VyOwoKCQkJLy8gc2VhcmNoCgkJCXdoaWxlIChuICE9PSAwICYmIG0gPCA0KSB7CgkJCQlpZiAoei5yZWFkX2J5dGUocCkgPT0gbWFya1ttXSkgewoJCQkJCW0rKzsKCQkJCX0gZWxzZSBpZiAoei5yZWFkX2J5dGUocCkgIT09IDApIHsKCQkJCQltID0gMDsKCQkJCX0gZWxzZSB7CgkJCQkJbSA9IDQgLSBtOwoJCQkJfQoJCQkJcCsrOwoJCQkJbi0tOwoJCQl9CgoJCQkvLyByZXN0b3JlCgkJCXoudG90YWxfaW4gKz0gcCAtIHoubmV4dF9pbl9pbmRleDsKCQkJei5uZXh0X2luX2luZGV4ID0gcDsKCQkJei5hdmFpbF9pbiA9IG47CgkJCXouaXN0YXRlLm1hcmtlciA9IG07CgoJCQkvLyByZXR1cm4gbm8gam95IG9yIHNldCB1cCB0byByZXN0YXJ0IG9uIGEgbmV3IGJsb2NrCgkJCWlmIChtICE9IDQpIHsKCQkJCXJldHVybiBaX0RBVEFfRVJST1I7CgkJCX0KCQkJciA9IHoudG90YWxfaW47CgkJCXcgPSB6LnRvdGFsX291dDsKCQkJaW5mbGF0ZVJlc2V0KHopOwoJCQl6LnRvdGFsX2luID0gcjsKCQkJei50b3RhbF9vdXQgPSB3OwoJCQl6LmlzdGF0ZS5tb2RlID0gQkxPQ0tTOwoJCQlyZXR1cm4gWl9PSzsKCQl9OwoKCQkvLyBSZXR1cm5zIHRydWUgaWYgaW5mbGF0ZSBpcyBjdXJyZW50bHkgYXQgdGhlIGVuZCBvZiBhIGJsb2NrIGdlbmVyYXRlZAoJCS8vIGJ5IFpfU1lOQ19GTFVTSCBvciBaX0ZVTExfRkxVU0guIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCBieSBvbmUgUFBQCgkJLy8gaW1wbGVtZW50YXRpb24gdG8gcHJvdmlkZSBhbiBhZGRpdGlvbmFsIHNhZmV0eSBjaGVjay4gUFBQIHVzZXMKCQkvLyBaX1NZTkNfRkxVU0gKCQkvLyBidXQgcmVtb3ZlcyB0aGUgbGVuZ3RoIGJ5dGVzIG9mIHRoZSByZXN1bHRpbmcgZW1wdHkgc3RvcmVkIGJsb2NrLiBXaGVuCgkJLy8gZGVjb21wcmVzc2luZywgUFBQIGNoZWNrcyB0aGF0IGF0IHRoZSBlbmQgb2YgaW5wdXQgcGFja2V0LCBpbmZsYXRlIGlzCgkJLy8gd2FpdGluZyBmb3IgdGhlc2UgbGVuZ3RoIGJ5dGVzLgoJCXRoYXQuaW5mbGF0ZVN5bmNQb2ludCA9IGZ1bmN0aW9uKHopIHsKCQkJaWYgKCF6IHx8ICF6LmlzdGF0ZSB8fCAhei5pc3RhdGUuYmxvY2tzKQoJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoJCQlyZXR1cm4gei5pc3RhdGUuYmxvY2tzLnN5bmNfcG9pbnQoKTsKCQl9OwoJfQoKCS8vIFpTdHJlYW0KCglmdW5jdGlvbiBaU3RyZWFtKCkgewoJfQoKCVpTdHJlYW0ucHJvdG90eXBlID0gewoJCWluZmxhdGVJbml0IDogZnVuY3Rpb24oYml0cykgewoJCQl2YXIgdGhhdCA9IHRoaXM7CgkJCXRoYXQuaXN0YXRlID0gbmV3IEluZmxhdGUoKTsKCQkJaWYgKCFiaXRzKQoJCQkJYml0cyA9IE1BWF9CSVRTOwoJCQlyZXR1cm4gdGhhdC5pc3RhdGUuaW5mbGF0ZUluaXQodGhhdCwgYml0cyk7CgkJfSwKCgkJaW5mbGF0ZSA6IGZ1bmN0aW9uKGYpIHsKCQkJdmFyIHRoYXQgPSB0aGlzOwoJCQlpZiAoIXRoYXQuaXN0YXRlKQoJCQkJcmV0dXJuIFpfU1RSRUFNX0VSUk9SOwoJCQlyZXR1cm4gdGhhdC5pc3RhdGUuaW5mbGF0ZSh0aGF0LCBmKTsKCQl9LAoKCQlpbmZsYXRlRW5kIDogZnVuY3Rpb24oKSB7CgkJCXZhciB0aGF0ID0gdGhpczsKCQkJaWYgKCF0aGF0LmlzdGF0ZSkKCQkJCXJldHVybiBaX1NUUkVBTV9FUlJPUjsKCQkJdmFyIHJldCA9IHRoYXQuaXN0YXRlLmluZmxhdGVFbmQodGhhdCk7CgkJCXRoYXQuaXN0YXRlID0gbnVsbDsKCQkJcmV0dXJuIHJldDsKCQl9LAoKCQlpbmZsYXRlU3luYyA6IGZ1bmN0aW9uKCkgewoJCQl2YXIgdGhhdCA9IHRoaXM7CgkJCWlmICghdGhhdC5pc3RhdGUpCgkJCQlyZXR1cm4gWl9TVFJFQU1fRVJST1I7CgkJCXJldHVybiB0aGF0LmlzdGF0ZS5pbmZsYXRlU3luYyh0aGF0KTsKCQl9LAoJCWluZmxhdGVTZXREaWN0aW9uYXJ5IDogZnVuY3Rpb24oZGljdGlvbmFyeSwgZGljdExlbmd0aCkgewoJCQl2YXIgdGhhdCA9IHRoaXM7CgkJCWlmICghdGhhdC5pc3RhdGUpCgkJCQlyZXR1cm4gWl9TVFJFQU1fRVJST1I7CgkJCXJldHVybiB0aGF0LmlzdGF0ZS5pbmZsYXRlU2V0RGljdGlvbmFyeSh0aGF0LCBkaWN0aW9uYXJ5LCBkaWN0TGVuZ3RoKTsKCQl9LAoJCXJlYWRfYnl0ZSA6IGZ1bmN0aW9uKHN0YXJ0KSB7CgkJCXZhciB0aGF0ID0gdGhpczsKCQkJcmV0dXJuIHRoYXQubmV4dF9pbi5zdWJhcnJheShzdGFydCwgc3RhcnQgKyAxKVswXTsKCQl9LAoJCXJlYWRfYnVmIDogZnVuY3Rpb24oc3RhcnQsIHNpemUpIHsKCQkJdmFyIHRoYXQgPSB0aGlzOwoJCQlyZXR1cm4gdGhhdC5uZXh0X2luLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIHNpemUpOwoJCX0KCX07CgoJLy8gSW5mbGF0ZXIKCglmdW5jdGlvbiBJbmZsYXRlcigpIHsKCQl2YXIgdGhhdCA9IHRoaXM7CgkJdmFyIHogPSBuZXcgWlN0cmVhbSgpOwoJCXZhciBidWZzaXplID0gNTEyOwoJCXZhciBmbHVzaCA9IFpfTk9fRkxVU0g7CgkJdmFyIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGJ1ZnNpemUpOwoJCXZhciBub21vcmVpbnB1dCA9IGZhbHNlOwoKCQl6LmluZmxhdGVJbml0KCk7CgkJei5uZXh0X291dCA9IGJ1ZjsKCgkJdGhhdC5hcHBlbmQgPSBmdW5jdGlvbihkYXRhLCBvbnByb2dyZXNzKSB7CgkJCXZhciBlcnIsIGJ1ZmZlcnMgPSBbXSwgbGFzdEluZGV4ID0gMCwgYnVmZmVySW5kZXggPSAwLCBidWZmZXJTaXplID0gMCwgYXJyYXk7CgkJCWlmIChkYXRhLmxlbmd0aCA9PT0gMCkKCQkJCXJldHVybjsKCQkJei5uZXh0X2luX2luZGV4ID0gMDsKCQkJei5uZXh0X2luID0gZGF0YTsKCQkJei5hdmFpbF9pbiA9IGRhdGEubGVuZ3RoOwoJCQlkbyB7CgkJCQl6Lm5leHRfb3V0X2luZGV4ID0gMDsKCQkJCXouYXZhaWxfb3V0ID0gYnVmc2l6ZTsKCQkJCWlmICgoei5hdmFpbF9pbiA9PT0gMCkgJiYgKCFub21vcmVpbnB1dCkpIHsgLy8gaWYgYnVmZmVyIGlzIGVtcHR5IGFuZCBtb3JlIGlucHV0IGlzIGF2YWlsYWJsZSwgcmVmaWxsIGl0CgkJCQkJei5uZXh0X2luX2luZGV4ID0gMDsKCQkJCQlub21vcmVpbnB1dCA9IHRydWU7CgkJCQl9CgkJCQllcnIgPSB6LmluZmxhdGUoZmx1c2gpOwoJCQkJaWYgKG5vbW9yZWlucHV0ICYmIChlcnIgPT09IFpfQlVGX0VSUk9SKSkgewoJCQkJCWlmICh6LmF2YWlsX2luICE9PSAwKQoJCQkJCQl0aHJvdyBuZXcgRXJyb3IoImluZmxhdGluZzogYmFkIGlucHV0Iik7CgkJCQl9IGVsc2UgaWYgKGVyciAhPT0gWl9PSyAmJiBlcnIgIT09IFpfU1RSRUFNX0VORCkKCQkJCQl0aHJvdyBuZXcgRXJyb3IoImluZmxhdGluZzogIiArIHoubXNnKTsKCQkJCWlmICgobm9tb3JlaW5wdXQgfHwgZXJyID09PSBaX1NUUkVBTV9FTkQpICYmICh6LmF2YWlsX2luID09PSBkYXRhLmxlbmd0aCkpCgkJCQkJdGhyb3cgbmV3IEVycm9yKCJpbmZsYXRpbmc6IGJhZCBpbnB1dCIpOwoJCQkJaWYgKHoubmV4dF9vdXRfaW5kZXgpCgkJCQkJaWYgKHoubmV4dF9vdXRfaW5kZXggPT09IGJ1ZnNpemUpCgkJCQkJCWJ1ZmZlcnMucHVzaChuZXcgVWludDhBcnJheShidWYpKTsKCQkJCQllbHNlCgkJCQkJCWJ1ZmZlcnMucHVzaChuZXcgVWludDhBcnJheShidWYuc3ViYXJyYXkoMCwgei5uZXh0X291dF9pbmRleCkpKTsKCQkJCWJ1ZmZlclNpemUgKz0gei5uZXh0X291dF9pbmRleDsKCQkJCWlmIChvbnByb2dyZXNzICYmIHoubmV4dF9pbl9pbmRleCA+IDAgJiYgei5uZXh0X2luX2luZGV4ICE9IGxhc3RJbmRleCkgewoJCQkJCW9ucHJvZ3Jlc3Moei5uZXh0X2luX2luZGV4KTsKCQkJCQlsYXN0SW5kZXggPSB6Lm5leHRfaW5faW5kZXg7CgkJCQl9CgkJCX0gd2hpbGUgKHouYXZhaWxfaW4gPiAwIHx8IHouYXZhaWxfb3V0ID09PSAwKTsKCQkJYXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXJTaXplKTsKCQkJYnVmZmVycy5mb3JFYWNoKGZ1bmN0aW9uKGNodW5rKSB7CgkJCQlhcnJheS5zZXQoY2h1bmssIGJ1ZmZlckluZGV4KTsKCQkJCWJ1ZmZlckluZGV4ICs9IGNodW5rLmxlbmd0aDsKCQkJfSk7CgkJCXJldHVybiBhcnJheTsKCQl9OwoJCXRoYXQuZmx1c2ggPSBmdW5jdGlvbigpIHsKCQkJei5pbmZsYXRlRW5kKCk7CgkJfTsKCX0KCgkvLyAnemlwJyBtYXkgbm90IGJlIGRlZmluZWQgaW4gei13b3JrZXIgYW5kIHNvbWUgdGVzdHMKCXZhciBlbnYgPSBnbG9iYWwuemlwIHx8IGdsb2JhbDsKCWVudi5JbmZsYXRlciA9IGVudi5fanpsaWJfSW5mbGF0ZXIgPSBJbmZsYXRlcjsKfSkodGhpcyk7Cg=="></script>

  <script src="data:application/javascript;base64,CmxldCBtYXBwZXJzID0gW107CgovLyB0aGUgbWFwcGVyIGZpbGVzIHdpbGwgYWRkIHRvIHRoaXMgYXJyYXkK"></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbMF0gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIk5ST00iOwogIHRoaXMudmVyc2lvbiA9IDE7CgogIHRoaXMubmVzID0gbmVzOwoKICB0aGlzLnJvbSA9IHJvbTsKCiAgdGhpcy5oID0gaGVhZGVyOwoKICB0aGlzLmNoclJhbSA9IG5ldyBVaW50OEFycmF5KDB4MjAwMCk7CiAgdGhpcy5wcmdSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oaGFyZCkgewogICAgaWYoaGFyZCkgewogICAgICAvLyBjbGVhciBjaHIgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoclJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuY2hyUmFtW2ldID0gMDsKICAgICAgfQogICAgICAvLyBjbGVhciBwcmcgcmFtLCBvbmx5IGlmIG5vdCBiYXR0ZXJ5IGJhY2tlZAogICAgICBpZighdGhpcy5oLmJhdHRlcnkpIHsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5wcmdSYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRoaXMucHJnUmFtW2ldID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gY2xlYXIgcHB1IHJhbQogICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5wcHVSYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLnBwdVJhbVtpXSA9IDA7CiAgICAgIH0KICAgIH0KICB9CiAgdGhpcy5yZXNldCh0cnVlKTsKICB0aGlzLnNhdmVWYXJzID0gWwogICAgIm5hbWUiLCAiY2hyUmFtIiwgInByZ1JhbSIsICJwcHVSYW0iCiAgXTsKCiAgdGhpcy5nZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5wcmdSYW0pOwogIH0KCiAgdGhpcy5zZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oZGF0YSkgewogICAgaWYoZGF0YS5sZW5ndGggIT09IDB4MjAwMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB0aGlzLnByZ1JhbSA9IG5ldyBVaW50OEFycmF5KGRhdGEpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICB0aGlzLmdldFJvbUFkciA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYodGhpcy5oLmJhbmtzID09PSAyKSB7CiAgICAgIHJldHVybiBhZHIgJiAweDdmZmY7CiAgICB9CiAgICByZXR1cm4gYWRyICYgMHgzZmZmOwogIH0KCiAgdGhpcy5nZXRNaXJyb3JpbmdBZHIgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKHRoaXMuaC52ZXJ0aWNhbE1pcnJvcmluZykgewogICAgICByZXR1cm4gYWRyICYgMHg3ZmY7CiAgICB9IGVsc2UgewogICAgICAvLyBob3Jpem9udGFsCiAgICAgIHJldHVybiAoYWRyICYgMHgzZmYpIHwgKChhZHIgJiAweDgwMCkgPj4gMSk7CiAgICB9CiAgfQoKICB0aGlzLmdldENockFkciA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIGFkcjsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucmVhZChhZHIpOwogIH0KCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDYwMDApIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgfQogICAgaWYoYWRyIDwgMHg4MDAwKSB7CiAgICAgIHJldHVybiB0aGlzLnByZ1JhbVthZHIgJiAweDFmZmZdOwogICAgfQogICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5iYXNlICsgdGhpcy5nZXRSb21BZHIoYWRyKV07CiAgfQoKICB0aGlzLndyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgaWYoYWRyIDwgMHg2MDAwIHx8IGFkciA+PSAweDgwMDApIHsKICAgICAgcmV0dXJuOyAvLyBubyBtYXBwZXIgcmVnaXN0ZXJzCiAgICB9CiAgICB0aGlzLnByZ1JhbVthZHIgJiAweDFmZmZdID0gdmFsdWU7CiAgfQoKICB0aGlzLnBwdVBlYWsgPSBmdW5jdGlvbihhZHIpIHsKICAgIHJldHVybiB0aGlzLnBwdVJlYWQoYWRyKTsKICB9CgogIC8vIHBwdS1yZWFkCiAgdGhpcy5wcHVSZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgaWYodGhpcy5oLmNockJhbmtzID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2hyUmFtW3RoaXMuZ2V0Q2hyQWRyKGFkcildOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnJvbVt0aGlzLmguY2hyQmFzZSArIHRoaXMuZ2V0Q2hyQWRyKGFkcildOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5wcHVSYW1bdGhpcy5nZXRNaXJyb3JpbmdBZHIoYWRyKV07CiAgICB9CiAgfQoKICAvLyBwcHUtd3JpdGUKICB0aGlzLnBwdVdyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgaWYoYWRyIDwgMHgyMDAwKSB7CiAgICAgIGlmKHRoaXMuaC5jaHJCYW5rcyA9PT0gMCkgewogICAgICAgIHRoaXMuY2hyUmFtW3RoaXMuZ2V0Q2hyQWRyKGFkcildID0gdmFsdWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIG5vdCB3cml0YWJsZQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMucHB1UmFtW3RoaXMuZ2V0TWlycm9yaW5nQWRyKGFkcildID0gdmFsdWU7CiAgICB9CiAgfQoKfQo="></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbMV0gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIk1NQzEiOwogIHRoaXMudmVyc2lvbiA9IDE7CgogIHRoaXMubmVzID0gbmVzOwoKICB0aGlzLnJvbSA9IHJvbTsKCiAgdGhpcy5oID0gaGVhZGVyOwoKICB0aGlzLmNoclJhbSA9IG5ldyBVaW50OEFycmF5KDB4MjAwMCk7CiAgdGhpcy5wcmdSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oaGFyZCkgewogICAgaWYoaGFyZCkgewogICAgICAvLyBjbGVhciBjaHIgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoclJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuY2hyUmFtW2ldID0gMDsKICAgICAgfQogICAgICAvLyBjbGVhciBwcmcgcmFtLCBvbmx5IGlmIG5vdCBiYXR0ZXJ5IGJhY2tlZAogICAgICBpZighdGhpcy5oLmJhdHRlcnkpIHsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5wcmdSYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRoaXMucHJnUmFtW2ldID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gY2xlYXIgcHB1IHJhbQogICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5wcHVSYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLnBwdVJhbVtpXSA9IDA7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnNoaWZ0UmVnID0gMDsKICAgIHRoaXMuc2hpZnRDb3VudCA9IDA7CgogICAgdGhpcy5taXJyb3JpbmcgPSAwOwogICAgdGhpcy5wcmdNb2RlID0gMzsKICAgIHRoaXMuY2hyTW9kZSA9IDE7CiAgICB0aGlzLmNockJhbmswID0gMDsKICAgIHRoaXMuY2hyQmFuazEgPSAwOwogICAgdGhpcy5wcmdCYW5rID0gMDsKICAgIHRoaXMucmFtRW5hYmxlID0gMDsKICB9CiAgdGhpcy5yZXNldCh0cnVlKTsKICB0aGlzLnNhdmVWYXJzID0gWwogICAgIm5hbWUiLCAiY2hyUmFtIiwgInByZ1JhbSIsICJwcHVSYW0iLCAic2hpZnRSZWciLCAic2hpZnRDb3VudCIsICJtaXJyb3JpbmciLAogICAgInByZ01vZGUiLCAiY2hyTW9kZSIsICJjaHJCYW5rMCIsICJjaHJCYW5rMSIsICJwcmdCYW5rIiwgInJhbUVuYWJsZSIKICBdOwoKICB0aGlzLmdldEJhdHRlcnkgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLnByZ1JhbSk7CiAgfQoKICB0aGlzLnNldEJhdHRlcnkgPSBmdW5jdGlvbihkYXRhKSB7CiAgICBpZihkYXRhLmxlbmd0aCAhPT0gMHgyMDAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHRoaXMucHJnUmFtID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHRoaXMuZ2V0Um9tQWRyID0gZnVuY3Rpb24oYWRyKSB7CiAgICBsZXQgZmluYWwgPSAwOwogICAgc3dpdGNoKHRoaXMucHJnTW9kZSkgewogICAgICBjYXNlIDA6CiAgICAgIGNhc2UgMTogewogICAgICAgIGZpbmFsID0gMHg4MDAwICogKHRoaXMucHJnQmFuayA+PiAxKSArIChhZHIgJiAweDdmZmYpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMjogewogICAgICAgIGlmKGFkciA8IDB4YzAwMCkgewogICAgICAgICAgZmluYWwgPSBhZHIgJiAweDNmZmY7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZpbmFsID0gdGhpcy5wcmdCYW5rICogMHg0MDAwICsgKGFkciAmIDB4M2ZmZik7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMzogewogICAgICAgIGlmKGFkciA8IDB4YzAwMCkgewogICAgICAgICAgZmluYWwgPSB0aGlzLnByZ0JhbmsgKiAweDQwMDAgKyAoYWRyICYgMHgzZmZmKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZmluYWwgPSAodGhpcy5oLmJhbmtzIC0gMSkgKiAweDQwMDAgKyAoYWRyICYgMHgzZmZmKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBmaW5hbCAmIHRoaXMuaC5wcmdBbmQ7CiAgfQoKICB0aGlzLmdldE1pcnJvcmluZ0FkciA9IGZ1bmN0aW9uKGFkcikgewogICAgc3dpdGNoKHRoaXMubWlycm9yaW5nKSB7CiAgICAgIGNhc2UgMDogewogICAgICAgIC8vIDEtc2NyZWVuIEEKICAgICAgICByZXR1cm4gYWRyICYgMHgzZmY7CiAgICAgIH0KICAgICAgY2FzZSAxOiB7CiAgICAgICAgLy8gMS1zY3JlZW4gQgogICAgICAgIHJldHVybiAweDQwMCArIChhZHIgJiAweDNmZik7CiAgICAgIH0KICAgICAgY2FzZSAyOiB7CiAgICAgICAgLy8gdmVydGljYWwKICAgICAgICByZXR1cm4gYWRyICYgMHg3ZmY7CiAgICAgIH0KICAgICAgY2FzZSAzOiB7CiAgICAgICAgLy8gaG9yaXpvbnRhbAogICAgICAgIHJldHVybiAoYWRyICYgMHgzZmYpIHwgKChhZHIgJiAweDgwMCkgPj4gMSk7CiAgICAgIH0KICAgIH0KICB9CgogIHRoaXMuZ2V0Q2hyQWRyID0gZnVuY3Rpb24oYWRyKSB7CiAgICBsZXQgZmluYWwgPSAwOwogICAgaWYodGhpcy5jaHJNb2RlID09PSAxKSB7CiAgICAgIGlmKGFkciA8IDB4MTAwMCkgewogICAgICAgIGZpbmFsID0gdGhpcy5jaHJCYW5rMCAqIDB4MTAwMCArIChhZHIgJiAweGZmZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmluYWwgPSB0aGlzLmNockJhbmsxICogMHgxMDAwICsgKGFkciAmIDB4ZmZmKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZmluYWwgPSAodGhpcy5jaHJCYW5rMCA+PiAxKSAqIDB4MjAwMCArIChhZHIgJiAweDFmZmYpOwogICAgfQogICAgcmV0dXJuIGZpbmFsICYgdGhpcy5oLmNockFuZDsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucmVhZChhZHIpOwogIH0KCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDYwMDApIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgfQogICAgaWYoYWRyIDwgMHg4MDAwKSB7CiAgICAgIGlmKHRoaXMucmFtRW5hYmxlID09PSAxKSB7CiAgICAgICAgcmV0dXJuIDA7IC8vIG5vdCBlbmFibGVkCiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMucHJnUmFtW2FkciAmIDB4MWZmZl07CiAgICB9CiAgICByZXR1cm4gdGhpcy5yb21bdGhpcy5oLmJhc2UgKyB0aGlzLmdldFJvbUFkcihhZHIpXTsKICB9CgogIHRoaXMud3JpdGUgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBpZihhZHIgPCAweDYwMDApIHsKICAgICAgcmV0dXJuOyAvLyBubyBtYXBwZXIgcmVnaXN0ZXJzCiAgICB9CiAgICBpZihhZHIgPCAweDgwMDApIHsKICAgICAgaWYodGhpcy5yYW1FbmFibGUgPT09IDEpIHsKICAgICAgICByZXR1cm47IC8vIG5vdCBlbmFibGVkCiAgICAgIH0KICAgICAgdGhpcy5wcmdSYW1bYWRyICYgMHgxZmZmXSA9IHZhbHVlOwogICAgICByZXR1cm47CiAgICB9CiAgICBpZigodmFsdWUgJiAweDgwKSA+IDApIHsKICAgICAgdGhpcy5zaGlmdENvdW50ID0gMDsKICAgICAgdGhpcy5zaGlmdFJlZyA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnNoaWZ0UmVnIHw9ICh2YWx1ZSAmIDB4MSkgPDwgdGhpcy5zaGlmdENvdW50OwogICAgICB0aGlzLnNoaWZ0Q291bnQrKzsKICAgICAgaWYodGhpcy5zaGlmdENvdW50ID09PSA1KSB7CiAgICAgICAgc3dpdGNoKChhZHIgJiAweDYwMDApID4+IDEzKSB7CiAgICAgICAgICBjYXNlIDA6IHsKICAgICAgICAgICAgdGhpcy5taXJyb3JpbmcgPSB0aGlzLnNoaWZ0UmVnICYgMHgzOwogICAgICAgICAgICB0aGlzLnByZ01vZGUgPSAodGhpcy5zaGlmdFJlZyAmIDB4YykgPj4gMjsKICAgICAgICAgICAgdGhpcy5jaHJNb2RlID0gKHRoaXMuc2hpZnRSZWcgJiAweDEwKSA+PiA0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGNhc2UgMTogewogICAgICAgICAgICB0aGlzLmNockJhbmswID0gdGhpcy5zaGlmdFJlZzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBjYXNlIDI6IHsKICAgICAgICAgICAgdGhpcy5jaHJCYW5rMSA9IHRoaXMuc2hpZnRSZWc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgY2FzZSAzOiB7CiAgICAgICAgICAgIHRoaXMucHJnQmFuayA9IHRoaXMuc2hpZnRSZWcgJiAweGY7CiAgICAgICAgICAgIHRoaXMucmFtRW5hYmxlID0gKHRoaXMuc2hpZnRSZWcgJiAweDEwKSA+PiA0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5zaGlmdENvdW50ID0gMDsKICAgICAgICB0aGlzLnNoaWZ0UmVnID0gMDsKICAgICAgfQogICAgfQogIH0KCiAgdGhpcy5wcHVQZWFrID0gZnVuY3Rpb24oYWRyKSB7CiAgICByZXR1cm4gdGhpcy5wcHVSZWFkKGFkcik7CiAgfQoKICAvLyBwcHUtcmVhZAogIHRoaXMucHB1UmVhZCA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYoYWRyIDwgMHgyMDAwKSB7CiAgICAgIGlmKHRoaXMuaC5jaHJCYW5rcyA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLmNoclJhbVt0aGlzLmdldENockFkcihhZHIpXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5yb21bdGhpcy5oLmNockJhc2UgKyB0aGlzLmdldENockFkcihhZHIpXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMucHB1UmFtW3RoaXMuZ2V0TWlycm9yaW5nQWRyKGFkcildOwogICAgfQogIH0KCiAgLy8gcHB1LXdyaXRlCiAgdGhpcy5wcHVXcml0ZSA9IGZ1bmN0aW9uKGFkciwgdmFsdWUpIHsKICAgIGlmKGFkciA8IDB4MjAwMCkgewogICAgICBpZih0aGlzLmguY2hyQmFua3MgPT09IDApIHsKICAgICAgICB0aGlzLmNoclJhbVt0aGlzLmdldENockFkcihhZHIpXSA9IHZhbHVlOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBub3Qgd3JpdGFibGUKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBwdVJhbVt0aGlzLmdldE1pcnJvcmluZ0FkcihhZHIpXSA9IHZhbHVlOwogICAgfQogIH0KCn0K"></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbMl0gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIlV4Uk9NIjsKICB0aGlzLnZlcnNpb24gPSAxOwoKICB0aGlzLm5lcyA9IG5lczsKCiAgdGhpcy5yb20gPSByb207CgogIHRoaXMuaCA9IGhlYWRlcjsKCiAgdGhpcy5jaHJSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oaGFyZCkgewogICAgaWYoaGFyZCkgewogICAgICAvLyBjbGVhciBjaHIgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoclJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuY2hyUmFtW2ldID0gMDsKICAgICAgfQogICAgICAvLyBjbGVhciBwcHUgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBwdVJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucHB1UmFtW2ldID0gMDsKICAgICAgfQogICAgfQoKICAgIHRoaXMucHJnQmFuayA9IDA7CiAgfQogIHRoaXMucmVzZXQodHJ1ZSk7CiAgdGhpcy5zYXZlVmFycyA9IFsKICAgICJuYW1lIiwgImNoclJhbSIsICJwcHVSYW0iLCAicHJnQmFuayIKICBdOwoKICB0aGlzLmdldEJhdHRlcnkgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBbXTsKICB9CgogIHRoaXMuc2V0QmF0dGVyeSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgdGhpcy5nZXRSb21BZHIgPSBmdW5jdGlvbihhZHIpIHsKICAgIGxldCBmaW5hbCA9IDA7CiAgICBpZihhZHIgPCAweGMwMDApIHsKICAgICAgZmluYWwgPSB0aGlzLnByZ0JhbmsgKiAweDQwMDAgKyAoYWRyICYgMHgzZmZmKTsKICAgIH0gZWxzZSB7CiAgICAgIGZpbmFsID0gKHRoaXMuaC5iYW5rcyAtIDEpICogMHg0MDAwICsgKGFkciAmIDB4M2ZmZik7CiAgICB9CiAgICByZXR1cm4gZmluYWwgJiB0aGlzLmgucHJnQW5kOwogIH0KCiAgdGhpcy5nZXRNaXJyb3JpbmdBZHIgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKHRoaXMuaC52ZXJ0aWNhbE1pcnJvcmluZykgewogICAgICByZXR1cm4gYWRyICYgMHg3ZmY7CiAgICB9IGVsc2UgewogICAgICAvLyBob3Jpem9udGFsCiAgICAgIHJldHVybiAoYWRyICYgMHgzZmYpIHwgKChhZHIgJiAweDgwMCkgPj4gMSk7CiAgICB9CiAgfQoKICB0aGlzLmdldENockFkciA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIGFkcjsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucmVhZChhZHIpOwogIH0KCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDgwMDApIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgfQogICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5iYXNlICsgdGhpcy5nZXRSb21BZHIoYWRyKV07CiAgfQoKICB0aGlzLndyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgaWYoYWRyIDwgMHg4MDAwKSB7CiAgICAgIHJldHVybjsgLy8gbm8gbWFwcGVyIHJlZ2lzdGVycyBvciBwcmctcmFtCiAgICB9CiAgICB0aGlzLnByZ0JhbmsgPSB2YWx1ZTsKICB9CgogIHRoaXMucHB1UGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucHB1UmVhZChhZHIpOwogIH0KCiAgLy8gcHB1LXJlYWQKICB0aGlzLnBwdVJlYWQgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKGFkciA8IDB4MjAwMCkgewogICAgICBpZih0aGlzLmguY2hyQmFua3MgPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5jaHJCYXNlICsgdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBwdVJhbVt0aGlzLmdldE1pcnJvcmluZ0FkcihhZHIpXTsKICAgIH0KICB9CgogIC8vIHBwdS13cml0ZQogIHRoaXMucHB1V3JpdGUgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgaWYodGhpcy5oLmNockJhbmtzID09PSAwKSB7CiAgICAgICAgdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV0gPSB2YWx1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbm90IHdyaXRhYmxlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5wcHVSYW1bdGhpcy5nZXRNaXJyb3JpbmdBZHIoYWRyKV0gPSB2YWx1ZTsKICAgIH0KICB9Cgp9Cg=="></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbM10gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIkNOUk9NIjsKICB0aGlzLnZlcnNpb24gPSAxOwoKICB0aGlzLm5lcyA9IG5lczsKCiAgdGhpcy5yb20gPSByb207CgogIHRoaXMuaCA9IGhlYWRlcjsKCiAgdGhpcy5jaHJSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oaGFyZCkgewogICAgaWYoaGFyZCkgewogICAgICAvLyBjbGVhciBjaHIgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoclJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuY2hyUmFtW2ldID0gMDsKICAgICAgfQogICAgICAvLyBjbGVhciBwcHUgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBwdVJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucHB1UmFtW2ldID0gMDsKICAgICAgfQogICAgfQoKICAgIHRoaXMuY2hyQmFuayA9IDA7CiAgfQogIHRoaXMucmVzZXQodHJ1ZSk7CiAgdGhpcy5zYXZlVmFycyA9IFsKICAgICJuYW1lIiwgImNoclJhbSIsICJwcHVSYW0iLCAiY2hyQmFuayIKICBdOwoKICB0aGlzLmdldEJhdHRlcnkgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBbXTsKICB9CgogIHRoaXMuc2V0QmF0dGVyeSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgdGhpcy5nZXRSb21BZHIgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKHRoaXMuYmFua3MgPT09IDIpIHsKICAgICAgcmV0dXJuIGFkciAmIDB4N2ZmZjsKICAgIH0KICAgIHJldHVybiBhZHIgJiAweDNmZmY7CiAgfQoKICB0aGlzLmdldE1pcnJvcmluZ0FkciA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYodGhpcy5oLnZlcnRpY2FsTWlycm9yaW5nKSB7CiAgICAgIHJldHVybiBhZHIgJiAweDdmZjsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGhvcml6b250YWwKICAgICAgcmV0dXJuIChhZHIgJiAweDNmZikgfCAoKGFkciAmIDB4ODAwKSA+PiAxKTsKICAgIH0KICB9CgogIHRoaXMuZ2V0Q2hyQWRyID0gZnVuY3Rpb24oYWRyKSB7CiAgICBsZXQgZmluYWwgPSB0aGlzLmNockJhbmsgKiAweDIwMDAgKyAoYWRyICYgMHgxZmZmKTsKICAgIHJldHVybiBmaW5hbCAmIHRoaXMuaC5jaHJBbmQ7CiAgfQoKICB0aGlzLnBlYWsgPSBmdW5jdGlvbihhZHIpIHsKICAgIHJldHVybiB0aGlzLnJlYWQoYWRyKTsKICB9CgogIHRoaXMucmVhZCA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYoYWRyIDwgMHg4MDAwKSB7CiAgICAgIHJldHVybiAwOyAvLyBub3QgcmVhZGFibGUKICAgIH0KICAgIHJldHVybiB0aGlzLnJvbVt0aGlzLmguYmFzZSArIHRoaXMuZ2V0Um9tQWRyKGFkcildOwogIH0KCiAgdGhpcy53cml0ZSA9IGZ1bmN0aW9uKGFkciwgdmFsdWUpIHsKICAgIGlmKGFkciA8IDB4ODAwMCkgewogICAgICByZXR1cm47IC8vIG5vIG1hcHBlciByZWdpc3RlcnMgb3IgcHJnIHJhbQogICAgfQogICAgdGhpcy5jaHJCYW5rID0gdmFsdWU7CiAgfQoKICB0aGlzLnBwdVBlYWsgPSBmdW5jdGlvbihhZHIpIHsKICAgIHJldHVybiB0aGlzLnBwdVJlYWQoYWRyKTsKICB9CgogIC8vIHBwdS1yZWFkCiAgdGhpcy5wcHVSZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgaWYodGhpcy5oLmNockJhbmtzID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2hyUmFtW3RoaXMuZ2V0Q2hyQWRyKGFkcildOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnJvbVt0aGlzLmguY2hyQmFzZSArIHRoaXMuZ2V0Q2hyQWRyKGFkcildOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5wcHVSYW1bdGhpcy5nZXRNaXJyb3JpbmdBZHIoYWRyKV07CiAgICB9CiAgfQoKICAvLyBwcHUtd3JpdGUKICB0aGlzLnBwdVdyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgaWYoYWRyIDwgMHgyMDAwKSB7CiAgICAgIGlmKHRoaXMuaC5jaHJCYW5rcyA9PT0gMCkgewogICAgICAgIHRoaXMuY2hyUmFtW3RoaXMuZ2V0Q2hyQWRyKGFkcildID0gdmFsdWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIG5vdCB3cml0YWJsZQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMucHB1UmFtW3RoaXMuZ2V0TWlycm9yaW5nQWRyKGFkcildID0gdmFsdWU7CiAgICB9CiAgfQoKfQo="></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbNF0gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIk1NQzMiOwogIHRoaXMudmVyc2lvbiA9IDE7CgogIHRoaXMubmVzID0gbmVzOwoKICB0aGlzLnJvbSA9IHJvbTsKCiAgdGhpcy5oID0gaGVhZGVyOwoKICB0aGlzLmNoclJhbSA9IG5ldyBVaW50OEFycmF5KDB4MjAwMCk7CiAgdGhpcy5wcmdSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLmJhbmtSZWdzID0gbmV3IFVpbnQ4QXJyYXkoOCk7CgogIHRoaXMucmVzZXQgPSBmdW5jdGlvbihoYXJkKSB7CiAgICBpZihoYXJkKSB7CiAgICAgIC8vIGNsZWFyIGNociByYW0KICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuY2hyUmFtLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5jaHJSYW1baV0gPSAwOwogICAgICB9CiAgICAgIC8vIGNsZWFyIHByZyByYW0sIG9ubHkgaWYgbm90IGJhdHRlcnkgYmFja2VkCiAgICAgIGlmKCF0aGlzLmguYmF0dGVyeSkgewogICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnByZ1JhbS5sZW5ndGg7IGkrKykgewogICAgICAgICAgdGhpcy5wcmdSYW1baV0gPSAwOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyBjbGVhciBwcHUgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBwdVJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucHB1UmFtW2ldID0gMDsKICAgICAgfQogICAgfQogICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuYmFua1JlZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5iYW5rUmVnc1tpXSA9IDA7CiAgICB9CgogICAgdGhpcy5taXJyb3JpbmcgPSAwOwogICAgdGhpcy5wcmdNb2RlID0gMTsKICAgIHRoaXMuY2hyTW9kZSA9IDE7CiAgICB0aGlzLnJlZ1NlbGVjdCA9IDA7CgogICAgdGhpcy5yZWxvYWRJcnEgPSBmYWxzZTsKICAgIHRoaXMuaXJxTGF0Y2ggPSAwOwogICAgdGhpcy5pcnFFbmFibGVkID0gZmFsc2U7CiAgICB0aGlzLmlycUNvdW50ZXIgPSAwOwoKICAgIHRoaXMubGFzdFJlYWQgPSAwOwogIH0KICB0aGlzLnJlc2V0KHRydWUpOwogIHRoaXMuc2F2ZVZhcnMgPSBbCiAgICAibmFtZSIsICJjaHJSYW0iLCAicHJnUmFtIiwgInBwdVJhbSIsICJiYW5rUmVncyIsICJtaXJyb3JpbmciLCAicHJnTW9kZSIsCiAgICAiY2hyTW9kZSIsICJyZWdTZWxlY3QiLCAicmVsb2FkSXJxIiwgImlycUxhdGNoIiwgImlycUVuYWJsZWQiLCAiaXJxQ291bnRlciIsCiAgICAibGFzdFJlYWQiCiAgXTsKCiAgdGhpcy5nZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5wcmdSYW0pOwogIH0KCiAgdGhpcy5zZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oZGF0YSkgewogICAgaWYoZGF0YS5sZW5ndGggIT09IDB4MjAwMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB0aGlzLnByZ1JhbSA9IG5ldyBVaW50OEFycmF5KGRhdGEpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICB0aGlzLmdldFJvbUFkciA9IGZ1bmN0aW9uKGFkcikgewogICAgbGV0IGZpbmFsID0gMDsKICAgIGlmKHRoaXMucHJnTW9kZSA9PT0gMSkgewogICAgICBpZihhZHIgPCAweGEwMDApIHsKICAgICAgICBmaW5hbCA9ICgodGhpcy5oLmJhbmtzICogMikgLSAyKSAqIDB4MjAwMCArIChhZHIgJiAweDFmZmYpOwogICAgICB9IGVsc2UgaWYoYWRyIDwgMHhjMDAwKSB7CiAgICAgICAgZmluYWwgPSB0aGlzLmJhbmtSZWdzWzddICogMHgyMDAwICsgKGFkciAmIDB4MWZmZik7CiAgICAgIH0gZWxzZSBpZihhZHIgPCAweGUwMDApIHsKICAgICAgICBmaW5hbCA9IHRoaXMuYmFua1JlZ3NbNl0gKiAweDIwMDAgKyAoYWRyICYgMHgxZmZmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaW5hbCA9ICgodGhpcy5oLmJhbmtzICogMikgLSAxKSAqIDB4MjAwMCArIChhZHIgJiAweDFmZmYpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZihhZHIgPCAweGEwMDApIHsKICAgICAgICBmaW5hbCA9IHRoaXMuYmFua1JlZ3NbNl0gKiAweDIwMDAgKyAoYWRyICYgMHgxZmZmKTsKICAgICAgfSBlbHNlIGlmKGFkciA8IDB4YzAwMCkgewogICAgICAgIGZpbmFsID0gdGhpcy5iYW5rUmVnc1s3XSAqIDB4MjAwMCArIChhZHIgJiAweDFmZmYpOwogICAgICB9IGVsc2UgaWYoYWRyIDwgMHhlMDAwKSB7CiAgICAgICAgZmluYWwgPSAoKHRoaXMuaC5iYW5rcyAqIDIpIC0gMikgKiAweDIwMDAgKyAoYWRyICYgMHgxZmZmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaW5hbCA9ICgodGhpcy5oLmJhbmtzICogMikgLSAxKSAqIDB4MjAwMCArIChhZHIgJiAweDFmZmYpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZmluYWwgJiB0aGlzLmgucHJnQW5kOwogIH0KCiAgdGhpcy5nZXRNaXJyb3JpbmdBZHIgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKHRoaXMubWlycm9yaW5nID09PSAwKSB7CiAgICAgIC8vIHZlcnRpY2FsCiAgICAgIHJldHVybiBhZHIgJiAweDdmZjsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGhvcml6b250YWwKICAgICAgcmV0dXJuIChhZHIgJiAweDNmZikgfCAoKGFkciAmIDB4ODAwKSA+PiAxKTsKICAgIH0KICB9CgogIHRoaXMuZ2V0Q2hyQWRyID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZih0aGlzLmNock1vZGUgPT09IDEpIHsKICAgICAgYWRyIF49IDB4MTAwMDsKICAgIH0KICAgIGxldCBmaW5hbCA9IDA7CiAgICBpZihhZHIgPCAweDgwMCkgewogICAgICBmaW5hbCA9ICh0aGlzLmJhbmtSZWdzWzBdID4+IDEpICogMHg4MDAgKyAoYWRyICYgMHg3ZmYpOwogICAgfSBlbHNlIGlmKGFkciA8IDB4MTAwMCkgewogICAgICBmaW5hbCA9ICh0aGlzLmJhbmtSZWdzWzFdID4+IDEpICogMHg4MDAgKyAoYWRyICYgMHg3ZmYpOwogICAgfSBlbHNlIGlmKGFkciA8IDB4MTQwMCkgewogICAgICBmaW5hbCA9IHRoaXMuYmFua1JlZ3NbMl0gKiAweDQwMCArIChhZHIgJiAweDNmZik7CiAgICB9IGVsc2UgaWYoYWRyIDwgMHgxODAwKSB7CiAgICAgIGZpbmFsID0gdGhpcy5iYW5rUmVnc1szXSAqIDB4NDAwICsgKGFkciAmIDB4M2ZmKTsKICAgIH0gZWxzZSBpZihhZHIgPCAweDFjMDApIHsKICAgICAgZmluYWwgPSB0aGlzLmJhbmtSZWdzWzRdICogMHg0MDAgKyAoYWRyICYgMHgzZmYpOwogICAgfSBlbHNlIHsKICAgICAgZmluYWwgPSB0aGlzLmJhbmtSZWdzWzVdICogMHg0MDAgKyAoYWRyICYgMHgzZmYpOwogICAgfQogICAgcmV0dXJuIGZpbmFsICYgdGhpcy5oLmNockFuZDsKICB9CgogIHRoaXMuY2xvY2tJcnEgPSBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuaXJxQ291bnRlciA9PT0gMCB8fCB0aGlzLnJlbG9hZElycSkgewogICAgICB0aGlzLmlycUNvdW50ZXIgPSB0aGlzLmlycUxhdGNoOwogICAgICB0aGlzLnJlbG9hZElycSA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5pcnFDb3VudGVyLS07CiAgICAgIHRoaXMuaXJxQ291bnRlciAmPSAweGZmOwogICAgfQogICAgaWYodGhpcy5pcnFDb3VudGVyID09PSAwICYmIHRoaXMuaXJxRW5hYmxlZCkgewogICAgICB0aGlzLm5lcy5tYXBwZXJJcnFXYW50ZWQgPSB0cnVlOwogICAgfQogIH0KCiAgdGhpcy5wZWFrID0gZnVuY3Rpb24oYWRyKSB7CiAgICByZXR1cm4gdGhpcy5yZWFkKGFkcik7CiAgfQoKICB0aGlzLnJlYWQgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKGFkciA8IDB4NjAwMCkgewogICAgICByZXR1cm4gMDsgLy8gbm90IHJlYWRhYmxlCiAgICB9CiAgICBpZihhZHIgPCAweDgwMDApIHsKICAgICAgcmV0dXJuIHRoaXMucHJnUmFtW2FkciAmIDB4MWZmZl07CiAgICB9CiAgICByZXR1cm4gdGhpcy5yb21bdGhpcy5oLmJhc2UgKyB0aGlzLmdldFJvbUFkcihhZHIpXTsKICB9CgogIHRoaXMud3JpdGUgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBpZihhZHIgPCAweDYwMDApIHsKICAgICAgcmV0dXJuOyAvLyBubyBtYXBwZXIgcmVnaXN0ZXJzCiAgICB9CiAgICBpZihhZHIgPCAweDgwMDApIHsKICAgICAgdGhpcy5wcmdSYW1bYWRyICYgMHgxZmZmXSA9IHZhbHVlOwogICAgICByZXR1cm47CiAgICB9CiAgICBzd2l0Y2goYWRyICYgMHg2MDAxKSB7CiAgICAgIGNhc2UgMHgwMDAwOiB7CiAgICAgICAgdGhpcy5yZWdTZWxlY3QgPSB2YWx1ZSAmIDB4NzsKICAgICAgICB0aGlzLnByZ01vZGUgPSAodmFsdWUgJiAweDQwKSA+PiA2OwogICAgICAgIHRoaXMuY2hyTW9kZSA9ICh2YWx1ZSAmIDB4ODApID4+IDc7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDAwMDE6IHsKICAgICAgICB0aGlzLmJhbmtSZWdzW3RoaXMucmVnU2VsZWN0XSA9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHgyMDAwOiB7CiAgICAgICAgdGhpcy5taXJyb3JpbmcgPSB2YWx1ZSAmIDB4MTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDB4MjAwMTogewogICAgICAgIC8vIHJhbSBwcm90ZWN0aW9uIG5vdCBpbXBsZW1lbnRlZAogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDAwOiB7CiAgICAgICAgdGhpcy5pcnFMYXRjaCA9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDAxOiB7CiAgICAgICAgdGhpcy5yZWxvYWRJcnEgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg2MDAwOiB7CiAgICAgICAgdGhpcy5pcnFFbmFibGVkID0gZmFsc2U7CiAgICAgICAgdGhpcy5uZXMubWFwcGVySXJxV2FudGVkID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDYwMDE6IHsKICAgICAgICB0aGlzLmlycUVuYWJsZWQgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICB0aGlzLnBwdVBlYWsgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKGFkciA8IDB4MjAwMCkgewogICAgICBpZih0aGlzLmguY2hyQmFua3MgPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5jaHJCYXNlICsgdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBwdVJhbVt0aGlzLmdldE1pcnJvcmluZ0FkcihhZHIpXTsKICAgIH0KICB9CgogIC8vIHBwdS1yZWFkCiAgdGhpcy5wcHVSZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgLy8gQTEyIHNob3VsZCBiZSBpZ25vcmVkIGZvciA4IGN5Y2xlcyBhZnRlciBnb2luZyBoaWdoCiAgICAgIC8vIHNlZSBodHRwczovL2ZvcnVtcy5uZXNkZXYuY29tL3ZpZXd0b3BpYy5waHA/Zj0zJnQ9MTcyOTAjcDIxNzQ1NgogICAgICAvLyBpZ25vcmUgZm9yIG5hbWV0YWJsZXMsIGZvciBub3cKICAgICAgaWYoKHRoaXMubGFzdFJlYWQgJiAweDEwMDApID09PSAwICYmIChhZHIgJiAweDEwMDApID4gMCkgewogICAgICAgIC8vIEExMiB3ZW50IGhpZ2gsIGNsb2NrIGlycQogICAgICAgIHRoaXMuY2xvY2tJcnEoKTsKICAgICAgfQogICAgICB0aGlzLmxhc3RSZWFkID0gYWRyOwogICAgICBpZih0aGlzLmguY2hyQmFua3MgPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5jaHJCYXNlICsgdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBwdVJhbVt0aGlzLmdldE1pcnJvcmluZ0FkcihhZHIpXTsKICAgIH0KICB9CgogIC8vIHBwdS13cml0ZQogIHRoaXMucHB1V3JpdGUgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgaWYodGhpcy5oLmNockJhbmtzID09PSAwKSB7CiAgICAgICAgdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV0gPSB2YWx1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbm90IHdyaXRhYmxlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5wcHVSYW1bdGhpcy5nZXRNaXJyb3JpbmdBZHIoYWRyKV0gPSB2YWx1ZTsKICAgIH0KICB9Cgp9Cg=="></script>
  <script src="data:application/javascript;base64,Cm1hcHBlcnNbN10gPSBmdW5jdGlvbihuZXMsIHJvbSwgaGVhZGVyKSB7CiAgdGhpcy5uYW1lID0gIkF4Uk9NIjsKICB0aGlzLnZlcnNpb24gPSAxOwoKICB0aGlzLm5lcyA9IG5lczsKCiAgdGhpcy5yb20gPSByb207CgogIHRoaXMuaCA9IGhlYWRlcjsKCiAgdGhpcy5jaHJSYW0gPSBuZXcgVWludDhBcnJheSgweDIwMDApOwogIHRoaXMucHB1UmFtID0gbmV3IFVpbnQ4QXJyYXkoMHg4MDApOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oaGFyZCkgewogICAgaWYoaGFyZCkgewogICAgICAvLyBjbGVhciBjaHIgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoclJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuY2hyUmFtW2ldID0gMDsKICAgICAgfQogICAgICAvLyBjbGVhciBwcHUgcmFtCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBwdVJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucHB1UmFtW2ldID0gMDsKICAgICAgfQogICAgfQoKICAgIHRoaXMucHJnQmFuayA9IDA7CiAgICB0aGlzLm1pcnJvcmluZyA9IDA7CiAgfQogIHRoaXMucmVzZXQodHJ1ZSk7CiAgdGhpcy5zYXZlVmFycyA9IFsKICAgICJuYW1lIiwgImNoclJhbSIsICJwcHVSYW0iLCAicHJnQmFuayIsICJtaXJyb3JpbmciCiAgXTsKCiAgdGhpcy5nZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gW107CiAgfQoKICB0aGlzLnNldEJhdHRlcnkgPSBmdW5jdGlvbihkYXRhKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHRoaXMuZ2V0Um9tQWRyID0gZnVuY3Rpb24oYWRyKSB7CiAgICBsZXQgZmluYWwgPSB0aGlzLnByZ0JhbmsgKiAweDgwMDAgKyAoYWRyICYgMHg3ZmZmKTsKICAgIHJldHVybiBmaW5hbCAmIHRoaXMuaC5wcmdBbmQ7CiAgfQoKICB0aGlzLmdldE1pcnJvcmluZ0FkciA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYodGhpcy5taXJyb3JpbmcgPT09IDApIHsKICAgICAgLy8gQQogICAgICByZXR1cm4gYWRyICYgMHgzZmY7CiAgICB9IGVsc2UgewogICAgICAvLyBCCiAgICAgIHJldHVybiAweDQwMCArIChhZHIgJiAweDNmZik7CiAgICB9CiAgfQoKICB0aGlzLmdldENockFkciA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIGFkcjsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucmVhZChhZHIpOwogIH0KCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPCAweDgwMDApIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgfQogICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5iYXNlICsgdGhpcy5nZXRSb21BZHIoYWRyKV07CiAgfQoKICB0aGlzLndyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgaWYoYWRyIDwgMHg4MDAwKSB7CiAgICAgIHJldHVybjsgLy8gbm8gbWFwcGVyIHJlZ2lzdGVycyBvciBycGctcmFtCiAgICB9CiAgICB0aGlzLnByZ0JhbmsgPSB2YWx1ZSAmIDB4ZjsKICAgIHRoaXMubWlycm9yaW5nID0gKHZhbHVlICYgMHgxMCkgPj4gNDsKICB9CgogIHRoaXMucHB1UGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgcmV0dXJuIHRoaXMucHB1UmVhZChhZHIpOwogIH0KCiAgLy8gcHB1LXJlYWQKICB0aGlzLnBwdVJlYWQgPSBmdW5jdGlvbihhZHIpIHsKICAgIGlmKGFkciA8IDB4MjAwMCkgewogICAgICBpZih0aGlzLmguY2hyQmFua3MgPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMucm9tW3RoaXMuaC5jaHJCYXNlICsgdGhpcy5nZXRDaHJBZHIoYWRyKV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLnBwdVJhbVt0aGlzLmdldE1pcnJvcmluZ0FkcihhZHIpXTsKICAgIH0KICB9CgogIC8vIHBwdS13cml0ZQogIHRoaXMucHB1V3JpdGUgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBpZihhZHIgPCAweDIwMDApIHsKICAgICAgaWYodGhpcy5oLmNockJhbmtzID09PSAwKSB7CiAgICAgICAgdGhpcy5jaHJSYW1bdGhpcy5nZXRDaHJBZHIoYWRyKV0gPSB2YWx1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbm90IHdyaXRhYmxlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdGhpcy5wcHVSYW1bdGhpcy5nZXRNaXJyb3JpbmdBZHIoYWRyKV0gPSB2YWx1ZTsKICAgIH0KICB9Cgp9Cg=="></script>

  <script src="data:application/javascript;base64,CkNwdSA9IChmdW5jdGlvbigpIHsKICAvL2FkcmVzc2luZyBtb2RlcwogIGNvbnN0IElNUCA9IDA7IC8vIGFsc28gYWNjdW11bGF0b3ItbW9kZQogIGNvbnN0IElNTSA9IDE7CiAgY29uc3QgWlAgPSAyOwogIGNvbnN0IFpQWCA9IDM7CiAgY29uc3QgWlBZID0gNDsKICBjb25zdCBJWlggPSA1OwogIGNvbnN0IElaWSA9IDY7CiAgY29uc3QgQUJTID0gNzsKICBjb25zdCBBQlggPSA4OwogIGNvbnN0IEFCWSA9IDk7CiAgY29uc3QgSU5EID0gMTE7CiAgY29uc3QgUkVMID0gMTI7CiAgY29uc3QgSVpZciA9IDEzOyAvLyBmb3IgcmVhZCBpbnN0cnVjdGlvbnMsIHdpdGggb3B0aW9uYWwgZXh0cmEgY3ljbGUKICBjb25zdCBBQlhyID0gMTQ7IC8vIFJNVyBhbmQgd3JpdGVzIGFsd2F5cyBoYXZlIHRoZSBleHRyYSBjeWNsZQogIGNvbnN0IEFCWXIgPSAxNTsKCiAgLy8gcmVnaXN0ZXIgaW5kZXhlcyBpbiBhcnJheXMKICBjb25zdCBBID0gMDsKICBjb25zdCBYID0gMTsKICBjb25zdCBZID0gMjsKICBjb25zdCBTUCA9IDM7CiAgY29uc3QgUEMgPSAwOwoKICByZXR1cm4gZnVuY3Rpb24obWVtKSB7CiAgICAvLyByZWdpc3RlcnMKICAgIHRoaXMuciA9IG5ldyBVaW50OEFycmF5KDQpOwogICAgdGhpcy5iciA9IG5ldyBVaW50MTZBcnJheSgxKTsKCiAgICAvLyBtZW1vcnkgaGFuZGxlcgogICAgdGhpcy5tZW0gPSBtZW07CgogICAgdGhpcy5yZXNldCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJbQV0gPSAwOwogICAgICB0aGlzLnJbWF0gPSAwOwogICAgICB0aGlzLnJbWV0gPSAwOwogICAgICB0aGlzLnJbU1BdID0gMHhmZDsKICAgICAgaWYodGhpcy5tZW0ucmVhZCkgewogICAgICAgIHRoaXMuYnJbUENdID0gdGhpcy5tZW0ucmVhZCgweGZmZmMpIHwgKHRoaXMubWVtLnJlYWQoMHhmZmZkKSA8PCA4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBpZiB0aGUgcmVhZCBmdW5jdGlvbiBpbiB0aGUgbWVtLWhhbmRsZXIgaGFzIG5vdCBiZWVuIGRlZmluZWQgeWV0CiAgICAgICAgdGhpcy5icltQQ10gPSAwOwogICAgICB9CgogICAgICAvLyBmbGFncwogICAgICB0aGlzLm4gPSBmYWxzZTsKICAgICAgdGhpcy52ID0gZmFsc2U7CiAgICAgIHRoaXMuZCA9IGZhbHNlOwogICAgICB0aGlzLmkgPSB0cnVlOwogICAgICB0aGlzLnogPSBmYWxzZTsKICAgICAgdGhpcy5jID0gZmFsc2U7CgogICAgICAvLyBpbnRlcnJ1cHQgd2FudGVkCiAgICAgIHRoaXMuaXJxV2FudGVkID0gZmFsc2U7CiAgICAgIHRoaXMubm1pV2FudGVkID0gZmFsc2U7CgogICAgICAvLyBjeWNsZXMgbGVmdAogICAgICB0aGlzLmN5Y2xlc0xlZnQgPSA3OwogICAgfQogICAgdGhpcy5yZXNldCgpOwogICAgdGhpcy5zYXZlVmFycyA9IFsKICAgICAgInIiLCAiYnIiLCAibiIsICJ2IiwgImQiLCAiaSIsICJ6IiwgImMiLCAiaXJxV2FudGVkIiwgIm5taVdhbnRlZCIsCiAgICAgICJjeWNsZXNMZWZ0IgogICAgXTsKCiAgICAvLyBpbnN0cnVjdGlvbiBtYXBzCgogICAgdGhpcy5hZGRyZXNzaW5nTW9kZXMgPSBbCiAgICAgIC8veDAgeDEgICB4MiAgIHgzICAgeDQgICB4NSAgIHg2ICAgeDcgICB4OCAgIHg5ICAgeGEgICB4YiAgIHhjICAgeGQgICB4ZSAgIHhmCiAgICAgIElNUCwgSVpYLCBJTVAsIElaWCwgWlAgLCBaUCAsIFpQICwgWlAgLCBJTVAsIElNTSwgSU1QLCBJTU0sIEFCUywgQUJTLCBBQlMsIEFCUywgLy8weAogICAgICBSRUwsIElaWXIsSU1QLCBJWlksIFpQWCwgWlBYLCBaUFgsIFpQWCwgSU1QLCBBQllyLElNUCwgQUJZLCBBQlhyLEFCWHIsQUJYLCBBQlgsIC8vMXgKICAgICAgQUJTLCBJWlgsIElNUCwgSVpYLCBaUCAsIFpQICwgWlAgLCBaUCAsIElNUCwgSU1NLCBJTVAsIElNTSwgQUJTLCBBQlMsIEFCUywgQUJTLCAvLzJ4CiAgICAgIFJFTCwgSVpZcixJTVAsIElaWSwgWlBYLCBaUFgsIFpQWCwgWlBYLCBJTVAsIEFCWXIsSU1QLCBBQlksIEFCWHIsQUJYcixBQlgsIEFCWCwgLy8zeAogICAgICBJTVAsIElaWCwgSU1QLCBJWlgsIFpQICwgWlAgLCBaUCAsIFpQICwgSU1QLCBJTU0sIElNUCwgSU1NLCBBQlMsIEFCUywgQUJTLCBBQlMsIC8vNHgKICAgICAgUkVMLCBJWllyLElNUCwgSVpZLCBaUFgsIFpQWCwgWlBYLCBaUFgsIElNUCwgQUJZcixJTVAsIEFCWSwgQUJYcixBQlhyLEFCWCwgQUJYLCAvLzV4CiAgICAgIElNUCwgSVpYLCBJTVAsIElaWCwgWlAgLCBaUCAsIFpQICwgWlAgLCBJTVAsIElNTSwgSU1QLCBJTU0sIElORCwgQUJTLCBBQlMsIEFCUywgLy82eAogICAgICBSRUwsIElaWXIsSU1QLCBJWlksIFpQWCwgWlBYLCBaUFgsIFpQWCwgSU1QLCBBQllyLElNUCwgQUJZLCBBQlhyLEFCWHIsQUJYLCBBQlgsIC8vN3gKICAgICAgSU1NLCBJWlgsIElNTSwgSVpYLCBaUCAsIFpQICwgWlAgLCBaUCAsIElNUCwgSU1NLCBJTVAsIElNTSwgQUJTLCBBQlMsIEFCUywgQUJTLCAvLzh4CiAgICAgIFJFTCwgSVpZLCBJTVAsIElaWSwgWlBYLCBaUFgsIFpQWSwgWlBZLCBJTVAsIEFCWSwgSU1QLCBBQlksIEFCWCwgQUJYLCBBQlksIEFCWSwgLy85eAogICAgICBJTU0sIElaWCwgSU1NLCBJWlgsIFpQICwgWlAgLCBaUCAsIFpQICwgSU1QLCBJTU0sIElNUCwgSU1NLCBBQlMsIEFCUywgQUJTLCBBQlMsIC8vYXgKICAgICAgUkVMLCBJWllyLElNUCwgSVpZcixaUFgsIFpQWCwgWlBZLCBaUFksIElNUCwgQUJZcixJTVAsIEFCWXIsQUJYcixBQlhyLEFCWXIsQUJZciwvL2J4CiAgICAgIElNTSwgSVpYLCBJTU0sIElaWCwgWlAgLCBaUCAsIFpQICwgWlAgLCBJTVAsIElNTSwgSU1QLCBJTU0sIEFCUywgQUJTLCBBQlMsIEFCUywgLy9jeAogICAgICBSRUwsIElaWXIsSU1QLCBJWlksIFpQWCwgWlBYLCBaUFgsIFpQWCwgSU1QLCBBQllyLElNUCwgQUJZLCBBQlhyLEFCWHIsQUJYLCBBQlgsIC8vZHgKICAgICAgSU1NLCBJWlgsIElNTSwgSVpYLCBaUCAsIFpQICwgWlAgLCBaUCAsIElNUCwgSU1NLCBJTVAsIElNTSwgQUJTLCBBQlMsIEFCUywgQUJTLCAvL2V4CiAgICAgIFJFTCwgSVpZcixJTVAsIElaWSwgWlBYLCBaUFgsIFpQWCwgWlBYLCBJTVAsIEFCWXIsSU1QLCBBQlksIEFCWHIsQUJYcixBQlgsIEFCWCwgLy9meAogICAgXTsKCiAgICB0aGlzLmN5Y2xlcyA9IFsKICAgICAgLy8weDEgeDIgeDMgeDQgeDUgeDYgeDcgeDggeDkgeGEgeGIgeGMgeGQgeGUgeGYKICAgICAgNywgNiwgMiwgOCwgMywgMywgNSwgNSwgMywgMiwgMiwgMiwgNCwgNCwgNiwgNiwgLy8weAogICAgICAyLCA1LCAyLCA4LCA0LCA0LCA2LCA2LCAyLCA0LCAyLCA3LCA0LCA0LCA3LCA3LCAvLzF4CiAgICAgIDYsIDYsIDIsIDgsIDMsIDMsIDUsIDUsIDQsIDIsIDIsIDIsIDQsIDQsIDYsIDYsIC8vMngKICAgICAgMiwgNSwgMiwgOCwgNCwgNCwgNiwgNiwgMiwgNCwgMiwgNywgNCwgNCwgNywgNywgLy8zeAogICAgICA2LCA2LCAyLCA4LCAzLCAzLCA1LCA1LCAzLCAyLCAyLCAyLCAzLCA0LCA2LCA2LCAvLzR4CiAgICAgIDIsIDUsIDIsIDgsIDQsIDQsIDYsIDYsIDIsIDQsIDIsIDcsIDQsIDQsIDcsIDcsIC8vNXgKICAgICAgNiwgNiwgMiwgOCwgMywgMywgNSwgNSwgNCwgMiwgMiwgMiwgNSwgNCwgNiwgNiwgLy82eAogICAgICAyLCA1LCAyLCA4LCA0LCA0LCA2LCA2LCAyLCA0LCAyLCA3LCA0LCA0LCA3LCA3LCAvLzd4CiAgICAgIDIsIDYsIDIsIDYsIDMsIDMsIDMsIDMsIDIsIDIsIDIsIDIsIDQsIDQsIDQsIDQsIC8vOHgKICAgICAgMiwgNiwgMiwgNiwgNCwgNCwgNCwgNCwgMiwgNSwgMiwgNSwgNSwgNSwgNSwgNSwgLy85eAogICAgICAyLCA2LCAyLCA2LCAzLCAzLCAzLCAzLCAyLCAyLCAyLCAyLCA0LCA0LCA0LCA0LCAvL2F4CiAgICAgIDIsIDUsIDIsIDUsIDQsIDQsIDQsIDQsIDIsIDQsIDIsIDQsIDQsIDQsIDQsIDQsIC8vYngKICAgICAgMiwgNiwgMiwgOCwgMywgMywgNSwgNSwgMiwgMiwgMiwgMiwgNCwgNCwgNiwgNiwgLy9jeAogICAgICAyLCA1LCAyLCA4LCA0LCA0LCA2LCA2LCAyLCA0LCAyLCA3LCA0LCA0LCA3LCA3LCAvL2R4CiAgICAgIDIsIDYsIDIsIDgsIDMsIDMsIDUsIDUsIDIsIDIsIDIsIDIsIDQsIDQsIDYsIDYsIC8vZXgKICAgICAgMiwgNSwgMiwgOCwgNCwgNCwgNiwgNiwgMiwgNCwgMiwgNywgNCwgNCwgNywgNywgLy9meAogICAgXQoKICAgIC8vIGZ1bmN0aW9uIHRhYmxlIGlzIGF0IGJvdHRvbQoKICAgIHRoaXMuY3ljbGUgPSBmdW5jdGlvbigpIHsKICAgICAgaWYodGhpcy5jeWNsZXNMZWZ0ID09PSAwKSB7CiAgICAgICAgLy8gcmVhZCB0aGUgaW5zdHJ1Y3Rpb24gYnl0ZSBhbmQgZ2V0IHRoZSBpbmZvCiAgICAgICAgbGV0IGluc3RyID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICBsZXQgbW9kZSA9IHRoaXMuYWRkcmVzc2luZ01vZGVzW2luc3RyXTsKICAgICAgICB0aGlzLmN5Y2xlc0xlZnQgPSB0aGlzLmN5Y2xlc1tpbnN0cl07CiAgICAgICAgLy8gdGVzdCBmb3Igd2FudGluZyBhbiBpbnRlcnJ1cHQKICAgICAgICBpZih0aGlzLm5taVdhbnRlZCB8fCAodGhpcy5pcnFXYW50ZWQgJiYgIXRoaXMuaSkpIHsKICAgICAgICAgIC8vIHdlIHdhbnQgYSBpbnRlcnJ1cHQsIHNvIHB1c2ggYSBzcGVjaWFsIGluc3R1Y3Rpb24gdHlwZSBpbiBpbnN0cgogICAgICAgICAgdGhpcy5icltQQ10tLTsKICAgICAgICAgIGlmKHRoaXMubm1pV2FudGVkKSB7CiAgICAgICAgICAgIHRoaXMubm1pV2FudGVkID0gZmFsc2U7CiAgICAgICAgICAgIGluc3RyID0gMHgxMDA7IC8vIE5NSQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW5zdHIgPSAweDEwMTsgLy8gSVJRCiAgICAgICAgICB9CiAgICAgICAgICBtb2RlID0gSU1QOwogICAgICAgICAgdGhpcy5jeWNsZXNMZWZ0ID0gNzsKICAgICAgICB9CiAgICAgICAgLy8gZ2V0IHRoZSBlZmZlY3RpdmUgYWRkcmVzcywgYW5kIGV4ZWN1dGUgdGhlIGluc3RydWN0aW9uCiAgICAgICAgbGV0IGVmZiA9IHRoaXMuZ2V0QWRyKG1vZGUpOwogICAgICAgIHRoaXMuZnVuY3Rpb25zW2luc3RyXS5jYWxsKHRoaXMsIGVmZiwgaW5zdHIpOwogICAgICB9CiAgICAgIHRoaXMuY3ljbGVzTGVmdC0tOwogICAgfQoKICAgIC8vIGNyZWF0ZSBhIFAgdmFsdWUgZnJvbSB0aGUgZmxhZ3MKICAgIHRoaXMuZ2V0UCA9IGZ1bmN0aW9uKGJGbGFnKSB7CiAgICAgIGxldCB2YWx1ZSA9IDA7CgogICAgICB2YWx1ZSB8PSB0aGlzLm4gPyAweDgwIDogMDsKICAgICAgdmFsdWUgfD0gdGhpcy52ID8gMHg0MCA6IDA7CiAgICAgIHZhbHVlIHw9IHRoaXMuZCA/IDB4MDggOiAwOwogICAgICB2YWx1ZSB8PSB0aGlzLmkgPyAweDA0IDogMDsKICAgICAgdmFsdWUgfD0gdGhpcy56ID8gMHgwMiA6IDA7CiAgICAgIHZhbHVlIHw9IHRoaXMuYyA/IDB4MDEgOiAwOwogICAgICB2YWx1ZSB8PSAweDIwOyAvLyBiaXQgNSBpcyBhbHdheXMgc2V0CiAgICAgIHZhbHVlIHw9IGJGbGFnID8gMHgxMCA6IDA7CgogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CgogICAgLy8gc2V0IHRoZSBmbGFncyBhY2NvcmRpbmcgdG8gYSBQIHZhbHVlCiAgICB0aGlzLnNldFAgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgICB0aGlzLm4gPSAodmFsdWUgJiAweDgwKSA+IDA7CiAgICAgIHRoaXMudiA9ICh2YWx1ZSAmIDB4NDApID4gMDsKICAgICAgdGhpcy5kID0gKHZhbHVlICYgMHgwOCkgPiAwOwogICAgICB0aGlzLmkgPSAodmFsdWUgJiAweDA0KSA+IDA7CiAgICAgIHRoaXMueiA9ICh2YWx1ZSAmIDB4MDIpID4gMDsKICAgICAgdGhpcy5jID0gKHZhbHVlICYgMHgwMSkgPiAwOwogICAgfQoKICAgIC8vIHNldCBaICh6ZXJvIGZsYWcpIGFuZCBOIChvdmVyZmxvdyBmbGFnKSBhY2NvcmRpbmcgdG8gdGhlIHZhbHVlCiAgICB0aGlzLnNldFphbmROID0gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgdmFsdWUgJj0gMHhmZjsKICAgICAgdGhpcy56ID0gdmFsdWUgPT09IDA7CiAgICAgIHRoaXMubiA9IHZhbHVlID4gMHg3ZjsKICAgIH0KCiAgICAvLyBnZXQgYSBzaW5nZWQgdmFsdWUgKC0xMjggLSAxMjcpIG91dCBvZiBhIHVuc2lnbmVkIG9uZSAoMCAtIDI1NSkKICAgIHRoaXMuZ2V0U2lnbmVkID0gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgaWYodmFsdWUgPiAxMjcpIHsKICAgICAgICByZXR1cm4gLSgyNTYgLSB2YWx1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIHRoaXMuZG9CcmFuY2ggPSBmdW5jdGlvbih0ZXN0LCByZWwpIHsKICAgICAgaWYodGVzdCkgewogICAgICAgIC8vIHRha2VuIGJyYW5jaDogMSBleHRyYSBjeWNsZQogICAgICAgIHRoaXMuY3ljbGVzTGVmdCsrOwogICAgICAgIGlmKCh0aGlzLmJyW1BDXSA+PiA4KSAhPT0gKCh0aGlzLmJyW1BDXSArIHJlbCkgPj4gOCkpIHsKICAgICAgICAgIC8vIHRha2VuIGJyYW5jaCBhY3Jvc3MgcGFnZTogYW5vdGhlciBleHRyYSBjeWNsZQogICAgICAgICAgdGhpcy5jeWNsZXNMZWZ0Kys7CiAgICAgICAgfQogICAgICAgIHRoaXMuYnJbUENdICs9IHJlbDsKICAgICAgfQogICAgfQoKICAgIC8vIGFmdGVyIGZldGNoaW5nIHRoZSBpbnN0cnVjdGlvbiBieXRlLCB0aGlzIGdldHMgdGhlIGFkZHJlc3MgdG8gYWZmZWN0CiAgICAvLyBwYyBpcyBwb2ludGluZyB0byBieXRlIGFmdGVyIGluc3RydWN0aW9uIGJ5dGUKICAgIHRoaXMuZ2V0QWRyID0gZnVuY3Rpb24obW9kZSkgewogICAgICBzd2l0Y2gobW9kZSkgewogICAgICAgIGNhc2UgSU1QOiB7CiAgICAgICAgICAvLyBpbXBsaWVkLCB3b250IHVzZSBhbiBhZGRyZXNzCiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgY2FzZSBJTU06IHsKICAgICAgICAgIC8vIGltbWVkaWF0ZQogICAgICAgICAgcmV0dXJuIHRoaXMuYnJbUENdKys7CiAgICAgICAgfQogICAgICAgIGNhc2UgWlA6IHsKICAgICAgICAgIC8vIHplcm8gcGFnZQogICAgICAgICAgcmV0dXJuIHRoaXMubWVtLnJlYWQodGhpcy5icltQQ10rKyk7CiAgICAgICAgfQogICAgICAgIGNhc2UgWlBYOiB7CiAgICAgICAgICAvLyB6ZXJvIHBhZ2UsIGluZGV4ZWQgYnkgeAogICAgICAgICAgbGV0IGFkciA9IHRoaXMubWVtLnJlYWQodGhpcy5icltQQ10rKyk7CiAgICAgICAgICByZXR1cm4gKGFkciArIHRoaXMucltYXSkgJiAweGZmOwogICAgICAgIH0KICAgICAgICBjYXNlIFpQWTogewogICAgICAgICAgLy8gemVybyBwYWdlLCBpbmRleGVkIGJ5IHkKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgcmV0dXJuIChhZHIgKyB0aGlzLnJbWV0pICYgMHhmZjsKICAgICAgICB9CiAgICAgICAgY2FzZSBJWlg6IHsKICAgICAgICAgIC8vIHplcm8gcGFnZSwgaW5kZXhlZCBpbmRpcmVjdCBieSB4CiAgICAgICAgICBsZXQgYWRyID0gKHRoaXMubWVtLnJlYWQodGhpcy5icltQQ10rKykgKyB0aGlzLnJbWF0pICYgMHhmZjsKICAgICAgICAgIHJldHVybiB0aGlzLm1lbS5yZWFkKGFkcikgfCAodGhpcy5tZW0ucmVhZCgoYWRyICsgMSkgJiAweGZmKSA8PCA4KTsKICAgICAgICB9CiAgICAgICAgY2FzZSBJWlk6IHsKICAgICAgICAgIC8vIHplcm8gcGFnZSwgaW5kaXJlY3QgaW5kZXhlZCBieSB5IChmb3IgUk1XIGFuZCB3cml0ZXMpCiAgICAgICAgICBsZXQgYWRyID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICAgIGxldCByYWRyID0gdGhpcy5tZW0ucmVhZChhZHIpIHwgKHRoaXMubWVtLnJlYWQoKGFkciArIDEpICYgMHhmZikgPDwgOCk7CiAgICAgICAgICByZXR1cm4gKHJhZHIgKyB0aGlzLnJbWV0pICYgMHhmZmZmOwogICAgICAgIH0KICAgICAgICBjYXNlIElaWXI6IHsKICAgICAgICAgIC8vIHplcm8gcGFnZSwgaW5kaXJlY3QgaW5kZXhlZCBieSB5IChmb3IgcmVhZHMpCiAgICAgICAgICBsZXQgYWRyID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICAgIGxldCByYWRyID0gdGhpcy5tZW0ucmVhZChhZHIpIHwgKHRoaXMubWVtLnJlYWQoKGFkciArIDEpICYgMHhmZikgPDwgOCk7CiAgICAgICAgICBpZigocmFkciA+PiA4KSA8ICgocmFkciArIHRoaXMucltZXSkgPj4gOCkpIHsKICAgICAgICAgICAgdGhpcy5jeWNsZXNMZWZ0Kys7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gKHJhZHIgKyB0aGlzLnJbWV0pICYgMHhmZmZmOwogICAgICAgIH0KICAgICAgICBjYXNlIEFCUzogewogICAgICAgICAgLy8gYWJzb2x1dGUKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgYWRyIHw9ICh0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspIDw8IDgpOwogICAgICAgICAgcmV0dXJuIGFkcjsKICAgICAgICB9CiAgICAgICAgY2FzZSBBQlg6IHsKICAgICAgICAgIC8vIGFic29sdXRlLCBpbmRleGVkIGJ5IHggKGZvciBSTVcgYW5kIHdyaXRlcykKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgYWRyIHw9ICh0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspIDw8IDgpOwogICAgICAgICAgcmV0dXJuIChhZHIgKyB0aGlzLnJbWF0pICYgMHhmZmZmOwogICAgICAgIH0KICAgICAgICBjYXNlIEFCWHI6IHsKICAgICAgICAgIC8vIGFic29sdXRlLCBpbmRleGVkIGJ5IHggKGZvciByZWFkcykKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgYWRyIHw9ICh0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspIDw8IDgpOwogICAgICAgICAgaWYoKGFkciA+PiA4KSA8ICgoYWRyICsgdGhpcy5yW1hdKSA+PiA4KSkgewogICAgICAgICAgICB0aGlzLmN5Y2xlc0xlZnQrKzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiAoYWRyICsgdGhpcy5yW1hdKSAmIDB4ZmZmZjsKICAgICAgICB9CiAgICAgICAgY2FzZSBBQlk6IHsKICAgICAgICAgIC8vIGFic29sdXRlLCBpbmRleGVkIGJ5IHkgKGZvciBSTVcgYW5kIHdyaXRlcykKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgYWRyIHw9ICh0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspIDw8IDgpOwogICAgICAgICAgcmV0dXJuIChhZHIgKyB0aGlzLnJbWV0pICYgMHhmZmZmOwogICAgICAgIH0KICAgICAgICBjYXNlIEFCWXI6IHsKICAgICAgICAgIC8vIGFic29sdXRlLCBpbmRleGVkIGJ5IHkgKGZvciByZWFkcykKICAgICAgICAgIGxldCBhZHIgPSB0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspOwogICAgICAgICAgYWRyIHw9ICh0aGlzLm1lbS5yZWFkKHRoaXMuYnJbUENdKyspIDw8IDgpOwogICAgICAgICAgaWYoKGFkciA+PiA4KSA8ICgoYWRyICsgdGhpcy5yW1ldKSA+PiA4KSkgewogICAgICAgICAgICB0aGlzLmN5Y2xlc0xlZnQrKzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiAoYWRyICsgdGhpcy5yW1ldKSAmIDB4ZmZmZjsKICAgICAgICB9CiAgICAgICAgY2FzZSBJTkQ6IHsKICAgICAgICAgIC8vIGluZGlyZWN0LCBkb2Vzbid0IGxvb3AgcGFnZXMgcHJvcGVybHkKICAgICAgICAgIGxldCBhZHJsID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICAgIGxldCBhZHJoID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICAgIGxldCByYWRyID0gdGhpcy5tZW0ucmVhZChhZHJsIHwgKGFkcmggPDwgOCkpOwogICAgICAgICAgcmFkciB8PSAodGhpcy5tZW0ucmVhZCgoKGFkcmwgKyAxKSAmIDB4ZmYpIHwgKGFkcmggPDwgOCkpKSA8PCA4OwogICAgICAgICAgcmV0dXJuIHJhZHI7CiAgICAgICAgfQogICAgICAgIGNhc2UgUkVMOiB7CiAgICAgICAgICAvLyByZWxhdGl2ZSB0byBQQywgZm9yIGJyYW5jaGVzCiAgICAgICAgICBsZXQgcmVsID0gdGhpcy5tZW0ucmVhZCh0aGlzLmJyW1BDXSsrKTsKICAgICAgICAgIHJldHVybiB0aGlzLmdldFNpZ25lZChyZWwpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIGluc3RydWN0aW9uIGZ1bmN0aW9ucwoKICAgIHRoaXMudW5pID0gZnVuY3Rpb24oYWRyLCBudW0pIHsKICAgICAgLy8gdW5pbXBsZW1lbnRlZCBpbnN0cnVjdGlvbgogICAgICBsb2coInVuaW1wbGVtZW50ZWQgaW5zdHJ1Y3Rpb24gIiArIHRoaXMubWVtLmdldEJ5dGVSZXAobnVtKSk7CiAgICB9CgogICAgdGhpcy5vcmEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gT1JzIEEgd2l0aCB0aGUgdmFsdWUsIHNldCBaIGFuZCBOCiAgICAgIHRoaXMucltBXSB8PSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLmFuZCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBBTkRzIEEgd2l0aCB0aGUgdmFsdWUsIHNldCBaIGFuZCBOCiAgICAgIHRoaXMucltBXSAmPSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLmVvciA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBYT1JzIEEgd2l0aCB0aGUgdmFsdWUsIHNldCBaIGFuZCBOCiAgICAgIHRoaXMucltBXSBePSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLmFkYyA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBhZGRzIHRoZSB2YWx1ZSArIEMgdG8gQSwgc2V0IEMsIFYsIFogYW5kIE4KICAgICAgbGV0IHZhbHVlID0gdGhpcy5tZW0ucmVhZChhZHIpOwogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yW0FdICsgdmFsdWUgKyAodGhpcy5jID8gMSA6IDApOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnYgPSAoCiAgICAgICAgKHRoaXMucltBXSAmIDB4ODApID09PSAodmFsdWUgJiAweDgwKSAmJgogICAgICAgICh2YWx1ZSAmIDB4ODApICE9PSAocmVzdWx0ICYgMHg4MCkKICAgICAgKTsKICAgICAgdGhpcy5yW0FdID0gcmVzdWx0OwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltBXSk7CiAgICB9CgogICAgdGhpcy5zYmMgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc3VidHJhY3RzIHRoZSB2YWx1ZSArICFDIGZyb20gQSwgc2V0IEMsIFYsIFogYW5kIE4KICAgICAgbGV0IHZhbHVlID0gdGhpcy5tZW0ucmVhZChhZHIpIF4gMHhmZjsKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMucltBXSArIHZhbHVlICsgKHRoaXMuYyA/IDEgOiAwKTsKICAgICAgdGhpcy5jID0gcmVzdWx0ID4gMHhmZjsKICAgICAgdGhpcy52ID0gKAogICAgICAgICh0aGlzLnJbQV0gJiAweDgwKSA9PT0gKHZhbHVlICYgMHg4MCkgJiYKICAgICAgICAodmFsdWUgJiAweDgwKSAhPT0gKHJlc3VsdCAmIDB4ODApCiAgICAgICk7CiAgICAgIHRoaXMucltBXSA9IHJlc3VsdDsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbQV0pOwogICAgfQoKICAgIHRoaXMuY21wID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHNldHMgQywgWiBhbmQgTiBhY2NvcmRpbmcgdG8gd2hhdCBBIC0gdmFsdWUgd291bGQgZG8KICAgICAgbGV0IHZhbHVlID0gdGhpcy5tZW0ucmVhZChhZHIpIF4gMHhmZjsKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMucltBXSArIHZhbHVlICsgMTsKICAgICAgdGhpcy5jID0gcmVzdWx0ID4gMHhmZjsKICAgICAgdGhpcy5zZXRaYW5kTihyZXN1bHQgJiAweGZmKTsKICAgIH0KCiAgICB0aGlzLmNweCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzZXRzIEMsIFogYW5kIE4gYWNjb3JkaW5nIHRvIHdoYXQgWCAtIHZhbHVlIHdvdWxkIGRvCiAgICAgIGxldCB2YWx1ZSA9IHRoaXMubWVtLnJlYWQoYWRyKSBeIDB4ZmY7CiAgICAgIGxldCByZXN1bHQgPSB0aGlzLnJbWF0gKyB2YWx1ZSArIDE7CiAgICAgIHRoaXMuYyA9IHJlc3VsdCA+IDB4ZmY7CiAgICAgIHRoaXMuc2V0WmFuZE4ocmVzdWx0ICYgMHhmZik7CiAgICB9CgogICAgdGhpcy5jcHkgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc2V0cyBDLCBaIGFuZCBOIGFjY29yZGluZyB0byB3aGF0IFkgLSB2YWx1ZSB3b3VsZCBkbwogICAgICBsZXQgdmFsdWUgPSB0aGlzLm1lbS5yZWFkKGFkcikgXiAweGZmOwogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yW1ldICsgdmFsdWUgKyAxOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCAmIDB4ZmYpOwogICAgfQoKICAgIHRoaXMuZGVjID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGRlY3JlbWVudHMgYSBtZW1vcnkgbG9jYXRpb24sIHNldCBaIGFuZCBOCiAgICAgIGxldCByZXN1bHQgPSAodGhpcy5tZW0ucmVhZChhZHIpIC0gMSkgJiAweGZmOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCk7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgIH0KCiAgICB0aGlzLmRleCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBkZWNyZW1lbnRzIFgsIHNldCBaIGFuZCBOCiAgICAgIHRoaXMucltYXS0tOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy5kZXkgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gZGVjcmVtZW50cyBZLCBzZXQgWiBhbmQgTgogICAgICB0aGlzLnJbWV0tLTsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbWV0pOwogICAgfQoKICAgIHRoaXMuaW5jID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGluY3JlbWVudHMgYSBtZW1vcnkgbG9jYXRpb24sIHNldCBaIGFuZCBOCiAgICAgIGxldCByZXN1bHQgPSAodGhpcy5tZW0ucmVhZChhZHIpICsgMSkgJiAweGZmOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCk7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgIH0KCiAgICB0aGlzLmlueCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBpbmNyZW1lbnRzIFgsIHNldCBaIGFuZCBOCiAgICAgIHRoaXMucltYXSsrOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy5pbnkgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gaW5jcmVtZW50cyBZLCBzZXQgWiBhbmQgTgogICAgICB0aGlzLnJbWV0rKzsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbWV0pOwogICAgfQoKICAgIHRoaXMuYXNsYSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzaGlmdHMgQSBsZWZ0IDEsIHNldCBDLCBaIGFuZCBOCiAgICAgIGxldCByZXN1bHQgPSB0aGlzLnJbQV0gPDwgMTsKICAgICAgdGhpcy5jID0gcmVzdWx0ID4gMHhmZjsKICAgICAgdGhpcy5zZXRaYW5kTihyZXN1bHQpOwogICAgICB0aGlzLnJbQV0gPSByZXN1bHQ7CiAgICB9CgogICAgdGhpcy5hc2wgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc2hpZnRzIGEgbWVtb3J5IGxvY2F0aW9uIGxlZnQgMSwgc2V0IEMsIFogYW5kIE4KICAgICAgbGV0IHJlc3VsdCA9IHRoaXMubWVtLnJlYWQoYWRyKSA8PCAxOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCk7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgIH0KCiAgICB0aGlzLnJvbGEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gcm9sbHMgQSBsZWZ0IDEsIHJvbGxzIEMgaW4sIHNldCBDLCBaIGFuZCBOCiAgICAgIGxldCByZXN1bHQgPSAodGhpcy5yW0FdIDw8IDEpIHwgKHRoaXMuYyA/IDEgOiAwKTsKICAgICAgdGhpcy5jID0gcmVzdWx0ID4gMHhmZjsKICAgICAgdGhpcy5zZXRaYW5kTihyZXN1bHQpOwogICAgICB0aGlzLnJbQV0gPSByZXN1bHQ7CiAgICB9CgogICAgdGhpcy5yb2wgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gcm9sbHMgYSBtZW1vcnkgbG9jYXRpb24gbGVmdCAxLCByb2xscyBDIGluLCBzZXQgQywgWiBhbmQgTgogICAgICBsZXQgcmVzdWx0ID0gKHRoaXMubWVtLnJlYWQoYWRyKSA8PCAxKSB8ICh0aGlzLmMgPyAxIDogMCk7CiAgICAgIHRoaXMuYyA9IHJlc3VsdCA+IDB4ZmY7CiAgICAgIHRoaXMuc2V0WmFuZE4ocmVzdWx0KTsKICAgICAgdGhpcy5tZW0ud3JpdGUoYWRyLCByZXN1bHQpOwogICAgfQoKICAgIHRoaXMubHNyYSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzaGlmdHMgQSByaWdodCAxLCBzZXQgQywgWiBhbmQgTgogICAgICBsZXQgY2FycnkgPSB0aGlzLnJbQV0gJiAweDE7CiAgICAgIGxldCByZXN1bHQgPSB0aGlzLnJbQV0gPj4gMTsKICAgICAgdGhpcy5jID0gY2FycnkgPiAwOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCk7CiAgICAgIHRoaXMucltBXSA9IHJlc3VsdDsKICAgIH0KCiAgICB0aGlzLmxzciA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzaGlmdHMgYSBtZW1vcnkgbG9jYXRpb24gcmlnaHQgMSwgc2V0IEMsIFogYW5kIE4KICAgICAgbGV0IHZhbHVlID0gdGhpcy5tZW0ucmVhZChhZHIpOwogICAgICBsZXQgY2FycnkgPSB2YWx1ZSAmIDB4MTsKICAgICAgbGV0IHJlc3VsdCA9IHZhbHVlID4+IDE7CiAgICAgIHRoaXMuYyA9IGNhcnJ5ID4gMDsKICAgICAgdGhpcy5zZXRaYW5kTihyZXN1bHQpOwogICAgICB0aGlzLm1lbS53cml0ZShhZHIsIHJlc3VsdCk7CiAgICB9CgogICAgdGhpcy5yb3JhID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHJvbGxzIEEgcmlnaHQgMSwgcm9sbHMgQyBpbiwgc2V0IEMsIFogYW5kIE4KICAgICAgbGV0IGNhcnJ5ID0gdGhpcy5yW0FdICYgMHgxOwogICAgICBsZXQgcmVzdWx0ID0gKHRoaXMucltBXSA+PiAxKSB8ICgodGhpcy5jID8gMSA6IDApIDw8IDcpOwogICAgICB0aGlzLmMgPSBjYXJyeSA+IDA7CiAgICAgIHRoaXMuc2V0WmFuZE4ocmVzdWx0KTsKICAgICAgdGhpcy5yW0FdID0gcmVzdWx0OwogICAgfQoKICAgIHRoaXMucm9yID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHJvbGxzIGEgbWVtb3J5IGxvY2F0aW9uIHJpZ2h0IDEsIHJvbGxzIEMgaW4sIHNldCBDLCBaIGFuZCBOCiAgICAgIGxldCB2YWx1ZSA9IHRoaXMubWVtLnJlYWQoYWRyKTsKICAgICAgbGV0IGNhcnJ5ID0gdmFsdWUgJiAweDE7CiAgICAgIGxldCByZXN1bHQgPSAodmFsdWUgPj4gMSkgfCAoKHRoaXMuYyA/IDEgOiAwKSA8PCA3KTsKICAgICAgdGhpcy5jID0gY2FycnkgPiAwOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCk7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgIH0KCiAgICB0aGlzLmxkYSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBsb2FkcyBhIHZhbHVlIGluIGEsIHNldHMgWiBhbmQgTgogICAgICB0aGlzLnJbQV0gPSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLnN0YSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzdG9yZXMgYSB0byBhIG1lbW9yeSBsb2NhdGlvbgogICAgICB0aGlzLm1lbS53cml0ZShhZHIsIHRoaXMucltBXSk7CiAgICB9CgogICAgdGhpcy5sZHggPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gbG9hZHMgeCB2YWx1ZSBpbiBhLCBzZXRzIFogYW5kIE4KICAgICAgdGhpcy5yW1hdID0gdGhpcy5tZW0ucmVhZChhZHIpOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy5zdHggPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc3RvcmVzIHggdG8gYSBtZW1vcnkgbG9jYXRpb24KICAgICAgdGhpcy5tZW0ud3JpdGUoYWRyLCB0aGlzLnJbWF0pOwogICAgfQoKICAgIHRoaXMubGR5ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGxvYWRzIGEgdmFsdWUgaW4geSwgc2V0cyBaIGFuZCBOCiAgICAgIHRoaXMucltZXSA9IHRoaXMubWVtLnJlYWQoYWRyKTsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbWV0pOwogICAgfQoKICAgIHRoaXMuc3R5ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHN0b3JlcyB5IHRvIGEgbWVtb3J5IGxvY2F0aW9uCiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgdGhpcy5yW1ldKTsKICAgIH0KCiAgICB0aGlzLnRheCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyB0cmFuc2ZlcnMgYSB0byB4LCBzZXRzIFogYW5kIE4KICAgICAgdGhpcy5yW1hdID0gdGhpcy5yW0FdOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy50eGEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gdHJhbnNmZXJzIHggdG8gYSwgc2V0cyBaIGFuZCBOCiAgICAgIHRoaXMucltBXSA9IHRoaXMucltYXTsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbQV0pOwogICAgfQoKICAgIHRoaXMudGF5ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHRyYW5zZmVycyBhIHRvIHksIHNldHMgWiBhbmQgTgogICAgICB0aGlzLnJbWV0gPSB0aGlzLnJbQV07CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW1ldKTsKICAgIH0KCiAgICB0aGlzLnR5YSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyB0cmFuc2ZlcnMgeSB0byBhLCBzZXRzIFogYW5kIE4KICAgICAgdGhpcy5yW0FdID0gdGhpcy5yW1ldOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltBXSk7CiAgICB9CgogICAgdGhpcy50c3ggPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gdHJhbnNmZXJzIHRoZSBzdGFjayBwb2ludGVyIHRvIHgsIHNldHMgWiBhbmQgTgogICAgICB0aGlzLnJbWF0gPSB0aGlzLnJbU1BdOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy50eHMgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gdHJhbnNmZXJzIHggdG8gdGhlIHN0YWNrIHBvaW50ZXIKICAgICAgdGhpcy5yW1NQXSA9IHRoaXMucltYXTsKICAgIH0KCiAgICB0aGlzLnBsYSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBwdWxscyBhIGZyb20gdGhlIHN0YWNrLCBzZXRzIFogYW5kIE4KICAgICAgdGhpcy5yW0FdID0gdGhpcy5tZW0ucmVhZCgweDEwMCArICgoKyt0aGlzLnJbU1BdKSAmIDB4ZmYpKTsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbQV0pOwogICAgfQoKICAgIHRoaXMucGhhID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHB1c2hlcyBhIHRvIHRoZSBzdGFjawogICAgICB0aGlzLm1lbS53cml0ZSgweDEwMCArIHRoaXMucltTUF0tLSwgdGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLnBscCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBwdWxscyB0aGUgZmxhZ3MgZnJvbSB0aGUgc3RhY2sKICAgICAgdGhpcy5zZXRQKHRoaXMubWVtLnJlYWQoMHgxMDAgKyAoKCsrdGhpcy5yW1NQXSkgJiAweGZmKSkpOwogICAgfQoKICAgIHRoaXMucGhwID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHB1c2hlcyB0aGUgZmxhZ3MgdG8gdGhlIHN0YWNrCiAgICAgIHRoaXMubWVtLndyaXRlKDB4MTAwICsgdGhpcy5yW1NQXS0tLCB0aGlzLmdldFAodHJ1ZSkpOwogICAgfQoKICAgIHRoaXMuYnBsID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJyYW5jaGVzIGlmIE4gaXMgMAogICAgICB0aGlzLmRvQnJhbmNoKCF0aGlzLm4sIGFkcik7CiAgICB9CgogICAgdGhpcy5ibWkgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gYnJhbmNoZXMgaWYgTiBpcyAxCiAgICAgIHRoaXMuZG9CcmFuY2godGhpcy5uLCBhZHIpOwogICAgfQoKICAgIHRoaXMuYnZjID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJyYW5jaGVzIGlmIFYgaXMgMAogICAgICB0aGlzLmRvQnJhbmNoKCF0aGlzLnYsIGFkcik7CiAgICB9CgogICAgdGhpcy5idnMgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gYnJhbmNoZXMgaWYgViBpcyAxCiAgICAgIHRoaXMuZG9CcmFuY2godGhpcy52LCBhZHIpOwogICAgfQoKICAgIHRoaXMuYmNjID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJyYW5jaGVzIGlmIEMgaXMgMAogICAgICB0aGlzLmRvQnJhbmNoKCF0aGlzLmMsIGFkcik7CiAgICB9CgogICAgdGhpcy5iY3MgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gYnJhbmNoZXMgaWYgQyBpcyAxCiAgICAgIHRoaXMuZG9CcmFuY2godGhpcy5jLCBhZHIpOwogICAgfQoKICAgIHRoaXMuYm5lID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJyYW5jaGVzIGlmIFogaXMgMAogICAgICB0aGlzLmRvQnJhbmNoKCF0aGlzLnosIGFkcik7CiAgICB9CgogICAgdGhpcy5iZXEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gYnJhbmNoZXMgaWYgWiBpcyAxCiAgICAgIHRoaXMuZG9CcmFuY2godGhpcy56LCBhZHIpOwogICAgfQoKICAgIHRoaXMuYnJrID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJyZWFrIHRvIGlycSBoYW5kbGVyCiAgICAgIGxldCBwdXNoUGMgPSAodGhpcy5icltQQ10gKyAxKSAmIDB4ZmZmZjsKICAgICAgdGhpcy5tZW0ud3JpdGUoMHgxMDAgKyB0aGlzLnJbU1BdLS0sIHB1c2hQYyA+PiA4KTsKICAgICAgdGhpcy5tZW0ud3JpdGUoMHgxMDAgKyB0aGlzLnJbU1BdLS0sIHB1c2hQYyAmIDB4ZmYpOwogICAgICB0aGlzLm1lbS53cml0ZSgweDEwMCArIHRoaXMucltTUF0tLSwgdGhpcy5nZXRQKHRydWUpKTsKICAgICAgdGhpcy5pID0gdHJ1ZTsKICAgICAgdGhpcy5icltQQ10gPSB0aGlzLm1lbS5yZWFkKDB4ZmZmZSkgfCAodGhpcy5tZW0ucmVhZCgweGZmZmYpIDw8IDgpOwogICAgfQoKICAgIHRoaXMucnRpID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHJldHVybiBmcm9tIGludGVycnVwdAogICAgICB0aGlzLnNldFAodGhpcy5tZW0ucmVhZCgweDEwMCArICgoKyt0aGlzLnJbU1BdKSAmIDB4ZmYpKSk7CiAgICAgIGxldCBwdWxsUGMgPSB0aGlzLm1lbS5yZWFkKDB4MTAwICsgKCgrK3RoaXMucltTUF0pICYgMHhmZikpOwogICAgICBwdWxsUGMgfD0gKHRoaXMubWVtLnJlYWQoMHgxMDAgKyAoKCsrdGhpcy5yW1NQXSkgJiAweGZmKSkgPDwgOCk7CiAgICAgIHRoaXMuYnJbUENdID0gcHVsbFBjOwogICAgfQoKICAgIHRoaXMuanNyID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGp1bXAgdG8gc3Vicm91dGluZQogICAgICBsZXQgcHVzaFBjID0gKHRoaXMuYnJbUENdIC0gMSkgJiAweGZmZmY7CiAgICAgIHRoaXMubWVtLndyaXRlKDB4MTAwICsgdGhpcy5yW1NQXS0tLCBwdXNoUGMgPj4gOCk7CiAgICAgIHRoaXMubWVtLndyaXRlKDB4MTAwICsgdGhpcy5yW1NQXS0tLCBwdXNoUGMgJiAweGZmKTsKICAgICAgdGhpcy5icltQQ10gPSBhZHI7CiAgICB9CgogICAgdGhpcy5ydHMgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gcmV0dXJuIGZyb20gc3Vicm91dGluZQogICAgICBsZXQgcHVsbFBjID0gdGhpcy5tZW0ucmVhZCgweDEwMCArICgoKyt0aGlzLnJbU1BdKSAmIDB4ZmYpKTsKICAgICAgcHVsbFBjIHw9ICh0aGlzLm1lbS5yZWFkKDB4MTAwICsgKCgrK3RoaXMucltTUF0pICYgMHhmZikpIDw8IDgpOwogICAgICB0aGlzLmJyW1BDXSA9IHB1bGxQYyArIDE7CiAgICB9CgogICAgdGhpcy5qbXAgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8ganVtcCB0byBhZGRyZXNzCiAgICAgIHRoaXMuYnJbUENdID0gYWRyOwogICAgfQoKICAgIHRoaXMuYml0ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGJpdCB0ZXN0IEEgd2l0aCB2YWx1ZSwgc2V0IE4gdG8gYjcsIFYgdG8gYjYgYW5kIFogdG8gcmVzdWx0CiAgICAgIGxldCB2YWx1ZSA9IHRoaXMubWVtLnJlYWQoYWRyKTsKICAgICAgdGhpcy5uID0gKHZhbHVlICYgMHg4MCkgPiAwOwogICAgICB0aGlzLnYgPSAodmFsdWUgJiAweDQwKSA+IDA7CiAgICAgIGxldCByZXMgPSB0aGlzLnJbQV0gJiB2YWx1ZTsKICAgICAgdGhpcy56ID0gcmVzID09PSAwOwogICAgfQoKICAgIHRoaXMuY2xjID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGNsZWFyIGNhcnJ5IGZsYWcKICAgICAgdGhpcy5jID0gZmFsc2U7CiAgICB9CgogICAgdGhpcy5zZWMgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc2V0IGNhcnJ5IGZsYWcKICAgICAgdGhpcy5jID0gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLmNsZCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBjbGVhciBkZWNpbWFsIGZsYWcKICAgICAgdGhpcy5kID0gZmFsc2U7CiAgICB9CgogICAgdGhpcy5zZWQgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc2V0IGRlY2ltYWwgZmxhZwogICAgICB0aGlzLmQgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuY2xpID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGNsZWFyIGludGVycnVwdCBmbGFnCiAgICAgIHRoaXMuaSA9IGZhbHNlOwogICAgfQoKICAgIHRoaXMuc2VpID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHNldCBpbnRlcnJ1cHQgZmxhZwogICAgICB0aGlzLmkgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuY2x2ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGNsZWFyIG92ZXJmbG93IGZsYWcKICAgICAgdGhpcy52ID0gZmFsc2U7CiAgICB9CgogICAgdGhpcy5ub3AgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gbm8gb3BlcmF0aW9uCiAgICB9CgogICAgdGhpcy5pcnEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gaGFuZGxlIGlycSBpbnRlcnJ1cHQKICAgICAgbGV0IHB1c2hQYyA9IHRoaXMuYnJbUENdOwogICAgICB0aGlzLm1lbS53cml0ZSgweDEwMCArIHRoaXMucltTUF0tLSwgcHVzaFBjID4+IDgpOwogICAgICB0aGlzLm1lbS53cml0ZSgweDEwMCArIHRoaXMucltTUF0tLSwgcHVzaFBjICYgMHhmZik7CiAgICAgIHRoaXMubWVtLndyaXRlKDB4MTAwICsgdGhpcy5yW1NQXS0tLCB0aGlzLmdldFAoZmFsc2UpKTsKICAgICAgdGhpcy5pID0gdHJ1ZTsKICAgICAgdGhpcy5icltQQ10gPSB0aGlzLm1lbS5yZWFkKDB4ZmZmZSkgfCAodGhpcy5tZW0ucmVhZCgweGZmZmYpIDw8IDgpOwogICAgfQoKICAgIHRoaXMubm1pID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGhhbmRsZSBubWkgaW50ZXJydXB0CiAgICAgIGxldCBwdXNoUGMgPSB0aGlzLmJyW1BDXTsKICAgICAgdGhpcy5tZW0ud3JpdGUoMHgxMDAgKyB0aGlzLnJbU1BdLS0sIHB1c2hQYyA+PiA4KTsKICAgICAgdGhpcy5tZW0ud3JpdGUoMHgxMDAgKyB0aGlzLnJbU1BdLS0sIHB1c2hQYyAmIDB4ZmYpOwogICAgICB0aGlzLm1lbS53cml0ZSgweDEwMCArIHRoaXMucltTUF0tLSwgdGhpcy5nZXRQKGZhbHNlKSk7CiAgICAgIHRoaXMuaSA9IHRydWU7CiAgICAgIHRoaXMuYnJbUENdID0gdGhpcy5tZW0ucmVhZCgweGZmZmEpIHwgKHRoaXMubWVtLnJlYWQoMHhmZmZiKSA8PCA4KTsKICAgIH0KCiAgICAvLyB1bmRvY3VtZW50ZWQgb3Bjb2RlcwoKICAgIHRoaXMua2lsID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHN0b3B0cyB0aGUgY3B1CiAgICAgIHRoaXMuYnJbUENdLS07CiAgICB9CgogICAgdGhpcy5zbG8gPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gc2hpZnRzIGEgbWVtb3J5IGxvY2F0aW9uIGxlZnQgMSwgT1JzIGEgd2l0aCB0aGUgcmVzdWx0LCBzZXRzIE4sIFogYW5kIEMKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMubWVtLnJlYWQoYWRyKSA8PCAxOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLm1lbS53cml0ZShhZHIsIHJlc3VsdCk7CiAgICAgIHRoaXMucltBXSB8PSByZXN1bHQ7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLnJsYSA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyByb2xscyBhIG1lbW9yeSBsb2NhdGlvbiBsZWZ0IDEsIEFORHMgYSB3aXRoIHRoZSByZXN1bHQsIHNldHMgTiwgWiBhbmQgQwogICAgICBsZXQgcmVzdWx0ID0gKHRoaXMubWVtLnJlYWQoYWRyKSA8PCAxKSB8ICh0aGlzLmMgPyAxIDogMCk7CiAgICAgIHRoaXMuYyA9IHJlc3VsdCA+IDB4ZmY7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgICAgdGhpcy5yW0FdICY9IHJlc3VsdDsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbQV0pOwogICAgfQoKICAgIHRoaXMuc3JlID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHNoaWZ0cyBhIG1lbW9yeSBsb2NhdGlvbiByaWdodCAxLCBYT1JzIEEgd2l0aCB0aGUgcmVzdWx0LCBzZXRzIE4sIFogYW5kIEMKICAgICAgbGV0IHZhbHVlID0gdGhpcy5tZW0ucmVhZChhZHIpOwogICAgICBsZXQgY2FycnkgPSB2YWx1ZSAmIDB4MTsKICAgICAgbGV0IHJlc3VsdCA9IHZhbHVlID4+IDE7CiAgICAgIHRoaXMuYyA9IGNhcnJ5ID4gMDsKICAgICAgdGhpcy5tZW0ud3JpdGUoYWRyLCByZXN1bHQpOwogICAgICB0aGlzLnJbQV0gXj0gcmVzdWx0OwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltBXSk7CiAgICB9CgogICAgdGhpcy5ycmEgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gcm9sbHMgYSBtZW1vcnkgbG9jYXRpb24gcmlnaHQgMSwgYWRkcyB0aGUgcmVzdWx0IHRvIEEsIHNldHMgTiwgWiwgQyBhbmQgVgogICAgICBsZXQgdmFsdWUgPSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIGxldCBjYXJyeSA9IHZhbHVlICYgMHgxOwogICAgICBsZXQgcmVzdWx0ID0gKHZhbHVlID4+IDEpIHwgKCh0aGlzLmMgPyAxIDogMCkgPDwgNyk7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgcmVzdWx0KTsKICAgICAgbGV0IGFkZFJlc3VsdCA9IHRoaXMucltBXSArIHJlc3VsdCArIGNhcnJ5OwogICAgICB0aGlzLmMgPSBhZGRSZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnYgPSAoCiAgICAgICAgKHRoaXMucltBXSAmIDB4ODApID09PSAocmVzdWx0ICYgMHg4MCkgJiYKICAgICAgICAocmVzdWx0ICYgMHg4MCkgIT09IChhZGRSZXN1bHQgJiAweDgwKQogICAgICApOwogICAgICB0aGlzLnJbQV0gPSBhZGRSZXN1bHQ7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgIH0KCiAgICB0aGlzLnNheCA9IGZ1bmN0aW9uKGFkcikgewogICAgICAvLyBzdG9yZXMgQSBBTkRlZCB3aXRoIFggdG8gYSBtZW1vcnkgbG9jYXRpb24KICAgICAgdGhpcy5tZW0ud3JpdGUoYWRyLCB0aGlzLnJbQV0gJiB0aGlzLnJbWF0pOwogICAgfQoKICAgIHRoaXMubGF4ID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGxvYWRzIEEgYW5kIFggd2l0aCBhIHZhbHVlCiAgICAgIHRoaXMucltBXSA9IHRoaXMubWVtLnJlYWQoYWRyKTsKICAgICAgdGhpcy5yW1hdID0gdGhpcy5yW0FdOwogICAgICB0aGlzLnNldFphbmROKHRoaXMucltYXSk7CiAgICB9CgogICAgdGhpcy5kY3AgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gZGVjcmVtZW50IGEgbWVtb3J5IGxvY2F0aW9uLCBhbmQgc2V0cyBDLCBaIGFuZCBOIHRvIHdoYXQgQSAtIHJlc3VsdCBkb2VzCiAgICAgIGxldCB2YWx1ZSA9ICh0aGlzLm1lbS5yZWFkKGFkcikgLSAxKSAmIDB4ZmY7CiAgICAgIHRoaXMubWVtLndyaXRlKGFkciwgdmFsdWUpOwogICAgICB2YWx1ZSBePSAweGZmOwogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yW0FdICsgdmFsdWUgKyAxOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnNldFphbmROKHJlc3VsdCAmIDB4ZmYpOwogICAgfQoKICAgIHRoaXMuaXNjID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIGluY3JlbWVudHMgYSBtZW1vcnkgbG9jYXRpb24sIGFuZCBzdWJ0cmFjdCBpdCshQyBmcm9tIEEsIHNldHMgWiwgTiwgViwgQwogICAgICBsZXQgdmFsdWUgPSAodGhpcy5tZW0ucmVhZChhZHIpICsgMSkgJiAweGZmOwogICAgICB0aGlzLm1lbS53cml0ZShhZHIsIHZhbHVlKTsKICAgICAgdmFsdWUgXj0gMHhmZjsKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMucltBXSArIHZhbHVlICsgKHRoaXMuYyA/IDEgOiAwKTsKICAgICAgdGhpcy5jID0gcmVzdWx0ID4gMHhmZjsKICAgICAgdGhpcy52ID0gKAogICAgICAgICh0aGlzLnJbQV0gJiAweDgwKSA9PT0gKHZhbHVlICYgMHg4MCkgJiYKICAgICAgICAodmFsdWUgJiAweDgwKSAhPT0gKHJlc3VsdCAmIDB4ODApCiAgICAgICk7CiAgICAgIHRoaXMucltBXSA9IHJlc3VsdDsKICAgICAgdGhpcy5zZXRaYW5kTih0aGlzLnJbQV0pOwogICAgfQoKICAgIHRoaXMuYW5jID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIEFORHMgYSB3aXRoIHRoZSB2YWx1ZSwgc2V0cyBaIGFuZCBOLCB0aGVuIHNldHMgQyB0byBOCiAgICAgIHRoaXMucltBXSAmPSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW0FdKTsKICAgICAgdGhpcy5jID0gdGhpcy5uOwogICAgfQoKICAgIHRoaXMuYWxyID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIEFORHMgYSB3aXRoIHRoZSB2YWx1ZSwgdGhlbiBzaGlmdHMgQSByaWdodCAxLCBzZXRzIEMsIFogYW5kIE4KICAgICAgdGhpcy5yW0FdICY9IHRoaXMubWVtLnJlYWQoYWRyKTsKICAgICAgbGV0IGNhcnJ5ID0gdGhpcy5yW0FdICYgMHgxOwogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yW0FdID4+IDE7CiAgICAgIHRoaXMuYyA9IGNhcnJ5ID4gMDsKICAgICAgdGhpcy5zZXRaYW5kTihyZXN1bHQpOwogICAgICB0aGlzLnJbQV0gPSByZXN1bHQ7CiAgICB9CgogICAgdGhpcy5hcnIgPSBmdW5jdGlvbihhZHIpIHsKICAgICAgLy8gQU5EcyBhIHdpdGggdGhlIHZhbHVlLCB0aGVuIHJvbGxzIEEgcmlnaHQgMSwgc2V0cyBaLCBOLCBDIGFuZCBWIG9kZGx5CiAgICAgIHRoaXMucltBXSAmPSB0aGlzLm1lbS5yZWFkKGFkcik7CiAgICAgIGxldCByZXN1bHQgPSAodGhpcy5yW0FdID4+IDEpIHwgKCh0aGlzLmMgPyAxIDogMCkgPDwgNyk7CiAgICAgIHRoaXMuc2V0WmFuZE4ocmVzdWx0KTsKICAgICAgdGhpcy5jID0gKHJlc3VsdCAmIDB4NDApID4gMDsKICAgICAgdGhpcy52ID0gKChyZXN1bHQgJiAweDQwKSBeICgocmVzdWx0ICYgMHgyMCkgPDwgMSkpID4gMDsKICAgICAgdGhpcy5yW0FdID0gcmVzdWx0OwogICAgfQoKICAgIHRoaXMuYXhzID0gZnVuY3Rpb24oYWRyKSB7CiAgICAgIC8vIHNldHMgWCB0byBBIEFORGVkIHdpdGggWCBtaW51cyB0aGUgdmFsdWUsIHNldHMgTiwgWiBhbmQgQwogICAgICBsZXQgdmFsdWUgPSB0aGlzLm1lbS5yZWFkKGFkcikgXiAweGZmOwogICAgICBsZXQgYW5kZWRBID0gdGhpcy5yW0FdICYgdGhpcy5yW1hdOwogICAgICBsZXQgcmVzdWx0ID0gYW5kZWRBICsgdmFsdWUgKyAxOwogICAgICB0aGlzLmMgPSByZXN1bHQgPiAweGZmOwogICAgICB0aGlzLnJbWF0gPSByZXN1bHQ7CiAgICAgIHRoaXMuc2V0WmFuZE4odGhpcy5yW1hdKTsKICAgIH0KCiAgICAvLyBmdW5jdGlvbiB0YWJsZQogICAgdGhpcy5mdW5jdGlvbnMgPSBbCiAgICAgIC8veDAgICAgICB4MSAgICAgICAgeDIgICAgICAgIHgzICAgICAgICB4NCAgICAgICAgeDUgICAgICAgIHg2ICAgICAgICB4NyAgICAgICAgeDggICAgICAgIHg5ICAgICAgICB4YSAgICAgICAgeGIgICAgICAgIHhjICAgICAgICB4ZCAgICAgICAgeGUgICAgICAgIHhmCiAgICAgIHRoaXMuYnJrLCB0aGlzLm9yYSwgdGhpcy5raWwsIHRoaXMuc2xvLCB0aGlzLm5vcCwgdGhpcy5vcmEsIHRoaXMuYXNsLCB0aGlzLnNsbywgdGhpcy5waHAsIHRoaXMub3JhLCB0aGlzLmFzbGEsdGhpcy5hbmMsIHRoaXMubm9wLCB0aGlzLm9yYSwgdGhpcy5hc2wsIHRoaXMuc2xvLCAvLzB4CiAgICAgIHRoaXMuYnBsLCB0aGlzLm9yYSwgdGhpcy5raWwsIHRoaXMuc2xvLCB0aGlzLm5vcCwgdGhpcy5vcmEsIHRoaXMuYXNsLCB0aGlzLnNsbywgdGhpcy5jbGMsIHRoaXMub3JhLCB0aGlzLm5vcCwgdGhpcy5zbG8sIHRoaXMubm9wLCB0aGlzLm9yYSwgdGhpcy5hc2wsIHRoaXMuc2xvLCAvLzF4CiAgICAgIHRoaXMuanNyLCB0aGlzLmFuZCwgdGhpcy5raWwsIHRoaXMucmxhLCB0aGlzLmJpdCwgdGhpcy5hbmQsIHRoaXMucm9sLCB0aGlzLnJsYSwgdGhpcy5wbHAsIHRoaXMuYW5kLCB0aGlzLnJvbGEsdGhpcy5hbmMsIHRoaXMuYml0LCB0aGlzLmFuZCwgdGhpcy5yb2wsIHRoaXMucmxhLCAvLzJ4CiAgICAgIHRoaXMuYm1pLCB0aGlzLmFuZCwgdGhpcy5raWwsIHRoaXMucmxhLCB0aGlzLm5vcCwgdGhpcy5hbmQsIHRoaXMucm9sLCB0aGlzLnJsYSwgdGhpcy5zZWMsIHRoaXMuYW5kLCB0aGlzLm5vcCwgdGhpcy5ybGEsIHRoaXMubm9wLCB0aGlzLmFuZCwgdGhpcy5yb2wsIHRoaXMucmxhLCAvLzN4CiAgICAgIHRoaXMucnRpLCB0aGlzLmVvciwgdGhpcy5raWwsIHRoaXMuc3JlLCB0aGlzLm5vcCwgdGhpcy5lb3IsIHRoaXMubHNyLCB0aGlzLnNyZSwgdGhpcy5waGEsIHRoaXMuZW9yLCB0aGlzLmxzcmEsdGhpcy5hbHIsIHRoaXMuam1wLCB0aGlzLmVvciwgdGhpcy5sc3IsIHRoaXMuc3JlLCAvLzR4CiAgICAgIHRoaXMuYnZjLCB0aGlzLmVvciwgdGhpcy5raWwsIHRoaXMuc3JlLCB0aGlzLm5vcCwgdGhpcy5lb3IsIHRoaXMubHNyLCB0aGlzLnNyZSwgdGhpcy5jbGksIHRoaXMuZW9yLCB0aGlzLm5vcCwgdGhpcy5zcmUsIHRoaXMubm9wLCB0aGlzLmVvciwgdGhpcy5sc3IsIHRoaXMuc3JlLCAvLzV4CiAgICAgIHRoaXMucnRzLCB0aGlzLmFkYywgdGhpcy5raWwsIHRoaXMucnJhLCB0aGlzLm5vcCwgdGhpcy5hZGMsIHRoaXMucm9yLCB0aGlzLnJyYSwgdGhpcy5wbGEsIHRoaXMuYWRjLCB0aGlzLnJvcmEsdGhpcy5hcnIsIHRoaXMuam1wLCB0aGlzLmFkYywgdGhpcy5yb3IsIHRoaXMucnJhLCAvLzZ4CiAgICAgIHRoaXMuYnZzLCB0aGlzLmFkYywgdGhpcy5raWwsIHRoaXMucnJhLCB0aGlzLm5vcCwgdGhpcy5hZGMsIHRoaXMucm9yLCB0aGlzLnJyYSwgdGhpcy5zZWksIHRoaXMuYWRjLCB0aGlzLm5vcCwgdGhpcy5ycmEsIHRoaXMubm9wLCB0aGlzLmFkYywgdGhpcy5yb3IsIHRoaXMucnJhLCAvLzd4CiAgICAgIHRoaXMubm9wLCB0aGlzLnN0YSwgdGhpcy5ub3AsIHRoaXMuc2F4LCB0aGlzLnN0eSwgdGhpcy5zdGEsIHRoaXMuc3R4LCB0aGlzLnNheCwgdGhpcy5kZXksIHRoaXMubm9wLCB0aGlzLnR4YSwgdGhpcy51bmksIHRoaXMuc3R5LCB0aGlzLnN0YSwgdGhpcy5zdHgsIHRoaXMuc2F4LCAvLzh4CiAgICAgIHRoaXMuYmNjLCB0aGlzLnN0YSwgdGhpcy5raWwsIHRoaXMudW5pLCB0aGlzLnN0eSwgdGhpcy5zdGEsIHRoaXMuc3R4LCB0aGlzLnNheCwgdGhpcy50eWEsIHRoaXMuc3RhLCB0aGlzLnR4cywgdGhpcy51bmksIHRoaXMudW5pLCB0aGlzLnN0YSwgdGhpcy51bmksIHRoaXMudW5pLCAvLzl4CiAgICAgIHRoaXMubGR5LCB0aGlzLmxkYSwgdGhpcy5sZHgsIHRoaXMubGF4LCB0aGlzLmxkeSwgdGhpcy5sZGEsIHRoaXMubGR4LCB0aGlzLmxheCwgdGhpcy50YXksIHRoaXMubGRhLCB0aGlzLnRheCwgdGhpcy51bmksIHRoaXMubGR5LCB0aGlzLmxkYSwgdGhpcy5sZHgsIHRoaXMubGF4LCAvL2F4CiAgICAgIHRoaXMuYmNzLCB0aGlzLmxkYSwgdGhpcy5raWwsIHRoaXMubGF4LCB0aGlzLmxkeSwgdGhpcy5sZGEsIHRoaXMubGR4LCB0aGlzLmxheCwgdGhpcy5jbHYsIHRoaXMubGRhLCB0aGlzLnRzeCwgdGhpcy51bmksIHRoaXMubGR5LCB0aGlzLmxkYSwgdGhpcy5sZHgsIHRoaXMubGF4LCAvL2J4CiAgICAgIHRoaXMuY3B5LCB0aGlzLmNtcCwgdGhpcy5ub3AsIHRoaXMuZGNwLCB0aGlzLmNweSwgdGhpcy5jbXAsIHRoaXMuZGVjLCB0aGlzLmRjcCwgdGhpcy5pbnksIHRoaXMuY21wLCB0aGlzLmRleCwgdGhpcy5heHMsIHRoaXMuY3B5LCB0aGlzLmNtcCwgdGhpcy5kZWMsIHRoaXMuZGNwLCAvL2N4CiAgICAgIHRoaXMuYm5lLCB0aGlzLmNtcCwgdGhpcy5raWwsIHRoaXMuZGNwLCB0aGlzLm5vcCwgdGhpcy5jbXAsIHRoaXMuZGVjLCB0aGlzLmRjcCwgdGhpcy5jbGQsIHRoaXMuY21wLCB0aGlzLm5vcCwgdGhpcy5kY3AsIHRoaXMubm9wLCB0aGlzLmNtcCwgdGhpcy5kZWMsIHRoaXMuZGNwLCAvL2R4CiAgICAgIHRoaXMuY3B4LCB0aGlzLnNiYywgdGhpcy5ub3AsIHRoaXMuaXNjLCB0aGlzLmNweCwgdGhpcy5zYmMsIHRoaXMuaW5jLCB0aGlzLmlzYywgdGhpcy5pbngsIHRoaXMuc2JjLCB0aGlzLm5vcCwgdGhpcy5zYmMsIHRoaXMuY3B4LCB0aGlzLnNiYywgdGhpcy5pbmMsIHRoaXMuaXNjLCAvL2V4CiAgICAgIHRoaXMuYmVxLCB0aGlzLnNiYywgdGhpcy5raWwsIHRoaXMuaXNjLCB0aGlzLm5vcCwgdGhpcy5zYmMsIHRoaXMuaW5jLCB0aGlzLmlzYywgdGhpcy5zZWQsIHRoaXMuc2JjLCB0aGlzLm5vcCwgdGhpcy5pc2MsIHRoaXMubm9wLCB0aGlzLnNiYywgdGhpcy5pbmMsIHRoaXMuaXNjLCAvL2Z4CiAgICAgIHRoaXMubm1pLCB0aGlzLmlycSAvLyAweDEwMDogTk1JLCAweDEwMTogSVJRCiAgICBdOwoKICB9Cn0pKCkK"></script>
  <script src="data:application/javascript;base64,CmZ1bmN0aW9uIFBwdShuZXMpIHsKCiAgLy8gbWVtb3J5IGhhbmRsZXIKICB0aGlzLm5lcyA9IG5lczsKCiAgLy8gbmFtZXRhYmxlIG1lbW9yeSBzdG9yZWQgaW4gbWFwcGVyIHRvIHNpbXBsaWZ5IGNvZGUKCiAgLy8gcGFsZXR0ZSBtZW1vcnkKICB0aGlzLnBhbGV0dGVSYW0gPSBuZXcgVWludDhBcnJheSgweDIwKTsKCiAgLy8gb2FtIG1lbW9yeQogIHRoaXMub2FtUmFtID0gbmV3IFVpbnQ4QXJyYXkoMHgxMDApOwoKICAvLyBzcHJpdGUgYnVmZmVycwogIHRoaXMuc2Vjb25kYXJ5T2FtID0gbmV3IFVpbnQ4QXJyYXkoMHgyMCk7CiAgdGhpcy5zcHJpdGVUaWxlcyA9IG5ldyBVaW50OEFycmF5KDB4MTApOwoKICAvLyBmaW5hbCBwaXhlbCBvdXRwdXQKICB0aGlzLnBpeGVsT3V0cHV0ID0gbmV3IFVpbnQxNkFycmF5KDI1NiAqIDI0MCk7CgogIHRoaXMucmVzZXQgPSBmdW5jdGlvbigpIHsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBhbGV0dGVSYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5wYWxldHRlUmFtW2ldID0gMDsKICAgIH0KICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLm9hbVJhbS5sZW5ndGg7IGkrKykgewogICAgICB0aGlzLm9hbVJhbVtpXSA9IDA7CiAgICB9CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5zZWNvbmRhcnlPYW0ubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5zZWNvbmRhcnlPYW1baV0gPSAwOwogICAgfQogICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuc3ByaXRlVGlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5zcHJpdGVUaWxlc1tpXSA9IDA7CiAgICB9CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5waXhlbE91dHB1dC5sZW5ndGg7IGkrKykgewogICAgICB0aGlzLnBpeGVsT3V0cHV0W2ldID0gMDsKICAgIH0KCiAgICAvLyBzY3JvbGxpbmcgLyB2cmFtIGFkZHJlc3MKICAgIHRoaXMudCA9IDA7IC8vIHRlbXBvcmFyeSB2cmFtIGFkZHJlc3MKICAgIHRoaXMudiA9IDA7IC8vIHZyYW0gYWRkcmVzcwogICAgdGhpcy53ID0gMDsgLy8gd3JpdGUgZmxhZwogICAgdGhpcy54ID0gMDsgLy8gZmluZSB4IHNjcm9sbAoKICAgIC8vIGRvdCBwb3NpdGlvbgogICAgdGhpcy5saW5lID0gMDsKICAgIHRoaXMuZG90ID0gMDsKICAgIHRoaXMuZXZlbkZyYW1lID0gdHJ1ZTsKCiAgICAvLyByZXN0CiAgICB0aGlzLm9hbUFkZHJlc3MgPSAwOyAvLyBvYW0gYWRkcmVzcwogICAgdGhpcy5yZWFkQnVmZmVyID0gMDsgLy8gMjAwNyBidWZmZXI7CgogICAgLy8gZm9yIFBQVVNUQVVTCiAgICB0aGlzLnNwcml0ZVplcm8gPSBmYWxzZTsKICAgIHRoaXMuc3ByaXRlT3ZlcmZsb3cgPSBmYWxzZTsKICAgIHRoaXMuaW5WYmxhbmsgPSBmYWxzZTsKCiAgICAvLyBmb3IgUFBVQ1RSTAogICAgdGhpcy52cmFtSW5jcmVtZW50ID0gMTsKICAgIHRoaXMuc3ByaXRlUGF0dGVybkJhc2UgPSAwOwogICAgdGhpcy5iZ1BhdHRlcm5CYXNlID0gMDsKICAgIHRoaXMuc3ByaXRlSGVpZ2h0ID0gODsKICAgIHRoaXMuc2xhdmUgPSBmYWxzZTsKICAgIHRoaXMuZ2VuZXJhdGVObWkgPSBmYWxzZTsKCiAgICAvLyBmb3IgUFBVTUFTSwogICAgdGhpcy5ncmV5U2NhbGUgPSBmYWxzZTsKICAgIHRoaXMuYmdJbkxlZnQgPSBmYWxzZTsKICAgIHRoaXMuc3BySW5MZWZ0ID0gZmFsc2U7CiAgICB0aGlzLmJnUmVuZGVyaW5nID0gZmFsc2U7CiAgICB0aGlzLnNwclJlbmRlcmluZyA9IGZhbHNlOwogICAgdGhpcy5lbXBoYXNpcyA9IDA7CgogICAgLy8gaW50ZXJuYWwgb3BlcmF0aW9uCiAgICB0aGlzLmF0bCA9IDA7CiAgICB0aGlzLmF0ciA9IDA7CiAgICB0aGlzLnRsID0gMDsKICAgIHRoaXMudGggPSAwOwogICAgdGhpcy5zcHJpdGVaZXJvSW4gPSBmYWxzZTsKICAgIHRoaXMuc3ByaXRlQ291bnQgPSAwOwogIH0KICB0aGlzLnJlc2V0KCk7CiAgdGhpcy5zYXZlVmFycyA9IFsKICAgICJwYWxldHRlUmFtIiwgIm9hbVJhbSIsICJzZWNvbmRhcnlPYW0iLCAic3ByaXRlVGlsZXMiLCAidCIsICJ2IiwKICAgICJ3IiwgIngiLCAibGluZSIsICJkb3QiLCAiZXZlbkZyYW1lIiwgIm9hbUFkZHJlc3MiLCAicmVhZEJ1ZmZlciIsCiAgICAic3ByaXRlWmVybyIsICJzcHJpdGVPdmVyZmxvdyIsICJpblZibGFuayIsICJ2cmFtSW5jcmVtZW50IiwKICAgICJzcHJpdGVQYXR0ZXJuQmFzZSIsICJiZ1BhdHRlcm5CYXNlIiwgInNwcml0ZUhlaWdodCIsICJzbGF2ZSIsCiAgICAiZ2VuZXJhdGVObWkiLCAiZ3JleVNjYWxlIiwgImJnSW5MZWZ0IiwgInNwckluTGVmdCIsICJiZ1JlbmRlcmluZyIsCiAgICAic3ByUmVuZGVyaW5nIiwgImVtcGhhc2lzIiwgImF0bCIsICJhdHIiLCAidGwiLCAidGgiLCAic3ByaXRlWmVyb0luIiwKICAgICJzcHJpdGVDb3VudCIKICBdOwoKICB0aGlzLmN5Y2xlID0gZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLmxpbmUgPCAyNDApIHsKICAgICAgLy8gdmlzaWJsZSBmcmFtZQogICAgICBpZih0aGlzLmRvdCA8IDI1NikgewogICAgICAgIHRoaXMuZ2VuZXJhdGVEb3QoKTsKICAgICAgICBpZigoKHRoaXMuZG90ICsgMSkgJiAweDcpID09PSAwKSB7CiAgICAgICAgICAvLyBkb3QgNywgMTUsIDIzLCAzMSBldGMKICAgICAgICAgIGlmKHRoaXMuYmdSZW5kZXJpbmcgfHwgdGhpcy5zcHJSZW5kZXJpbmcpIHsKICAgICAgICAgICAgdGhpcy5yZWFkVGlsZUJ1ZmZlcnMoKTsKICAgICAgICAgICAgdGhpcy5pbmNyZW1lbnRWeCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuZG90ID09PSAyNTYpIHsKICAgICAgICBpZih0aGlzLmJnUmVuZGVyaW5nIHx8IHRoaXMuc3ByUmVuZGVyaW5nKSB7CiAgICAgICAgICB0aGlzLmluY3JlbWVudFZ5KCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYodGhpcy5kb3QgPT09IDI1NykgewogICAgICAgIGlmKHRoaXMuYmdSZW5kZXJpbmcgfHwgdGhpcy5zcHJSZW5kZXJpbmcpIHsKICAgICAgICAgIC8vIGNvcHkgeCBwYXJ0cyBmcm9tIHQgdG8gdgogICAgICAgICAgdGhpcy52ICY9IDB4N2JlMDsKICAgICAgICAgIHRoaXMudiB8PSAodGhpcy50ICYgMHg0MWYpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuZG90ID09PSAyNzApIHsKICAgICAgICAvLyBjbGVhciBzcHJpdGUgYnVmZmVycwogICAgICAgIHRoaXMuc3ByaXRlWmVyb0luID0gZmFsc2U7CiAgICAgICAgdGhpcy5zcHJpdGVDb3VudCA9IDA7CiAgICAgICAgaWYodGhpcy5iZ1JlbmRlcmluZyB8fCB0aGlzLnNwclJlbmRlcmluZykgewogICAgICAgICAgLy8gZG8gc3ByaXRlIGV2YWx1YXRpb24gYW5kIHNwcml0ZSB0aWxlIGZldGNoaW5nCiAgICAgICAgICB0aGlzLmV2YWx1YXRlU3ByaXRlcygpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuZG90ID09PSAzMjEgfHwgdGhpcy5kb3QgPT09IDMyOSkgewogICAgICAgIGlmICh0aGlzLmJnUmVuZGVyaW5nIHx8IHRoaXMuc3ByUmVuZGVyaW5nKSB7CiAgICAgICAgICB0aGlzLnJlYWRUaWxlQnVmZmVycygpOwogICAgICAgICAgdGhpcy5pbmNyZW1lbnRWeCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmKHRoaXMubGluZSA9PT0gMjQxKSB7CiAgICAgIGlmKHRoaXMuZG90ID09PSAxKSB7CiAgICAgICAgdGhpcy5pblZibGFuayA9IHRydWU7CiAgICAgICAgaWYodGhpcy5nZW5lcmF0ZU5taSkgewogICAgICAgICAgdGhpcy5uZXMuY3B1Lm5taVdhbnRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmKHRoaXMuYmdSZW5kZXJpbmcgfHwgdGhpcy5zcHJSZW5kZXJpbmcpIHsKICAgICAgICAgIHRoaXMuZXZlbkZyYW1lID0gIXRoaXMuZXZlbkZyYW1lOyAvLyBmbGlwIGZyYW1lIHN0YXRlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZXZlbkZyYW1lID0gdHJ1ZTsgLy8gbm90IGluIHJlbmRlcmluZywgYWxsIGZyYW1lcyBhcmUgZXZlbgogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmKHRoaXMubGluZSA9PT0gMjYxKSB7CiAgICAgIC8vIHByZSByZW5kZXIgbGluZQogICAgICBpZih0aGlzLmRvdCA9PT0gMSkgewogICAgICAgIHRoaXMuaW5WYmxhbmsgPSBmYWxzZTsKICAgICAgICB0aGlzLnNwcml0ZVplcm8gPSBmYWxzZTsKICAgICAgICB0aGlzLnNwcml0ZU92ZXJmbG93ID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZih0aGlzLmRvdCA9PT0gMjU3KSB7CiAgICAgICAgaWYodGhpcy5iZ1JlbmRlcmluZyB8fCB0aGlzLnNwclJlbmRlcmluZykgewogICAgICAgICAgLy8gY29weSB4IHBhcnRzIGZyb20gdCB0byB2CiAgICAgICAgICB0aGlzLnYgJj0gMHg3YmUwOwogICAgICAgICAgdGhpcy52IHw9ICh0aGlzLnQgJiAweDQxZik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYodGhpcy5kb3QgPT09IDI3MCkgewogICAgICAgIC8vIGNsZWFyIHNwcml0ZSBidWZmZXJzIGZyb20gc3ByaXRlcyBldmFsdWF0ZWQgb24gbGluZSAyMzkKICAgICAgICB0aGlzLnNwcml0ZVplcm9JbiA9IGZhbHNlOwogICAgICAgIHRoaXMuc3ByaXRlQ291bnQgPSAwOwogICAgICAgIGlmKHRoaXMuYmdSZW5kZXJpbmcgfHwgdGhpcy5zcHJSZW5kZXJpbmcpIHsKICAgICAgICAgIC8vIGdhcmJhZ2Ugc3ByaXRlIGZldGNoCiAgICAgICAgICBsZXQgYmFzZSA9IHRoaXMuc3ByaXRlSGVpZ2h0ID09PSAxNiA/IDB4MTAwMCA6IHRoaXMuc3ByaXRlUGF0dGVybkJhc2U7CiAgICAgICAgICB0aGlzLnJlYWRJbnRlcm5hbChiYXNlICsgMHhmZmYpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuZG90ID09PSAyODApIHsKICAgICAgICBpZih0aGlzLmJnUmVuZGVyaW5nIHx8IHRoaXMuc3ByUmVuZGVyaW5nKSB7CiAgICAgICAgICAvLyBjb3B5IHkgcGFydHMgZnJvbSB0IHRvIHYKICAgICAgICAgIHRoaXMudiAmPSAweDQxZjsKICAgICAgICAgIHRoaXMudiB8PSAodGhpcy50ICYgMHg3YmUwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZih0aGlzLmRvdCA9PT0gMzIxIHx8IHRoaXMuZG90ID09PSAzMjkpIHsKICAgICAgICBpZih0aGlzLmJnUmVuZGVyaW5nIHx8IHRoaXMuc3ByUmVuZGVyaW5nKSB7CiAgICAgICAgICB0aGlzLnJlYWRUaWxlQnVmZmVycygpOwogICAgICAgICAgdGhpcy5pbmNyZW1lbnRWeCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHRoaXMuZG90Kys7CiAgICBpZih0aGlzLmRvdCA9PT0gMzQxIHx8ICgKICAgICAgdGhpcy5kb3QgPT09IDM0MCAmJiB0aGlzLmxpbmUgPT09IDI2MSAmJiAhdGhpcy5ldmVuRnJhbWUKICAgICkpIHsKICAgICAgLy8gaWYgd2UgbG9vcCAoMSBlYXJseSBvbiBvZGQgZnJhbWVzIG9uIGxpbmUgMjYxKQogICAgICB0aGlzLmRvdCA9IDA7CiAgICAgIHRoaXMubGluZSsrOwogICAgICBpZih0aGlzLmxpbmUgPT09IDI2MikgewogICAgICAgIHRoaXMubGluZSA9IDA7CiAgICAgIH0KICAgIH0KICB9CgogIHRoaXMuZXZhbHVhdGVTcHJpdGVzID0gZnVuY3Rpb24oKSB7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMjU2OyBpICs9IDQpIHsKICAgICAgbGV0IHNwclkgPSB0aGlzLm9hbVJhbVtpXTsKICAgICAgbGV0IHNwclJvdyA9IHRoaXMubGluZSAtIHNwclk7CiAgICAgIGlmKHNwclJvdyA+PSAwICYmIHNwclJvdyA8IHRoaXMuc3ByaXRlSGVpZ2h0KSB7CiAgICAgICAgLy8gc3ByaXRlIGlzIG9uIHRoaXMgc2NhbmxpbmUKICAgICAgICBpZih0aGlzLnNwcml0ZUNvdW50ID09PSA4KSB7CiAgICAgICAgICAvLyBzZWNvbmRhcnkgb2FtIGlzIGZ1bGwKICAgICAgICAgIHRoaXMuc3ByaXRlT3ZlcmZsb3cgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHBsYWNlIGluIHNlY29uZGFyeSBvYW0KICAgICAgICAgIGlmKGkgPT09IDApIHsKICAgICAgICAgICAgLy8gc3ByaXRlIHplcm8KICAgICAgICAgICAgdGhpcy5zcHJpdGVaZXJvSW4gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zZWNvbmRhcnlPYW1bdGhpcy5zcHJpdGVDb3VudCAqIDRdID0gdGhpcy5vYW1SYW1baV07CiAgICAgICAgICB0aGlzLnNlY29uZGFyeU9hbVt0aGlzLnNwcml0ZUNvdW50ICogNCArIDFdID0gdGhpcy5vYW1SYW1baSArIDFdOwogICAgICAgICAgdGhpcy5zZWNvbmRhcnlPYW1bdGhpcy5zcHJpdGVDb3VudCAqIDQgKyAyXSA9IHRoaXMub2FtUmFtW2kgKyAyXTsKICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5T2FtW3RoaXMuc3ByaXRlQ291bnQgKiA0ICsgM10gPSB0aGlzLm9hbVJhbVtpICsgM107CiAgICAgICAgICAvLyBmZXRjaCB0aGUgdGlsZXMKICAgICAgICAgIGlmKCh0aGlzLm9hbVJhbVtpICsgMl0gJiAweDgwKSA+IDApIHsKICAgICAgICAgICAgc3ByUm93ID0gdGhpcy5zcHJpdGVIZWlnaHQgLSAxIC0gc3ByUm93OwogICAgICAgICAgfQogICAgICAgICAgbGV0IGJhc2UgPSB0aGlzLnNwcml0ZVBhdHRlcm5CYXNlOwogICAgICAgICAgbGV0IHRpbGVOdW0gPSB0aGlzLm9hbVJhbVtpICsgMV07CiAgICAgICAgICBpZih0aGlzLnNwcml0ZUhlaWdodCA9PT0gMTYpIHsKICAgICAgICAgICAgYmFzZSA9ICh0aWxlTnVtICYgMHgxKSAqIDB4MTAwMDsKICAgICAgICAgICAgdGlsZU51bSA9ICh0aWxlTnVtICYgMHhmZSk7CiAgICAgICAgICAgIHRpbGVOdW0gKz0gKHNwclJvdyAmIDB4OCkgPj4gMzsKICAgICAgICAgICAgc3ByUm93ICY9IDB4NzsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc3ByaXRlVGlsZXNbdGhpcy5zcHJpdGVDb3VudF0gPSB0aGlzLnJlYWRJbnRlcm5hbCgKICAgICAgICAgICAgYmFzZSArIHRpbGVOdW0gKiAxNiArIHNwclJvdwogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMuc3ByaXRlVGlsZXNbdGhpcy5zcHJpdGVDb3VudCArIDhdID0gdGhpcy5yZWFkSW50ZXJuYWwoCiAgICAgICAgICAgIGJhc2UgKyB0aWxlTnVtICogMTYgKyBzcHJSb3cgKyA4CiAgICAgICAgICApOwogICAgICAgICAgdGhpcy5zcHJpdGVDb3VudCsrOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYodGhpcy5zcHJpdGVDb3VudCA8IDgpIHsKICAgICAgLy8gZ2FyYmFnZSBmZXRjaCBpZiBub3QgYWxsIHNsb3RzIHdlcmUgZmlsbGVkCiAgICAgIGxldCBiYXNlID0gdGhpcy5zcHJpdGVIZWlnaHQgPT09IDE2ID8gMHgxMDAwIDogdGhpcy5zcHJpdGVQYXR0ZXJuQmFzZTsKICAgICAgdGhpcy5yZWFkSW50ZXJuYWwoYmFzZSArIDB4ZmZmKTsKICAgIH0KICB9CgogIHRoaXMucmVhZFRpbGVCdWZmZXJzID0gZnVuY3Rpb24oKSB7CiAgICBsZXQgdGlsZU51bSA9IHRoaXMucmVhZEludGVybmFsKDB4MjAwMCArICh0aGlzLnYgJiAweGZmZikpOwoKICAgIHRoaXMuYXRsID0gdGhpcy5hdHI7CiAgICBsZXQgYXR0QWRyID0gMHgyM2MwOwogICAgYXR0QWRyIHw9ICh0aGlzLnYgJiAweDFjKSA+PiAyOwogICAgYXR0QWRyIHw9ICh0aGlzLnYgJiAweDM4MCkgPj4gNDsKICAgIGF0dEFkciB8PSAodGhpcy52ICYgMHhjMDApOwogICAgdGhpcy5hdHIgPSB0aGlzLnJlYWRJbnRlcm5hbChhdHRBZHIpOwogICAgaWYoKHRoaXMudiAmIDB4NDApID4gMCkgewogICAgICAvLyBib3R0b20gaGFsZgogICAgICB0aGlzLmF0ciA+Pj0gNDsKICAgIH0KICAgIHRoaXMuYXRyICY9IDB4ZjsKICAgIGlmKCh0aGlzLnYgJiAweDAyKSA+IDApIHsKICAgICAgLy8gcmlnaHQgaGFsZgogICAgICB0aGlzLmF0ciA+Pj0gMjsKICAgIH0KICAgIHRoaXMuYXRyICY9IDB4MzsKCiAgICBsZXQgZmluZVkgPSAodGhpcy52ICYgMHg3MDAwKSA+PiAxMjsKICAgIHRoaXMudGwgJj0gMHhmZjsKICAgIHRoaXMudGwgPDw9IDg7CiAgICB0aGlzLnRsIHw9IHRoaXMucmVhZEludGVybmFsKHRoaXMuYmdQYXR0ZXJuQmFzZSArIHRpbGVOdW0gKiAxNiArIGZpbmVZKTsKICAgIHRoaXMudGggJj0gMHhmZjsKICAgIHRoaXMudGggPDw9IDg7CiAgICB0aGlzLnRoIHw9IHRoaXMucmVhZEludGVybmFsKAogICAgICB0aGlzLmJnUGF0dGVybkJhc2UgKyB0aWxlTnVtICogMTYgKyBmaW5lWSArIDgKICAgICk7CiAgfQoKICB0aGlzLmdlbmVyYXRlRG90ID0gZnVuY3Rpb24oKSB7CiAgICBsZXQgaSA9IHRoaXMuZG90ICYgMHg3OwogICAgbGV0IGJnUGl4ZWwgPSAwOwogICAgbGV0IHNwclBpeGVsID0gMDsKICAgIGxldCBzcHJOdW0gPSAtMTsKICAgIGxldCBzcHJQcmlvcml0eSA9IDA7CiAgICBsZXQgZmluYWxDb2xvcjsKCiAgICBpZih0aGlzLnNwclJlbmRlcmluZyAmJiAodGhpcy5kb3QgPiA3IHx8IHRoaXMuc3BySW5MZWZ0KSkgewogICAgICAvLyBpZiBzcHJpdGUgcmVuZGVyaW5nIGlzIG9uLCBhbmQgZWl0aGVyIG5vdCB0aGUgbGVmdCA4IHBpeGVscwogICAgICAvLyBvciBzcHJpdGUgcmVuZGVyaW5nIGluIGxlZnQgOCBwaXhlbHMgaXMgb24KICAgICAgLy8gc2VhcmNoIHRocm91Z2ggYWxsIHNwcml0ZXMgaW4gc2Vjb25kYXJ5IG9hbSB0byBmaW5kIG9uZXMKICAgICAgLy8gb24gdGhpcyBkb3QsIGFuZCBwaWNrIHRoZSBmaXJzdCBub24tMCBwaXhlbAogICAgICBmb3IobGV0IGogPSAwOyBqIDwgdGhpcy5zcHJpdGVDb3VudDsgaisrKSB7CiAgICAgICAgbGV0IHhQb3MgPSB0aGlzLnNlY29uZGFyeU9hbVtqICogNCArIDNdOwogICAgICAgIGxldCB4Q29sID0gdGhpcy5kb3QgLSB4UG9zOwogICAgICAgIGlmKHhDb2wgPj0gMCAmJiB4Q29sIDwgOCkgewogICAgICAgICAgLy8gc3ByaXRlIGlzIGluIHJhbmdlCiAgICAgICAgICBpZigodGhpcy5zZWNvbmRhcnlPYW1baiAqIDQgKyAyXSAmIDB4NDApID4gMCkgewogICAgICAgICAgICB4Q29sID0gNyAtIHhDb2w7CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgc2hpZnQgPSA3IC0geENvbDsKICAgICAgICAgIGxldCBwaXhlbCA9ICh0aGlzLnNwcml0ZVRpbGVzW2pdID4+IHNoaWZ0KSAmIDE7CiAgICAgICAgICBwaXhlbCB8PSAoKHRoaXMuc3ByaXRlVGlsZXNbaiArIDhdID4+IHNoaWZ0KSAmIDEpIDw8IDE7CiAgICAgICAgICBpZihwaXhlbCA+IDApIHsKICAgICAgICAgICAgLy8gc2V0IHRoZSBwaXhlbCwgcHJpb3JpdHksIGFuZCBudW1iZXIKICAgICAgICAgICAgc3ByUGl4ZWwgPSBwaXhlbCB8ICgodGhpcy5zZWNvbmRhcnlPYW1baiAqIDQgKyAyXSAmIDB4MykgPDwgMik7CiAgICAgICAgICAgIHNwclByaW9yaXR5ID0gKHRoaXMuc2Vjb25kYXJ5T2FtW2ogKiA0ICsgMl0gJiAweDIwKSA+PiA1OwogICAgICAgICAgICBzcHJOdW0gPSBqOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZih0aGlzLmJnUmVuZGVyaW5nICYmICh0aGlzLmRvdCA+IDcgfHwgdGhpcy5iZ0luTGVmdCkpIHsKICAgICAgLy8gaWYgYmcgcmVuZGVyaW5nIGlzIG9uLCBhbmQgZWl0aGVyIG5vdCB0aGUgbGVmdCA4IHBpeGVscwogICAgICAvLyBvciBiZyByZW5kZXJpbmcgaW4gbGVmdCA4IGNvbHVtbnMgaXMgb24KICAgICAgbGV0IHNoaWZ0QW1vdW50ID0gMTUgLSBpIC0gdGhpcy54OwogICAgICBiZ1BpeGVsID0gKHRoaXMudGwgPj4gc2hpZnRBbW91bnQpICYgMTsKICAgICAgYmdQaXhlbCB8PSAoKHRoaXMudGggPj4gc2hpZnRBbW91bnQpICYgMSkgPDwgMTsKICAgICAgbGV0IGF0ck9mZjsKICAgICAgaWYodGhpcy54ICsgaSA+IDcpIHsKICAgICAgICAvLyByaWdodCB0aWxlCiAgICAgICAgYXRyT2ZmID0gdGhpcy5hdHIgKiA0OwogICAgICB9IGVsc2UgewogICAgICAgIGF0ck9mZiA9IHRoaXMuYXRsICogNDsKICAgICAgfQogICAgICBpZihiZ1BpeGVsID4gMCkgewogICAgICAgIGJnUGl4ZWwgKz0gYXRyT2ZmOwogICAgICB9CiAgICB9CgogICAgaWYoIXRoaXMuYmdSZW5kZXJpbmcgJiYgIXRoaXMuc3ByUmVuZGVyaW5nKSB7CiAgICAgIC8vIGRpc3BsYXkgY29sb3IgMCwgb3IgY29sb3IgYXQgdnJhbSBhZGRyZXNzIGlmIHBvaW50aW5nIHRvIHBhbGV0dGUKICAgICAgaWYoKHRoaXMudiAmIDB4M2ZmZikgPj0gMHgzZjAwKSB7CiAgICAgICAgZmluYWxDb2xvciA9IHRoaXMucmVhZFBhbGV0dGUodGhpcy52ICYgMHgxZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmluYWxDb2xvciA9IHRoaXMucmVhZFBhbGV0dGUoMCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIGlmIGJnIHBpeGVsIGlzIDAsIHJlbmRlciBzcHJpdGUgcGl4ZWwKICAgICAgaWYoYmdQaXhlbCA9PT0gMCkgewogICAgICAgIGlmKHNwclBpeGVsID4gMCkgewogICAgICAgICAgZmluYWxDb2xvciA9IHRoaXMucmVhZFBhbGV0dGUoc3ByUGl4ZWwgKyAweDEwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZmluYWxDb2xvciA9IHRoaXMucmVhZFBhbGV0dGUoMCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIHJlbmRlciBzcHJpdGUgcGl4ZWwgaWYgbm90IDAgYW5kIGl0IGhhcyBwcmlvcml0eQogICAgICAgIGlmKHNwclBpeGVsID4gMCkgewogICAgICAgICAgLy8gY2hlY2sgZm9yIHNwcml0ZSB6ZXJvCiAgICAgICAgICBpZihzcHJOdW0gPT09IDAgJiYgdGhpcy5zcHJpdGVaZXJvSW4gJiYgdGhpcy5kb3QgIT09IDI1NSkgewogICAgICAgICAgICB0aGlzLnNwcml0ZVplcm8gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZihzcHJQaXhlbCA+IDAgJiYgc3ByUHJpb3JpdHkgPT09IDApIHsKICAgICAgICAgIGZpbmFsQ29sb3IgPSB0aGlzLnJlYWRQYWxldHRlKHNwclBpeGVsICsgMHgxMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZpbmFsQ29sb3IgPSB0aGlzLnJlYWRQYWxldHRlKGJnUGl4ZWwpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHRoaXMucGl4ZWxPdXRwdXRbCiAgICAgIHRoaXMubGluZSAqIDI1NiArIHRoaXMuZG90CiAgICBdID0gKHRoaXMuZW1waGFzaXMgPDwgNikgfCAoZmluYWxDb2xvciAmIDB4M2YpOwogIH0KCiAgdGhpcy5zZXRGcmFtZSA9IGZ1bmN0aW9uKGZpbmFsQXJyYXkpIHsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBpeGVsT3V0cHV0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGxldCBjb2xvciA9IHRoaXMucGl4ZWxPdXRwdXRbaV07CiAgICAgIGxldCByID0gdGhpcy5uZXNQYWxbY29sb3IgJiAweDNmXVswXTsKICAgICAgbGV0IGcgPSB0aGlzLm5lc1BhbFtjb2xvciAmIDB4M2ZdWzFdOwogICAgICBsZXQgYiA9IHRoaXMubmVzUGFsW2NvbG9yICYgMHgzZl1bMl07CiAgICAgIC8vIGZyb20gaHR0cHM6Ly9mb3J1bXMubmVzZGV2LmNvbS92aWV3dG9waWMucGhwP2Y9MyZ0PTE4NDE2I3AyMzM3MDgKICAgICAgaWYoKGNvbG9yICYgMHg0MCkgPiAwKSB7CiAgICAgICAgLy8gZW1waGFzaXplIHJlZAogICAgICAgIHIgPSByICogMS4xOwogICAgICAgIGcgPSBnICogMC45OwogICAgICAgIGIgPSBiICogMC45OwogICAgICB9CiAgICAgIGlmKChjb2xvciAmIDB4ODApID4gMCkgewogICAgICAgIC8vIGVtcGhhc2l6ZSBncmVlbgogICAgICAgIHIgPSByICogMC45OwogICAgICAgIGcgPSBnICogMS4xOwogICAgICAgIGIgPSBiICogMC45OwogICAgICB9CiAgICAgIGlmKChjb2xvciAmIDB4MTAwKSA+IDApIHsKICAgICAgICAvLyBlbXBoYXNpemUgYmx1ZQogICAgICAgIHIgPSByICogMC45OwogICAgICAgIGcgPSBnICogMC45OwogICAgICAgIGIgPSBiICogMS4xOwogICAgICB9CiAgICAgIHIgPSAociA+IDI1NSA/IDI1NSA6IHIpICYgMHhmZjsKICAgICAgZyA9IChnID4gMjU1ID8gMjU1IDogZykgJiAweGZmOwogICAgICBiID0gKGIgPiAyNTUgPyAyNTUgOiBiKSAmIDB4ZmY7CiAgICAgIGZpbmFsQXJyYXlbaSAqIDRdID0gcjsKICAgICAgZmluYWxBcnJheVtpICogNCArIDFdID0gZzsKICAgICAgZmluYWxBcnJheVtpICogNCArIDJdID0gYjsKICAgICAgZmluYWxBcnJheVtpICogNCArIDNdID0gMjU1OwogICAgfQogIH0KCiAgLy8gZnJvbSBodHRwczovL3dpa2kubmVzZGV2LmNvbS93L2luZGV4LnBocC9QUFVfc2Nyb2xsaW5nCiAgdGhpcy5pbmNyZW1lbnRWeCA9IGZ1bmN0aW9uKCkgewogICAgaWYoKHRoaXMudiAmIDB4MWYpID09PSAweDFmKSB7CiAgICAgIHRoaXMudiAmPSAweDdmZTA7CiAgICAgIHRoaXMudiBePSAweDQwMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMudisrOwogICAgfQogIH0KICB0aGlzLmluY3JlbWVudFZ5ID0gZnVuY3Rpb24oKSB7CiAgICBpZigodGhpcy52ICYgMHg3MDAwKSAhPT0gMHg3MDAwKSB7CiAgICAgIHRoaXMudiArPSAweDEwMDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnYgJj0gMHhmZmY7CiAgICAgIGxldCBjb2Fyc2VZID0gKHRoaXMudiAmIDB4M2UwKSA+PiA1OwogICAgICBpZihjb2Fyc2VZID09PSAyOSkgewogICAgICAgIGNvYXJzZVkgPSAwOwogICAgICAgIHRoaXMudiBePSAweDgwMDsKICAgICAgfSBlbHNlIGlmKGNvYXJzZVkgPT09IDMxKSB7CiAgICAgICAgY29hcnNlWSA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29hcnNlWSsrOwogICAgICB9CiAgICAgIHRoaXMudiAmPSAweDdjMWY7CiAgICAgIHRoaXMudiB8PSAoY29hcnNlWSA8PCA1KTsKICAgIH0KICB9CgogIHRoaXMucmVhZEludGVybmFsID0gZnVuY3Rpb24oYWRyKSB7CiAgICBhZHIgJj0gMHgzZmZmOwogICAgcmV0dXJuIHRoaXMubmVzLm1hcHBlci5wcHVSZWFkKGFkcik7CiAgfQoKICB0aGlzLndyaXRlSW50ZXJuYWwgPSBmdW5jdGlvbihhZHIsIHZhbHVlKSB7CiAgICBhZHIgJj0gMHgzZmZmOwogICAgdGhpcy5uZXMubWFwcGVyLnBwdVdyaXRlKGFkciwgdmFsdWUpOwogIH0KCiAgdGhpcy5yZWFkUGFsZXR0ZSA9IGZ1bmN0aW9uKGFkcikgewogICAgbGV0IHBhbEFkciA9IGFkciAmIDB4MWY7CiAgICBpZihwYWxBZHIgPj0gMHgxMCAmJiAocGFsQWRyICYgMHgzKSA9PT0gMCkgewogICAgICAvLyAweDEwLCAweDE0LCAweDE4IGFuZCAweDFjIGFyZSBtaXJyb3JlZCB0byAwLCA0LCA4IGFuZCAweGMKICAgICAgcGFsQWRyIC09IDB4MTA7CiAgICB9CiAgICBsZXQgcmV0ID0gdGhpcy5wYWxldHRlUmFtW3BhbEFkcl07CiAgICBpZih0aGlzLmdyZXlTY2FsZSkgewogICAgICByZXQgJj0gMHgzMDsKICAgIH0KICAgIHJldHVybiByZXQ7CiAgfQoKICB0aGlzLndyaXRlUGFsZXR0ZSA9IGZ1bmN0aW9uKGFkciwgdmFsdWUpIHsKICAgIGxldCBwYWxBZHIgPSBhZHIgJiAweDFmOwogICAgaWYocGFsQWRyID49IDB4MTAgJiYgKHBhbEFkciAmIDB4MykgPT09IDApIHsKICAgICAgLy8gMHgxMCwgMHgxNCwgMHgxOCBhbmQgMHgxYyBhcmUgbWlycm9yZWQgdG8gMCwgNCwgOCBhbmQgMHhjCiAgICAgIHBhbEFkciAtPSAweDEwOwogICAgfQogICAgdGhpcy5wYWxldHRlUmFtW3BhbEFkcl0gPSB2YWx1ZTsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgc3dpdGNoKGFkcikgewogICAgICBjYXNlIDA6CiAgICAgIGNhc2UgMTogewogICAgICAgIC8vIFBQVUNUUkwsIFBQVU1BU0sKICAgICAgICByZXR1cm4gMDsgLy8gbm90IHJlYWRhYmxlCiAgICAgIH0KICAgICAgY2FzZSAyOiB7CiAgICAgICAgLy8gUFBVU1RBVFVTCiAgICAgICAgbGV0IHJldCA9IDA7CiAgICAgICAgaWYodGhpcy5pblZibGFuaykgewogICAgICAgICAgcmV0IHw9IDB4ODA7CiAgICAgICAgfQogICAgICAgIHJldCB8PSB0aGlzLnNwcml0ZVplcm8gPyAweDQwIDogMDsKICAgICAgICByZXQgfD0gdGhpcy5zcHJpdGVPdmVyZmxvdyA/IDB4MjAgOiAwOwogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0KICAgICAgY2FzZSAzOiB7CiAgICAgICAgLy8gT0FNQUREUgogICAgICAgIHJldHVybiAwOyAvLyBub3QgcmVhZGFibGUKICAgICAgfQogICAgICBjYXNlIDQ6IHsKICAgICAgICAvLyBPQU1EQVRBCiAgICAgICAgcmV0dXJuIHRoaXMub2FtUmFtW3RoaXMub2FtQWRkcmVzc107CiAgICAgIH0KICAgICAgY2FzZSA1OgogICAgICBjYXNlIDY6IHsKICAgICAgICAvLyBQUFVTQ1JPTEwsIFBQVUFERFIKICAgICAgICByZXR1cm4gMDsgLy8gbm90IHJlYWRhYmxlCiAgICAgIH0KICAgICAgY2FzZSA3OiB7CiAgICAgICAgLy8gUFBVREFUQQogICAgICAgIGxldCBhZHIgPSB0aGlzLnYgJiAweDNmZmY7CiAgICAgICAgbGV0IHRlbXAgPSB0aGlzLnJlYWRCdWZmZXI7CiAgICAgICAgaWYoYWRyID49IDB4M2YwMCkgewogICAgICAgICAgLy8gcmVhZCBwYWxldHRlIGluIHRlbXAKICAgICAgICAgIHRlbXAgPSB0aGlzLnJlYWRQYWxldHRlKGFkcik7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0ZW1wOwogICAgICB9CiAgICB9CiAgfQoKICB0aGlzLnJlYWQgPSBmdW5jdGlvbihhZHIpIHsKICAgIHN3aXRjaChhZHIpIHsKICAgICAgY2FzZSAwOiB7CiAgICAgICAgLy8gUFBVQ1RSTAogICAgICAgIHJldHVybiAwOyAvLyBub3QgcmVhZGFibGUKICAgICAgfQogICAgICBjYXNlIDE6IHsKICAgICAgICAvLyBQUFVNQVNLCiAgICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgICB9CiAgICAgIGNhc2UgMjogewogICAgICAgIC8vIFBQVVNUQVRVUwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgICAgbGV0IHJldCA9IDA7CiAgICAgICAgaWYodGhpcy5pblZibGFuaykgewogICAgICAgICAgcmV0IHw9IDB4ODA7CiAgICAgICAgICB0aGlzLmluVmJsYW5rID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldCB8PSB0aGlzLnNwcml0ZVplcm8gPyAweDQwIDogMDsKICAgICAgICByZXQgfD0gdGhpcy5zcHJpdGVPdmVyZmxvdyA/IDB4MjAgOiAwOwogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0KICAgICAgY2FzZSAzOiB7CiAgICAgICAgLy8gT0FNQUREUgogICAgICAgIHJldHVybiAwOyAvLyBub3QgcmVhZGFibGUKICAgICAgfQogICAgICBjYXNlIDQ6IHsKICAgICAgICAvLyBPQU1EQVRBCiAgICAgICAgcmV0dXJuIHRoaXMub2FtUmFtW3RoaXMub2FtQWRkcmVzc107CiAgICAgIH0KICAgICAgY2FzZSA1OiB7CiAgICAgICAgLy8gUFBVU0NST0xMCiAgICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgICB9CiAgICAgIGNhc2UgNjogewogICAgICAgIC8vIFBQVUFERFIKICAgICAgICByZXR1cm4gMDsgLy8gbm90IHJlYWRhYmxlCiAgICAgIH0KICAgICAgY2FzZSA3OiB7CiAgICAgICAgLy8gUFBVREFUQQogICAgICAgIGxldCBhZHIgPSB0aGlzLnYgJiAweDNmZmY7CiAgICAgICAgaWYoCiAgICAgICAgICAodGhpcy5iZ1JlbmRlcmluZyB8fCB0aGlzLnNwclJlbmRlcmluZykgJiYKICAgICAgICAgICh0aGlzLmxpbmUgPCAyNDAgfHwgdGhpcy5saW5lID09PSAyNjEpCiAgICAgICAgKSB7CiAgICAgICAgICAvLyB3aGlsZSByZW5kZXJpbmcsIHZyYW0gaXMgaW5jcmVtZW50ZWQgc3RyYW5nZWx5CiAgICAgICAgICB0aGlzLmluY3JlbWVudFZ5KCk7CiAgICAgICAgICB0aGlzLmluY3JlbWVudFZ4KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudiArPSB0aGlzLnZyYW1JbmNyZW1lbnQ7CiAgICAgICAgICB0aGlzLnYgJj0gMHg3ZmZmOwogICAgICAgIH0KICAgICAgICBsZXQgdGVtcCA9IHRoaXMucmVhZEJ1ZmZlcjsKICAgICAgICBpZihhZHIgPj0gMHgzZjAwKSB7CiAgICAgICAgICAvLyByZWFkIHBhbGV0dGUgaW4gdGVtcAogICAgICAgICAgdGVtcCA9IHRoaXMucmVhZFBhbGV0dGUoYWRyKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5yZWFkQnVmZmVyID0gdGhpcy5yZWFkSW50ZXJuYWwoYWRyKTsKICAgICAgICByZXR1cm4gdGVtcDsKICAgICAgfQogICAgfQogIH0KCiAgdGhpcy53cml0ZSA9IGZ1bmN0aW9uKGFkciwgdmFsdWUpIHsKICAgIHN3aXRjaChhZHIpIHsKICAgICAgY2FzZSAwOiB7CiAgICAgICAgLy8gUFBVQ1RSTAogICAgICAgIHRoaXMudCAmPSAweDczZmY7CiAgICAgICAgdGhpcy50IHw9ICh2YWx1ZSAmIDB4MykgPDwgMTA7CgogICAgICAgIHRoaXMudnJhbUluY3JlbWVudCA9ICh2YWx1ZSAmIDB4MDQpID4gMCA/IDMyIDogMTsKICAgICAgICB0aGlzLnNwcml0ZVBhdHRlcm5CYXNlID0gKHZhbHVlICYgMHgwOCkgPiAwID8gMHgxMDAwIDogMDsKICAgICAgICB0aGlzLmJnUGF0dGVybkJhc2UgPSAodmFsdWUgJiAweDEwKSA+IDAgPyAweDEwMDAgOiAwOwogICAgICAgIHRoaXMuc3ByaXRlSGVpZ2h0ID0gKHZhbHVlICYgMHgyMCkgPiAwID8gMTYgOiA4OwogICAgICAgIGxldCBvbGRObWkgPSB0aGlzLmdlbmVyYXRlTm1pOwogICAgICAgIHRoaXMuc2xhdmUgPSAodmFsdWUgJiAweDQwKSA+IDA7CiAgICAgICAgdGhpcy5nZW5lcmF0ZU5taSA9ICh2YWx1ZSAmIDB4ODApID4gMDsKCiAgICAgICAgaWYodGhpcy5nZW5lcmF0ZU5taSAmJiAhb2xkTm1pICYmIHRoaXMuaW5WYmxhbmspIHsKICAgICAgICAgIC8vIGltbWVkaWF0ZSBubWkgaWYgZW5hYmxlZCBkdXJpbmcgdmJsYW5rCiAgICAgICAgICB0aGlzLm5lcy5jcHUubm1pV2FudGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNhc2UgMTogewogICAgICAgIC8vIFBQVU1BU0sKICAgICAgICB0aGlzLmdyZXlTY2FsZSA9ICh2YWx1ZSAmIDB4MDEpID4gMDsKICAgICAgICB0aGlzLmJnSW5MZWZ0ID0gKHZhbHVlICYgMHgwMikgPiAwOwogICAgICAgIHRoaXMuc3BySW5MZWZ0ID0gKHZhbHVlICYgMHgwNCkgPiAwOwogICAgICAgIHRoaXMuYmdSZW5kZXJpbmcgPSAodmFsdWUgJiAweDA4KSA+IDA7CiAgICAgICAgdGhpcy5zcHJSZW5kZXJpbmcgPSAodmFsdWUgJiAweDEwKSA+IDA7CiAgICAgICAgdGhpcy5lbXBoYXNpcyA9ICh2YWx1ZSAmIDB4ZTApID4+IDU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNhc2UgMjogewogICAgICAgIC8vIFBQVVNUQVRVUwogICAgICAgIHJldHVybjsgLy8gbm90IHdyaXRhYmxlCiAgICAgIH0KICAgICAgY2FzZSAzOiB7CiAgICAgICAgLy8gT0FNQUREUgogICAgICAgIHRoaXMub2FtQWRkcmVzcyA9IHZhbHVlOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjYXNlIDQ6IHsKICAgICAgICAvLyBPQU1EQVRBCiAgICAgICAgdGhpcy5vYW1SYW1bdGhpcy5vYW1BZGRyZXNzKytdID0gdmFsdWU7CiAgICAgICAgdGhpcy5vYW1BZGRyZXNzICY9IDB4ZmY7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNhc2UgNTogewogICAgICAgIC8vIFBQVVNDUk9MTAogICAgICAgIGlmKHRoaXMudyA9PT0gMCkgewogICAgICAgICAgdGhpcy50ICY9IDB4N2ZlMDsKICAgICAgICAgIHRoaXMudCB8PSAodmFsdWUgJiAweGY4KSA+PiAzOwogICAgICAgICAgdGhpcy54ID0gdmFsdWUgJiAweDc7CiAgICAgICAgICB0aGlzLncgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnQgJj0gMHgwYzFmOwogICAgICAgICAgdGhpcy50IHw9ICh2YWx1ZSAmIDB4NykgPDwgMTI7CiAgICAgICAgICB0aGlzLnQgfD0gKHZhbHVlICYgMHhmOCkgPDwgMjsKICAgICAgICAgIHRoaXMudyA9IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjYXNlIDY6IHsKICAgICAgICAvLyBQUFVBRERSCiAgICAgICAgaWYodGhpcy53ID09PSAwKSB7CiAgICAgICAgICB0aGlzLnQgJj0gMHhmZjsKICAgICAgICAgIHRoaXMudCB8PSAodmFsdWUgJiAweDNmKSA8PCA4OwogICAgICAgICAgdGhpcy53ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50ICY9IDB4N2YwMDsKICAgICAgICAgIHRoaXMudCB8PSB2YWx1ZTsKICAgICAgICAgIHRoaXMudiA9IHRoaXMudDsKICAgICAgICAgIHRoaXMudyA9IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjYXNlIDc6IHsKICAgICAgICAvLyBQUFVEQVRBCiAgICAgICAgbGV0IGFkciA9IHRoaXMudiAmIDB4M2ZmZjsKICAgICAgICBpZigKICAgICAgICAgICh0aGlzLmJnUmVuZGVyaW5nIHx8IHRoaXMuc3ByUmVuZGVyaW5nKSAmJgogICAgICAgICAgKHRoaXMubGluZSA8IDI0MCB8fCB0aGlzLmxpbmUgPT09IDI2MSkKICAgICAgICApIHsKICAgICAgICAgIC8vIHdoaWxlIHJlbmRlcmluZywgdnJhbSBpcyBpbmNyZW1lbnRlZCBzdHJhbmdlbHkKICAgICAgICAgIHRoaXMuaW5jcmVtZW50VnkoKTsKICAgICAgICAgIHRoaXMuaW5jcmVtZW50VngoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy52ICs9IHRoaXMudnJhbUluY3JlbWVudDsKICAgICAgICAgIHRoaXMudiAmPSAweDdmZmY7CiAgICAgICAgfQogICAgICAgIGlmKGFkciA+PSAweDNmMDApIHsKICAgICAgICAgIC8vIHdyaXRlIHBhbGV0dGUKICAgICAgICAgIHRoaXMud3JpdGVQYWxldHRlKGFkciwgdmFsdWUpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLndyaXRlSW50ZXJuYWwoYWRyLCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBmcm9tIGh0dHBzOi8vd2lraS5uZXNkZXYuY29tL3cvaW5kZXgucGhwL1BQVV9wYWxldHRlcyAoc2F2dG9vbCBwYWxldHRlKQogIHRoaXMubmVzUGFsID0gWwogICAgWzEwMSwxMDEsMTAxXSxbMCw0NSwxMDVdLFsxOSwzMSwxMjddLFs2MCwxOSwxMjRdLFs5NiwxMSw5OF0sWzExNSwxMCw1NV0sWzExMywxNSw3XSxbOTAsMjYsMF0sWzUyLDQwLDBdLFsxMSw1MiwwXSxbMCw2MCwwXSxbMCw2MSwxNl0sWzAsNTYsNjRdLFswLDAsMF0sWzAsMCwwXSxbMCwwLDBdLAogICAgWzE3NCwxNzQsMTc0XSxbMTUsOTksMTc5XSxbNjQsODEsMjA4XSxbMTIwLDY1LDIwNF0sWzE2Nyw1NCwxNjldLFsxOTIsNTIsMTEyXSxbMTg5LDYwLDQ4XSxbMTU5LDc0LDBdLFsxMDksOTIsMF0sWzU0LDEwOSwwXSxbNywxMTksNF0sWzAsMTIxLDYxXSxbMCwxMTQsMTI1XSxbMCwwLDBdLFswLDAsMF0sWzAsMCwwXSwKICAgIFsyNTQsMjU0LDI1NV0sWzkzLDE3OSwyNTVdLFsxNDMsMTYxLDI1NV0sWzIwMCwxNDQsMjU1XSxbMjQ3LDEzMywyNTBdLFsyNTUsMTMxLDE5Ml0sWzI1NSwxMzksMTI3XSxbMjM5LDE1NCw3M10sWzE4OSwxNzIsNDRdLFsxMzMsMTg4LDQ3XSxbODUsMTk5LDgzXSxbNjAsMjAxLDE0MF0sWzYyLDE5NCwyMDVdLFs3OCw3OCw3OF0sWzAsMCwwXSxbMCwwLDBdLAogICAgWzI1NCwyNTQsMjU1XSxbMTg4LDIyMywyNTVdLFsyMDksMjE2LDI1NV0sWzIzMiwyMDksMjU1XSxbMjUxLDIwNSwyNTNdLFsyNTUsMjA0LDIyOV0sWzI1NSwyMDcsMjAyXSxbMjQ4LDIxMywxODBdLFsyMjgsMjIwLDE2OF0sWzIwNCwyMjcsMTY5XSxbMTg1LDIzMiwxODRdLFsxNzQsMjMyLDIwOF0sWzE3NSwyMjksMjM0XSxbMTgyLDE4MiwxODJdLFswLDAsMF0sWzAsMCwwXQogIF0KCn0K"></script>
  <script src="data:application/javascript;base64,CmZ1bmN0aW9uIEFwdShuZXMpIHsKCiAgLy8gbWVtb3J5IGhhbmRsZXIKICB0aGlzLm5lcyA9IG5lczsKCiAgLy8gZHV0eSBjeWNsZXMKICB0aGlzLmR1dHlDeWNsZXMgPSBbCiAgICBbMCwgMSwgMCwgMCwgMCwgMCwgMCwgMF0sCiAgICBbMCwgMSwgMSwgMCwgMCwgMCwgMCwgMF0sCiAgICBbMCwgMSwgMSwgMSwgMSwgMCwgMCwgMF0sCiAgICBbMSwgMCwgMCwgMSwgMSwgMSwgMSwgMV0KICBdOwogIC8vIGxlZ3RoIGNvdW50ZXIgbG9hZCB2YWx1ZXMKICB0aGlzLmxlbmd0aExvYWRWYWx1ZXMgPSBbCiAgICAxMCwgMjU0LCAyMCwgMiwgIDQwLCA0LCAgODAsIDYsICAxNjAsIDgsICA2MCwgMTAsIDE0LCAxMiwgMjYsIDE0LAogICAgMTIsIDE2LCAgMjQsIDE4LCA0OCwgMjAsIDk2LCAyMiwgMTkyLCAyNCwgNzIsIDI2LCAxNiwgMjgsIDMyLCAzMAogIF07CiAgLy8gdGlhbmdsZSBzdGVwcwogIHRoaXMudHJpYW5nbGVTdGVwcyA9IFsKICAgIDE1LCAxNCwgMTMsIDEyLCAxMSwgMTAsIDksIDgsIDcsIDYsIDUsICA0LCAgMywgIDIsICAxLCAgMCwKICAgIDAsICAxLCAgMiwgIDMsICA0LCAgNSwgIDYsIDcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUKICBdOwogIC8vIG5vaXNlIHRpbWVyIHZhbHVlcwogIHRoaXMubm9pc2VMb2FkVmFsdWVzID0gWwogICAgNCwgOCwgMTYsIDMyLCA2NCwgOTYsIDEyOCwgMTYwLCAyMDIsIDI1NCwgMzgwLCA1MDgsIDc2MiwgMTAxNiwgMjAzNCwgNDA2OAogIF07CiAgLy8gZG1jIHRpbWVyIHZhbHVlCiAgdGhpcy5kbWNMb2FkVmFsdWVzID0gWwogICAgNDI4LCAzODAsIDM0MCwgMzIwLCAyODYsIDI1NCwgMjI2LCAyMTQsIDE5MCwgMTYwLCAxNDIsIDEyOCwgMTA2LCA4NCwgNzIsIDU0CiAgXQoKICAvLyBjaGFubmVsIG91dHB1dHMKICB0aGlzLm91dHB1dCA9IG5ldyBGbG9hdDY0QXJyYXkoMjk3ODEpOwoKICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oKSB7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5vdXRwdXQubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5vdXRwdXRbaV0gPSAwOwogICAgfQoKICAgIHRoaXMub3V0cHV0T2Zmc2V0ID0gMDsKCiAgICB0aGlzLmZyYW1lQ291bnRlciA9IDA7CgogICAgdGhpcy5pbnRlcnJ1cHRJbmhpYml0ID0gZmFsc2U7CiAgICB0aGlzLnN0ZXA1TW9kZSA9IGZhbHNlOwoKICAgIHRoaXMuZW5hYmxlTm9pc2UgPSBmYWxzZTsKICAgIHRoaXMuZW5hYmxlVHJpYW5nbGUgPSBmYWxzZTsKICAgIHRoaXMuZW5hYmxlUHVsc2UyID0gZmFsc2U7CiAgICB0aGlzLmVuYWJsZVB1bHNlMSA9IGZhbHNlOwoKICAgIC8vIHB1bHNlIDEKICAgIHRoaXMucDFUaW1lciA9IDA7CiAgICB0aGlzLnAxVGltZXJWYWx1ZSA9IDA7CiAgICB0aGlzLnAxRHV0eSA9IDA7CiAgICB0aGlzLnAxRHV0eUluZGV4ID0gMDsKICAgIHRoaXMucDFPdXRwdXQgPSAwOwogICAgdGhpcy5wMUNvdW50ZXJIYWx0ID0gZmFsc2U7CiAgICB0aGlzLnAxQ291bnRlciA9IDA7CiAgICB0aGlzLnAxVm9sdW1lID0gMDsKICAgIHRoaXMucDFDb25zdGFudFZvbHVtZSA9IGZhbHNlOwogICAgdGhpcy5wMURlY2F5ID0gMDsKICAgIHRoaXMucDFFbnZlbG9wZUNvdW50ZXIgPSAwOwogICAgdGhpcy5wMUVudmVsb3BlU3RhcnQgPSBmYWxzZTsKICAgIHRoaXMucDFTd2VlcEVuYWJsZWQgPSBmYWxzZTsKICAgIHRoaXMucDFTd2VlcFBlcmlvZCA9IDA7CiAgICB0aGlzLnAxU3dlZXBOZWdhdGUgPSBmYWxzZTsKICAgIHRoaXMucDFTd2VlcFNoaWZ0ID0gMDsKICAgIHRoaXMucDFTd2VlcFRpbWVyID0gMDsKICAgIHRoaXMucDFTd2VlcFRhcmdldCA9IDA7CiAgICB0aGlzLnAxU3dlZXBNdXRpbmcgPSB0cnVlOwogICAgdGhpcy5wMVN3ZWVwUmVsb2FkID0gZmFsc2U7CgogICAgLy8gcHVsc2UgMgogICAgdGhpcy5wMlRpbWVyID0gMDsKICAgIHRoaXMucDJUaW1lclZhbHVlID0gMDsKICAgIHRoaXMucDJEdXR5ID0gMDsKICAgIHRoaXMucDJEdXR5SW5kZXggPSAwOwogICAgdGhpcy5wMk91dHB1dCA9IDA7CiAgICB0aGlzLnAyQ291bnRlckhhbHQgPSBmYWxzZTsKICAgIHRoaXMucDJDb3VudGVyID0gMDsKICAgIHRoaXMucDJWb2x1bWUgPSAwOwogICAgdGhpcy5wMkNvbnN0YW50Vm9sdW1lID0gZmFsc2U7CiAgICB0aGlzLnAyRGVjYXkgPSAwOwogICAgdGhpcy5wMkVudmVsb3BlQ291bnRlciA9IDA7CiAgICB0aGlzLnAyRW52ZWxvcGVTdGFydCA9IGZhbHNlOwogICAgdGhpcy5wMlN3ZWVwRW5hYmxlZCA9IGZhbHNlOwogICAgdGhpcy5wMlN3ZWVwUGVyaW9kID0gMDsKICAgIHRoaXMucDJTd2VlcE5lZ2F0ZSA9IGZhbHNlOwogICAgdGhpcy5wMlN3ZWVwU2hpZnQgPSAwOwogICAgdGhpcy5wMlN3ZWVwVGltZXIgPSAwOwogICAgdGhpcy5wMlN3ZWVwVGFyZ2V0ID0gMDsKICAgIHRoaXMucDJTd2VlcE11dGluZyA9IHRydWU7CiAgICB0aGlzLnAyU3dlZXBSZWxvYWQgPSBmYWxzZTsKCiAgICAvLyB0cmlhbmdsZQogICAgdGhpcy50cmlUaW1lciA9IDA7CiAgICB0aGlzLnRyaVRpbWVyVmFsdWUgPSAwOwogICAgdGhpcy50cmlTdGVwSW5kZXggPSAwOwogICAgdGhpcy50cmlPdXRwdXQgPSAwOwogICAgdGhpcy50cmlDb3VudGVySGFsdCA9IGZhbHNlOwogICAgdGhpcy50cmlDb3VudGVyID0gMDsKICAgIHRoaXMudHJpTGluZWFyQ291bnRlciA9IDA7CiAgICB0aGlzLnRyaVJlbG9hZExpbmVhciA9IGZhbHNlOwogICAgdGhpcy50cmlMaW5lYXJSZWxvYWQgPSAwOwoKICAgIC8vIG5vaXNlCiAgICB0aGlzLm5vaXNlVGltZXIgPSAwOwogICAgdGhpcy5ub2lzZVRpbWVyVmFsdWUgPSAwOwogICAgdGhpcy5ub2lzZVNoaWZ0ID0gMTsKICAgIHRoaXMubm9pc2VUb25hbCA9IGZhbHNlOwogICAgdGhpcy5ub2lzZU91dHB1dCA9IDA7CiAgICB0aGlzLm5vaXNlQ291bnRlckhhbHQgPSBmYWxzZTsKICAgIHRoaXMubm9pc2VDb3VudGVyID0gMDsKICAgIHRoaXMubm9pc2VWb2x1bWUgPSAwOwogICAgdGhpcy5ub2lzZUNvbnN0YW50Vm9sdW1lID0gZmFsc2U7CiAgICB0aGlzLm5vaXNlRGVjYXkgPSAwOwogICAgdGhpcy5ub2lzZUVudmVsb3BlQ291bnRlciA9IDA7CiAgICB0aGlzLm5vaXNlRW52ZWxvcGVTdGFydCA9IGZhbHNlOwoKICAgIC8vIGRtYwogICAgdGhpcy5kbWNJbnRlcnJ1cHQgPSBmYWxzZTsKICAgIHRoaXMuZG1jTG9vcCA9IGZhbHNlOwogICAgdGhpcy5kbWNUaW1lciA9IDA7CiAgICB0aGlzLmRtY1RpbWVyVmFsdWUgPSAwOwogICAgdGhpcy5kbWNPdXRwdXQgPSAwOwogICAgdGhpcy5kbWNTYW1wbGVBZGRyZXNzID0gMHhjMDAwOwogICAgdGhpcy5kbWNBZGRyZXNzID0gMHhjMDAwOwogICAgdGhpcy5kbWNTYW1wbGUgPSAwOwogICAgdGhpcy5kbWNTYW1wbGVMZW5ndGggPSAwOwogICAgdGhpcy5kbWNTYW1wbGVFbXB0eSA9IHRydWU7CiAgICB0aGlzLmRtY0J5dGVzTGVmdCA9IDA7CiAgICB0aGlzLmRtY1NoaWZ0ZXIgPSAwOwogICAgdGhpcy5kbWNCaXRzTGVmdCA9IDg7CiAgICB0aGlzLmRtY1NpbGVudCA9IHRydWU7CgogIH0KICB0aGlzLnJlc2V0KCk7CiAgdGhpcy5zYXZlVmFycyA9IFsKICAgICJmcmFtZUNvdW50ZXIiLCAiaW50ZXJydXB0SW5oaWJpdCIsICJzdGVwNU1vZGUiLCAiZW5hYmxlTm9pc2UiLAogICAgImVuYWJsZVRyaWFuZ2xlIiwgImVuYWJsZVB1bHNlMiIsICJlbmFibGVQdWxzZTEiLCAicDFUaW1lciIsICJwMVRpbWVyVmFsdWUiLAogICAgInAxRHV0eSIsICJwMUR1dHlJbmRleCIsICJwMU91dHB1dCIsICJwMUNvdW50ZXJIYWx0IiwgInAxQ291bnRlciIsCiAgICAicDFWb2x1bWUiLCAicDFDb25zdGFudFZvbHVtZSIsICJwMURlY2F5IiwgInAxRW52ZWxvcGVDb3VudGVyIiwKICAgICJwMUVudmVsb3BlU3RhcnQiLCAicDFTd2VlcEVuYWJsZWQiLCAicDFTd2VlcFBlcmlvZCIsICJwMVN3ZWVwTmVnYXRlIiwKICAgICJwMVN3ZWVwU2hpZnQiLCAicDFTd2VlcFRpbWVyIiwgInAxU3dlZXBUYXJnZXQiLCAicDFTd2VlcE11dGluZyIsCiAgICAicDFTd2VlcFJlbG9hZCIsICJwMlRpbWVyIiwgInAyVGltZXJWYWx1ZSIsICJwMkR1dHkiLCAicDJEdXR5SW5kZXgiLAogICAgInAyT3V0cHV0IiwgInAyQ291bnRlckhhbHQiLCAicDJDb3VudGVyIiwgInAyVm9sdW1lIiwgInAyQ29uc3RhbnRWb2x1bWUiLAogICAgInAyRGVjYXkiLCAicDJFbnZlbG9wZUNvdW50ZXIiLCAicDJFbnZlbG9wZVN0YXJ0IiwgInAyU3dlZXBFbmFibGVkIiwKICAgICJwMlN3ZWVwUGVyaW9kIiwgInAyU3dlZXBOZWdhdGUiLCAicDJTd2VlcFNoaWZ0IiwgInAyU3dlZXBUaW1lciIsCiAgICAicDJTd2VlcFRhcmdldCIsICJwMlN3ZWVwTXV0aW5nIiwgInAyU3dlZXBSZWxvYWQiLCAidHJpVGltZXIiLAogICAgInRyaVRpbWVyVmFsdWUiLCAidHJpU3RlcEluZGV4IiwgInRyaU91dHB1dCIsICJ0cmlDb3VudGVySGFsdCIsCiAgICAidHJpQ291bnRlciIsICJ0cmlMaW5lYXJDb3VudGVyIiwgInRyaVJlbG9hZExpbmVhciIsICJ0cmlMaW5lYXJSZWxvYWQiLAogICAgIm5vaXNlVGltZXIiLCAibm9pc2VUaW1lclZhbHVlIiwgIm5vaXNlU2hpZnQiLCAibm9pc2VUb25hbCIsICJub2lzZU91dHB1dCIsCiAgICAibm9pc2VDb3VudGVySGFsdCIsICJub2lzZUNvdW50ZXIiLCAibm9pc2VWb2x1bWUiLCAibm9pc2VDb25zdGFudFZvbHVtZSIsCiAgICAibm9pc2VEZWNheSIsICJub2lzZUVudmVsb3BlQ291bnRlciIsICJub2lzZUVudmVsb3BlU3RhcnQiLCAiZG1jSW50ZXJydXB0IiwKICAgICJkbWNMb29wIiwgImRtY1RpbWVyIiwgImRtY1RpbWVyVmFsdWUiLCAiZG1jT3V0cHV0IiwgImRtY1NhbXBsZUFkZHJlc3MiLAogICAgImRtY0FkZHJlc3MiLCAiZG1jU2FtcGxlIiwgImRtY1NhbXBsZUxlbmd0aCIsICJkbWNTYW1wbGVFbXB0eSIsCiAgICAiZG1jQnl0ZXNMZWZ0IiwgImRtY1NoaWZ0ZXIiLCAiZG1jQml0c0xlZnQiLCAiZG1jU2lsZW50IgogIF07CgogIHRoaXMuY3ljbGUgPSBmdW5jdGlvbigpIHsKICAgIGlmKAogICAgICAodGhpcy5mcmFtZUNvdW50ZXIgPT09IDI5ODMwICYmICF0aGlzLnN0ZXA1TW9kZSkgfHwKICAgICAgdGhpcy5mcmFtZUNvdW50ZXIgPT09IDM3MjgyCiAgICApIHsKICAgICAgdGhpcy5mcmFtZUNvdW50ZXIgPSAwOwogICAgfQogICAgdGhpcy5mcmFtZUNvdW50ZXIrKzsKCiAgICB0aGlzLmhhbmRsZUZyYW1lQ291bnRlcigpOwoKICAgIHRoaXMuY3ljbGVUcmlhbmdsZSgpOwogICAgdGhpcy5jeWNsZVB1bHNlMSgpOwogICAgdGhpcy5jeWNsZVB1bHNlMigpOwogICAgdGhpcy5jeWNsZU5vaXNlKCk7CiAgICB0aGlzLmN5Y2xlRG1jKCk7CgogICAgdGhpcy5vdXRwdXRbdGhpcy5vdXRwdXRPZmZzZXQrK10gPSB0aGlzLm1peCgpOwogICAgaWYodGhpcy5vdXRwdXRPZmZzZXQgPT09IDI5NzgxKSB7CiAgICAgIC8vIGlmIHdlIGFyZSBnb2luZyBwYXN0IHRoZSBidWZmZXIgKHRvbyBtYW55IGFwdSBjeWNsZXMgcGVyIGZyYW1lKQogICAgICB0aGlzLm91dHB1dE9mZnNldCA9IDI5NzgwOwogICAgfQogIH0KCiAgdGhpcy5jeWNsZVB1bHNlMSA9IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5wMVRpbWVyVmFsdWUgIT09IDApIHsKICAgICAgdGhpcy5wMVRpbWVyVmFsdWUtLTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDFUaW1lclZhbHVlID0gKHRoaXMucDFUaW1lciAqIDIpICsgMTsKICAgICAgdGhpcy5wMUR1dHlJbmRleCsrOwogICAgICB0aGlzLnAxRHV0eUluZGV4ICY9IDB4NzsKICAgIH0KICAgIGxldCBvdXRwdXQgPSB0aGlzLmR1dHlDeWNsZXNbdGhpcy5wMUR1dHldW3RoaXMucDFEdXR5SW5kZXhdOwogICAgaWYob3V0cHV0ID09PSAwIHx8IHRoaXMucDFTd2VlcE11dGluZyB8fCB0aGlzLnAxQ291bnRlciA9PT0gMCkgewogICAgICB0aGlzLnAxT3V0cHV0ID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDFPdXRwdXQgPSB0aGlzLnAxQ29uc3RhbnRWb2x1bWUgPyB0aGlzLnAxVm9sdW1lIDogdGhpcy5wMURlY2F5OwogICAgfQogIH0KCiAgdGhpcy5jeWNsZVB1bHNlMiA9IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5wMlRpbWVyVmFsdWUgIT09IDApIHsKICAgICAgdGhpcy5wMlRpbWVyVmFsdWUtLTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDJUaW1lclZhbHVlID0gKHRoaXMucDJUaW1lciAqIDIpICsgMTsKICAgICAgdGhpcy5wMkR1dHlJbmRleCsrOwogICAgICB0aGlzLnAyRHV0eUluZGV4ICY9IDB4NzsKICAgIH0KICAgIGxldCBvdXRwdXQgPSB0aGlzLmR1dHlDeWNsZXNbdGhpcy5wMkR1dHldW3RoaXMucDJEdXR5SW5kZXhdOwogICAgaWYob3V0cHV0ID09PSAwIHx8IHRoaXMucDJTd2VlcE11dGluZyB8fCB0aGlzLnAyQ291bnRlciA9PT0gMCkgewogICAgICB0aGlzLnAyT3V0cHV0ID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDJPdXRwdXQgPSB0aGlzLnAyQ29uc3RhbnRWb2x1bWUgPyB0aGlzLnAyVm9sdW1lIDogdGhpcy5wMkRlY2F5OwogICAgfQogIH0KCiAgdGhpcy5jeWNsZVRyaWFuZ2xlID0gZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLnRyaVRpbWVyVmFsdWUgIT09IDApIHsKICAgICAgdGhpcy50cmlUaW1lclZhbHVlLS07CiAgICB9IGVsc2UgewogICAgICB0aGlzLnRyaVRpbWVyVmFsdWUgPSB0aGlzLnRyaVRpbWVyOwogICAgICBpZih0aGlzLnRyaUNvdW50ZXIgIT09IDAgJiYgdGhpcy50cmlMaW5lYXJDb3VudGVyICE9PSAwKSB7CiAgICAgICAgdGhpcy50cmlPdXRwdXQgPSB0aGlzLnRyaWFuZ2xlU3RlcHNbdGhpcy50cmlTdGVwSW5kZXgrK107CiAgICAgICAgaWYodGhpcy50cmlUaW1lciA8IDIpIHsKICAgICAgICAgIC8vIHVsdHJhc29uaWMKICAgICAgICAgIHRoaXMudHJpT3V0cHV0ID0gNy41OwogICAgICAgIH0KICAgICAgICB0aGlzLnRyaVN0ZXBJbmRleCAmPSAweDFmOwogICAgICB9CiAgICB9CiAgfQoKICB0aGlzLmN5Y2xlTm9pc2UgPSBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMubm9pc2VUaW1lclZhbHVlICE9PSAwKSB7CiAgICAgIHRoaXMubm9pc2VUaW1lclZhbHVlLS07CiAgICB9IGVsc2UgewogICAgICB0aGlzLm5vaXNlVGltZXJWYWx1ZSA9IHRoaXMubm9pc2VUaW1lcjsKICAgICAgbGV0IGZlZWRiYWNrID0gdGhpcy5ub2lzZVNoaWZ0ICYgMHgxOwogICAgICBpZih0aGlzLm5vaXNlVG9uYWwpIHsKICAgICAgICBmZWVkYmFjayBePSAodGhpcy5ub2lzZVNoaWZ0ICYgMHg0MCkgPj4gNjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmZWVkYmFjayBePSAodGhpcy5ub2lzZVNoaWZ0ICYgMHgyKSA+PiAxOwogICAgICB9CiAgICAgIHRoaXMubm9pc2VTaGlmdCA+Pj0gMTsKICAgICAgdGhpcy5ub2lzZVNoaWZ0IHw9IGZlZWRiYWNrIDw8IDE0OwogICAgfQogICAgaWYodGhpcy5ub2lzZUNvdW50ZXIgPT09IDAgfHwgKHRoaXMubm9pc2VTaGlmdCAmIDB4MSkgPT09IDEpIHsKICAgICAgdGhpcy5ub2lzZU91dHB1dCA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLm5vaXNlT3V0cHV0ID0gKAogICAgICAgIHRoaXMubm9pc2VDb25zdGFudFZvbHVtZSA/IHRoaXMubm9pc2VWb2x1bWUgOiB0aGlzLm5vaXNlRGVjYXkKICAgICAgKTsKICAgIH0KICB9CgogIHRoaXMuY3ljbGVEbWMgPSBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuZG1jVGltZXJWYWx1ZSAhPT0gMCkgewogICAgICB0aGlzLmRtY1RpbWVyVmFsdWUtLTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZG1jVGltZXJWYWx1ZSA9IHRoaXMuZG1jVGltZXI7CiAgICAgIGlmKCF0aGlzLmRtY1NpbGVudCkgewogICAgICAgIGlmKCh0aGlzLmRtY1NoaWZ0ZXIgJiAweDEpID09PSAwKSB7CiAgICAgICAgICBpZih0aGlzLmRtY091dHB1dCA+PSAyKSB7CiAgICAgICAgICAgIHRoaXMuZG1jT3V0cHV0IC09IDI7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKHRoaXMuZG1jT3V0cHV0IDw9IDEyNSkgewogICAgICAgICAgICB0aGlzLmRtY091dHB1dCArPSAyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmRtY1NoaWZ0ZXIgPj49IDE7CiAgICAgIHRoaXMuZG1jQml0c0xlZnQtLTsKICAgICAgaWYodGhpcy5kbWNCaXRzTGVmdCA9PT0gMCkgewogICAgICAgIHRoaXMuZG1jQml0c0xlZnQgPSA4OwogICAgICAgIGlmKHRoaXMuZG1jU2FtcGxlRW1wdHkpIHsKICAgICAgICAgIHRoaXMuZG1jU2lsZW50ID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5kbWNTaWxlbnQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZG1jU2hpZnRlciA9IHRoaXMuZG1jU2FtcGxlOwogICAgICAgICAgdGhpcy5kbWNTYW1wbGVFbXB0eSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZih0aGlzLmRtY0J5dGVzTGVmdCA+IDAgJiYgdGhpcy5kbWNTYW1wbGVFbXB0eSkgewogICAgICB0aGlzLmRtY1NhbXBsZUVtcHR5ID0gZmFsc2U7CiAgICAgIHRoaXMuZG1jU2FtcGxlID0gdGhpcy5uZXMucmVhZCh0aGlzLmRtY0FkZHJlc3MpOwogICAgICB0aGlzLmRtY0FkZHJlc3MrKzsKICAgICAgaWYodGhpcy5kbWNBZGRyZXNzID09PSAweDEwMDAwKSB7CiAgICAgICAgdGhpcy5kbWNBZGRyZXNzID0gMHg4MDAwOwogICAgICB9CiAgICAgIHRoaXMuZG1jQnl0ZXNMZWZ0LS07CiAgICAgIGlmKHRoaXMuZG1jQnl0ZXNMZWZ0ID09PSAwICYmIHRoaXMuZG1jTG9vcCkgewogICAgICAgIHRoaXMuZG1jQnl0ZXNMZWZ0ID0gdGhpcy5kbWNTYW1wbGVMZW5ndGg7CiAgICAgICAgdGhpcy5kbWNBZGRyZXNzID0gdGhpcy5kbWNTYW1wbGVBZGRyZXNzOwogICAgICB9IGVsc2UgaWYodGhpcy5kbWNCeXRlc0xlZnQgPT09IDAgJiYgdGhpcy5kbWNJbnRlcnJ1cHQpIHsKICAgICAgICB0aGlzLm5lcy5kbWNJcnFXYW50ZWQgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfQoKICB0aGlzLnVwZGF0ZVN3ZWVwUDEgPSBmdW5jdGlvbigpIHsKICAgIGxldCBjaGFuZ2UgPSB0aGlzLnAxVGltZXIgPj4gdGhpcy5wMVN3ZWVwU2hpZnQ7CiAgICBpZih0aGlzLnAxU3dlZXBOZWdhdGUpIHsKICAgICAgY2hhbmdlID0gKC1jaGFuZ2UpIC0gMTsKICAgIH0KICAgIHRoaXMucDFTd2VlcFRhcmdldCA9IHRoaXMucDFUaW1lciArIGNoYW5nZTsKICAgIGlmKHRoaXMucDFTd2VlcFRhcmdldCA+IDB4N2ZmIHx8IHRoaXMucDFUaW1lciA8IDgpIHsKICAgICAgdGhpcy5wMVN3ZWVwTXV0aW5nID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDFTd2VlcE11dGluZyA9IGZhbHNlOwogICAgfQogIH0KCiAgdGhpcy51cGRhdGVTd2VlcFAyID0gZnVuY3Rpb24oKSB7CiAgICBsZXQgY2hhbmdlID0gdGhpcy5wMlRpbWVyID4+IHRoaXMucDJTd2VlcFNoaWZ0OwogICAgaWYodGhpcy5wMlN3ZWVwTmVnYXRlKSB7CiAgICAgIGNoYW5nZSA9ICgtY2hhbmdlKTsKICAgIH0KICAgIHRoaXMucDJTd2VlcFRhcmdldCA9IHRoaXMucDJUaW1lciArIGNoYW5nZTsKICAgIGlmKHRoaXMucDJTd2VlcFRhcmdldCA+IDB4N2ZmIHx8IHRoaXMucDJUaW1lciA8IDgpIHsKICAgICAgdGhpcy5wMlN3ZWVwTXV0aW5nID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDJTd2VlcE11dGluZyA9IGZhbHNlOwogICAgfQogIH0KCiAgdGhpcy5jbG9ja1F1YXJ0ZXIgPSBmdW5jdGlvbigpIHsKICAgIC8vIGhhbmRsZSB0cmlhbmdsZSBsaW5lYXIgY291bnRlcgogICAgaWYodGhpcy50cmlSZWxvYWRMaW5lYXIpIHsKICAgICAgdGhpcy50cmlMaW5lYXJDb3VudGVyID0gdGhpcy50cmlMaW5lYXJSZWxvYWQ7CiAgICB9IGVsc2UgaWYodGhpcy50cmlMaW5lYXJDb3VudGVyICE9PSAwKSB7CiAgICAgIHRoaXMudHJpTGluZWFyQ291bnRlci0tOwogICAgfQogICAgaWYoIXRoaXMudHJpQ291bnRlckhhbHQpIHsKICAgICAgdGhpcy50cmlSZWxvYWRMaW5lYXIgPSBmYWxzZTsKICAgIH0KICAgIC8vIGhhbmRsZSBlbnZlbG9wZXMKICAgIGlmKCF0aGlzLnAxRW52ZWxvcGVTdGFydCkgewogICAgICBpZih0aGlzLnAxRW52ZWxvcGVDb3VudGVyICE9PSAwKSB7CiAgICAgICAgdGhpcy5wMUVudmVsb3BlQ291bnRlci0tOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucDFFbnZlbG9wZUNvdW50ZXIgPSB0aGlzLnAxVm9sdW1lOwogICAgICAgIGlmKHRoaXMucDFEZWNheSAhPT0gMCkgewogICAgICAgICAgdGhpcy5wMURlY2F5LS07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKHRoaXMucDFDb3VudGVySGFsdCkgewogICAgICAgICAgICB0aGlzLnAxRGVjYXkgPSAxNTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucDFFbnZlbG9wZVN0YXJ0ID0gZmFsc2U7CiAgICAgIHRoaXMucDFEZWNheSA9IDE1OwogICAgICB0aGlzLnAxRW52ZWxvcGVDb3VudGVyID0gdGhpcy5wMVZvbHVtZTsKICAgIH0KCiAgICBpZighdGhpcy5wMkVudmVsb3BlU3RhcnQpIHsKICAgICAgaWYodGhpcy5wMkVudmVsb3BlQ291bnRlciAhPT0gMCkgewogICAgICAgIHRoaXMucDJFbnZlbG9wZUNvdW50ZXItLTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnAyRW52ZWxvcGVDb3VudGVyID0gdGhpcy5wMlZvbHVtZTsKICAgICAgICBpZih0aGlzLnAyRGVjYXkgIT09IDApIHsKICAgICAgICAgIHRoaXMucDJEZWNheS0tOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZih0aGlzLnAyQ291bnRlckhhbHQpIHsKICAgICAgICAgICAgdGhpcy5wMkRlY2F5ID0gMTU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLnAyRW52ZWxvcGVTdGFydCA9IGZhbHNlOwogICAgICB0aGlzLnAyRGVjYXkgPSAxNTsKICAgICAgdGhpcy5wMkVudmVsb3BlQ291bnRlciA9IHRoaXMucDJWb2x1bWU7CiAgICB9CgogICAgaWYoIXRoaXMubm9pc2VFbnZlbG9wZVN0YXJ0KSB7CiAgICAgIGlmKHRoaXMubm9pc2VFbnZlbG9wZUNvdW50ZXIgIT09IDApIHsKICAgICAgICB0aGlzLm5vaXNlRW52ZWxvcGVDb3VudGVyLS07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5ub2lzZUVudmVsb3BlQ291bnRlciA9IHRoaXMubm9pc2VWb2x1bWU7CiAgICAgICAgaWYodGhpcy5ub2lzZURlY2F5ICE9PSAwKSB7CiAgICAgICAgICB0aGlzLm5vaXNlRGVjYXktLTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYodGhpcy5ub2lzZUNvdW50ZXJIYWx0KSB7CiAgICAgICAgICAgIHRoaXMubm9pc2VEZWNheSA9IDE1OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ub2lzZUVudmVsb3BlU3RhcnQgPSBmYWxzZTsKICAgICAgdGhpcy5ub2lzZURlY2F5ID0gMTU7CiAgICAgIHRoaXMubm9pc2VFbnZlbG9wZUNvdW50ZXIgPSB0aGlzLm5vaXNlVm9sdW1lOwogICAgfQogIH0KCiAgdGhpcy5jbG9ja0hhbGYgPSBmdW5jdGlvbigpIHsKICAgIC8vIGRlY3JlbWVudCBsZW5ndGggY291bnRlcnMKICAgIGlmKCF0aGlzLnAxQ291bnRlckhhbHQgJiYgdGhpcy5wMUNvdW50ZXIgIT09IDApIHsKICAgICAgdGhpcy5wMUNvdW50ZXItLTsKICAgIH0KICAgIGlmKCF0aGlzLnAyQ291bnRlckhhbHQgJiYgdGhpcy5wMkNvdW50ZXIgIT09IDApIHsKICAgICAgdGhpcy5wMkNvdW50ZXItLTsKICAgIH0KICAgIGlmKCF0aGlzLnRyaUNvdW50ZXJIYWx0ICYmIHRoaXMudHJpQ291bnRlciAhPT0gMCkgewogICAgICB0aGlzLnRyaUNvdW50ZXItLTsKICAgIH0KICAgIGlmKCF0aGlzLm5vaXNlQ291bnRlckhhbHQgJiYgdGhpcy5ub2lzZUNvdW50ZXIgIT09IDApIHsKICAgICAgdGhpcy5ub2lzZUNvdW50ZXItLTsKICAgIH0KICAgIC8vIGhhbmRsZSBzd2VlcHMKICAgIGlmKAogICAgICB0aGlzLnAxU3dlZXBUaW1lciA9PT0gMCAmJiB0aGlzLnAxU3dlZXBFbmFibGVkICYmCiAgICAgICF0aGlzLnAxU3dlZXBNdXRpbmcgJiYgdGhpcy5wMVN3ZWVwU2hpZnQgPiAwCiAgICApIHsKICAgICAgdGhpcy5wMVRpbWVyID0gdGhpcy5wMVN3ZWVwVGFyZ2V0OwogICAgICB0aGlzLnVwZGF0ZVN3ZWVwUDEoKTsKICAgIH0KICAgIGlmKHRoaXMucDFTd2VlcFRpbWVyID09PSAwIHx8IHRoaXMucDFTd2VlcFJlbG9hZCkgewogICAgICB0aGlzLnAxU3dlZXBUaW1lciA9IHRoaXMucDFTd2VlcFBlcmlvZDsKICAgICAgdGhpcy5wMVN3ZWVwUmVsb2FkID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnAxU3dlZXBUaW1lci0tOwogICAgfQoKICAgIGlmKAogICAgICB0aGlzLnAyU3dlZXBUaW1lciA9PT0gMCAmJiB0aGlzLnAyU3dlZXBFbmFibGVkICYmCiAgICAgICF0aGlzLnAyU3dlZXBNdXRpbmcgJiYgdGhpcy5wMlN3ZWVwU2hpZnQgPiAwCiAgICApIHsKICAgICAgdGhpcy5wMlRpbWVyID0gdGhpcy5wMlN3ZWVwVGFyZ2V0OwogICAgICB0aGlzLnVwZGF0ZVN3ZWVwUDIoKTsKICAgIH0KICAgIGlmKHRoaXMucDJTd2VlcFRpbWVyID09PSAwIHx8IHRoaXMucDJTd2VlcFJlbG9hZCkgewogICAgICB0aGlzLnAyU3dlZXBUaW1lciA9IHRoaXMucDJTd2VlcFBlcmlvZDsKICAgICAgdGhpcy5wMlN3ZWVwUmVsb2FkID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnAyU3dlZXBUaW1lci0tOwogICAgfQogIH0KCiAgdGhpcy5taXggPSBmdW5jdGlvbigpIHsKICAgIC8vIGZyb20gaHR0cHM6Ly93aWtpLm5lc2Rldi5jb20vdy9pbmRleC5waHAvQVBVX01peGVyCiAgICBsZXQgdG5kID0gKAogICAgICAwLjAwODUxICogdGhpcy50cmlPdXRwdXQgKwogICAgICAwLjAwNDk0ICogdGhpcy5ub2lzZU91dHB1dCArCiAgICAgIDAuMDAzMzUgKiB0aGlzLmRtY091dHB1dAogICAgKTsKICAgIGxldCBwdWxzZSA9IDAuMDA3NTIgKiAodGhpcy5wMU91dHB1dCArIHRoaXMucDJPdXRwdXQpOwogICAgcmV0dXJuIHRuZCArIHB1bHNlOwogIH0KCiAgdGhpcy5oYW5kbGVGcmFtZUNvdW50ZXIgPSBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuZnJhbWVDb3VudGVyID09PSA3NDU3KSB7CiAgICAgIHRoaXMuY2xvY2tRdWFydGVyKCk7CiAgICB9IGVsc2UgaWYodGhpcy5mcmFtZUNvdW50ZXIgPT09IDE0OTEzKSB7CiAgICAgIHRoaXMuY2xvY2tRdWFydGVyKCk7CiAgICAgIHRoaXMuY2xvY2tIYWxmKCk7CiAgICB9IGVsc2UgaWYodGhpcy5mcmFtZUNvdW50ZXIgPT09IDIyMzcxKSB7CiAgICAgIHRoaXMuY2xvY2tRdWFydGVyKCk7CiAgICB9IGVsc2UgaWYodGhpcy5mcmFtZUNvdW50ZXIgPT09IDI5ODI5ICYmICF0aGlzLnN0ZXA1TW9kZSkgewogICAgICB0aGlzLmNsb2NrUXVhcnRlcigpOwogICAgICB0aGlzLmNsb2NrSGFsZigpOwogICAgICBpZighdGhpcy5pbnRlcnJ1cHRJbmhpYml0KSB7CiAgICAgICAgdGhpcy5uZXMuZnJhbWVJcnFXYW50ZWQgPSB0cnVlOwogICAgICB9CiAgICB9IGVsc2UgaWYodGhpcy5mcmFtZUNvdW50ZXIgPT09IDM3MjgxKSB7CiAgICAgIHRoaXMuY2xvY2tRdWFydGVyKCk7CiAgICAgIHRoaXMuY2xvY2tIYWxmKCk7CiAgICB9CiAgfQoKICB0aGlzLmdldE91dHB1dCA9IGZ1bmN0aW9uKCkgewogICAgbGV0IHJldCA9IFt0aGlzLm91dHB1dE9mZnNldCwgdGhpcy5vdXRwdXRdOwogICAgdGhpcy5vdXRwdXRPZmZzZXQgPSAwOwogICAgcmV0dXJuIHJldDsKICB9CgogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgaWYoYWRyID09PSAweDQwMTUpIHsKICAgICAgbGV0IHJldCA9IDA7CiAgICAgIHJldCB8PSAodGhpcy5wMUNvdW50ZXIgPiAwKSA/IDB4MSA6IDA7CiAgICAgIHJldCB8PSAodGhpcy5wMkNvdW50ZXIgPiAwKSA/IDB4MiA6IDA7CiAgICAgIHJldCB8PSAodGhpcy50cmlDb3VudGVyID4gMCkgPyAweDQgOiAwOwogICAgICByZXQgfD0gKHRoaXMubm9pc2VDb3VudGVyID4gMCkgPyAweDggOiAwOwogICAgICByZXQgfD0gKHRoaXMuZG1jQnl0ZXNMZWZ0ID4gMCkgPyAweDEwIDogMDsKICAgICAgcmV0IHw9IHRoaXMubmVzLmZyYW1lSXJxV2FudGVkID8gMHg0MCA6IDA7CiAgICAgIHJldCB8PSB0aGlzLm5lcy5kbWNJcnFXYW50ZWQgPyAweDgwIDogMDsKICAgICAgcmV0dXJuIHJldDsKICAgIH0KICAgIHJldHVybiAwOwogIH0KCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBpZihhZHIgPT09IDB4NDAxNSkgewogICAgICBsZXQgcmV0ID0gMDsKICAgICAgcmV0IHw9ICh0aGlzLnAxQ291bnRlciA+IDApID8gMHgxIDogMDsKICAgICAgcmV0IHw9ICh0aGlzLnAyQ291bnRlciA+IDApID8gMHgyIDogMDsKICAgICAgcmV0IHw9ICh0aGlzLnRyaUNvdW50ZXIgPiAwKSA/IDB4NCA6IDA7CiAgICAgIHJldCB8PSAodGhpcy5ub2lzZUNvdW50ZXIgPiAwKSA/IDB4OCA6IDA7CiAgICAgIHJldCB8PSAodGhpcy5kbWNCeXRlc0xlZnQgPiAwKSA/IDB4MTAgOiAwOwogICAgICByZXQgfD0gdGhpcy5uZXMuZnJhbWVJcnFXYW50ZWQgPyAweDQwIDogMDsKICAgICAgcmV0IHw9IHRoaXMubmVzLmRtY0lycVdhbnRlZCA/IDB4ODAgOiAwOwogICAgICB0aGlzLm5lcy5mcmFtZUlycVdhbnRlZCA9IGZhbHNlOwogICAgICByZXR1cm4gcmV0OwogICAgfQogICAgcmV0dXJuIDA7CiAgfQoKICB0aGlzLndyaXRlID0gZnVuY3Rpb24oYWRyLCB2YWx1ZSkgewogICAgc3dpdGNoKGFkcikgewogICAgICBjYXNlIDB4NDAwMDogewogICAgICAgIHRoaXMucDFEdXR5ID0gKHZhbHVlICYgMHhjMCkgPj4gNjsKICAgICAgICB0aGlzLnAxVm9sdW1lID0gdmFsdWUgJiAweGY7CiAgICAgICAgdGhpcy5wMUNvdW50ZXJIYWx0ID0gKHZhbHVlICYgMHgyMCkgPiAwOwogICAgICAgIHRoaXMucDFDb25zdGFudFZvbHVtZSA9ICh2YWx1ZSAmIDB4MTApID4gMDsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDB4NDAwMTogewogICAgICAgIHRoaXMucDFTd2VlcEVuYWJsZWQgPSAodmFsdWUgJiAweDgwKSA+IDA7CiAgICAgICAgdGhpcy5wMVN3ZWVwUGVyaW9kID0gKHZhbHVlICYgMHg3MCkgPj4gNDsKICAgICAgICB0aGlzLnAxU3dlZXBOZWdhdGUgPSAodmFsdWUgJiAweDA4KSA+IDA7CiAgICAgICAgdGhpcy5wMVN3ZWVwU2hpZnQgPSB2YWx1ZSAmIDB4NzsKICAgICAgICB0aGlzLnAxU3dlZXBSZWxvYWQgPSB0cnVlOwogICAgICAgIHRoaXMudXBkYXRlU3dlZXBQMSgpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDAyOiB7CiAgICAgICAgdGhpcy5wMVRpbWVyICY9IDB4NzAwOwogICAgICAgIHRoaXMucDFUaW1lciB8PSB2YWx1ZTsKICAgICAgICB0aGlzLnVwZGF0ZVN3ZWVwUDEoKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDB4NDAwMzogewogICAgICAgIHRoaXMucDFUaW1lciAmPSAweGZmOwogICAgICAgIHRoaXMucDFUaW1lciB8PSAodmFsdWUgJiAweDcpIDw8IDg7CiAgICAgICAgdGhpcy5wMUR1dHlJbmRleCA9IDA7CiAgICAgICAgaWYodGhpcy5lbmFibGVQdWxzZTEpIHsKICAgICAgICAgIHRoaXMucDFDb3VudGVyID0gdGhpcy5sZW5ndGhMb2FkVmFsdWVzWyh2YWx1ZSAmIDB4ZjgpID4+IDNdOwogICAgICAgIH0KICAgICAgICB0aGlzLnAxRW52ZWxvcGVTdGFydCA9IHRydWU7CiAgICAgICAgdGhpcy51cGRhdGVTd2VlcFAxKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMDQ6IHsKICAgICAgICB0aGlzLnAyRHV0eSA9ICh2YWx1ZSAmIDB4YzApID4+IDY7CiAgICAgICAgdGhpcy5wMlZvbHVtZSA9IHZhbHVlICYgMHhmOwogICAgICAgIHRoaXMucDJDb3VudGVySGFsdCA9ICh2YWx1ZSAmIDB4MjApID4gMDsKICAgICAgICB0aGlzLnAyQ29uc3RhbnRWb2x1bWUgPSAodmFsdWUgJiAweDEwKSA+IDA7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMDU6IHsKICAgICAgICB0aGlzLnAyU3dlZXBFbmFibGVkID0gKHZhbHVlICYgMHg4MCkgPiAwOwogICAgICAgIHRoaXMucDJTd2VlcFBlcmlvZCA9ICh2YWx1ZSAmIDB4NzApID4+IDQ7CiAgICAgICAgdGhpcy5wMlN3ZWVwTmVnYXRlID0gKHZhbHVlICYgMHgwOCkgPiAwOwogICAgICAgIHRoaXMucDJTd2VlcFNoaWZ0ID0gdmFsdWUgJiAweDc7CiAgICAgICAgdGhpcy5wMlN3ZWVwUmVsb2FkID0gdHJ1ZTsKICAgICAgICB0aGlzLnVwZGF0ZVN3ZWVwUDIoKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDB4NDAwNjogewogICAgICAgIHRoaXMucDJUaW1lciAmPSAweDcwMDsKICAgICAgICB0aGlzLnAyVGltZXIgfD0gdmFsdWU7CiAgICAgICAgdGhpcy51cGRhdGVTd2VlcFAyKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMDc6IHsKICAgICAgICB0aGlzLnAyVGltZXIgJj0gMHhmZjsKICAgICAgICB0aGlzLnAyVGltZXIgfD0gKHZhbHVlICYgMHg3KSA8PCA4OwogICAgICAgIHRoaXMucDJEdXR5SW5kZXggPSAwOwogICAgICAgIGlmKHRoaXMuZW5hYmxlUHVsc2UyKSB7CiAgICAgICAgICB0aGlzLnAyQ291bnRlciA9IHRoaXMubGVuZ3RoTG9hZFZhbHVlc1sodmFsdWUgJiAweGY4KSA+PiAzXTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wMkVudmVsb3BlU3RhcnQgPSB0cnVlOwogICAgICAgIHRoaXMudXBkYXRlU3dlZXBQMigpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDA4OiB7CiAgICAgICAgdGhpcy50cmlDb3VudGVySGFsdCA9ICh2YWx1ZSAmIDB4ODApID4gMDsKICAgICAgICB0aGlzLnRyaUxpbmVhclJlbG9hZCA9IHZhbHVlICYgMHg3ZjsKCiAgICAgICAgLy8gbG9va3MgbGlrZSB0aGlzIGlzIGEgbWlzdGFrZSBpbiB0aGUgbmVzZGV2IHdpa2k/CiAgICAgICAgLy8gaHR0cDovL2ZvcnVtcy5uZXNkZXYuY29tL3ZpZXd0b3BpYy5waHA/Zj0zJnQ9MTM3NjcjcDE2MzE1NQogICAgICAgIC8vIGRvZXNuJ3QgZG8gdGhpcywgbmVpdGhlciBkb2VzIE1lc2VuLAogICAgICAgIC8vIGFuZCBkb2luZyBpdCBicmVha3MgU3VwZXIgTWFyaW8gQnJvcy4gMidzIHRyaWFuZ2xlIGJldHdlZW4gbm90ZXMKCiAgICAgICAgLy8gdGhpcy50cmlSZWxvYWRMaW5lYXIgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDBhOiB7CiAgICAgICAgdGhpcy50cmlUaW1lciAmPSAweDcwMDsKICAgICAgICB0aGlzLnRyaVRpbWVyIHw9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDBiOiB7CiAgICAgICAgdGhpcy50cmlUaW1lciAmPSAweGZmOwogICAgICAgIHRoaXMudHJpVGltZXIgfD0gKHZhbHVlICYgMHg3KSA8PCA4OwogICAgICAgIGlmKHRoaXMuZW5hYmxlVHJpYW5nbGUpIHsKICAgICAgICAgIHRoaXMudHJpQ291bnRlciA9IHRoaXMubGVuZ3RoTG9hZFZhbHVlc1sodmFsdWUgJiAweGY4KSA+PiAzXTsKICAgICAgICB9CiAgICAgICAgdGhpcy50cmlSZWxvYWRMaW5lYXIgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDBjOiB7CiAgICAgICAgdGhpcy5ub2lzZUNvdW50ZXJIYWx0ID0gKHZhbHVlICYgMHgyMCkgPiAwOwogICAgICAgIHRoaXMubm9pc2VDb25zdGFudFZvbHVtZSA9ICh2YWx1ZSAmIDB4MTApID4gMDsKICAgICAgICB0aGlzLm5vaXNlVm9sdW1lID0gdmFsdWUgJiAweGY7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMGU6IHsKICAgICAgICB0aGlzLm5vaXNlVG9uYWwgPSAodmFsdWUgJiAweDgwKSA+IDA7CiAgICAgICAgdGhpcy5ub2lzZVRpbWVyID0gdGhpcy5ub2lzZUxvYWRWYWx1ZXNbdmFsdWUgJiAweGZdIC0gMTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBjYXNlIDB4NDAwZjogewogICAgICAgIGlmKHRoaXMuZW5hYmxlTm9pc2UpIHsKICAgICAgICAgIHRoaXMubm9pc2VDb3VudGVyID0gdGhpcy5sZW5ndGhMb2FkVmFsdWVzWyh2YWx1ZSAmIDB4ZjgpID4+IDNdOwogICAgICAgIH0KICAgICAgICB0aGlzLm5vaXNlRW52ZWxvcGVTdGFydCA9IHRydWU7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMTA6IHsKICAgICAgICB0aGlzLmRtY0ludGVycnVwdCA9ICh2YWx1ZSAmIDB4ODApID4gMDsKICAgICAgICB0aGlzLmRtY0xvb3AgPSAodmFsdWUgJiAweDQwKSA+IDA7CiAgICAgICAgdGhpcy5kbWNUaW1lciA9IHRoaXMuZG1jTG9hZFZhbHVlc1t2YWx1ZSAmIDB4Zl0gLSAxOwogICAgICAgIGlmKCF0aGlzLmRtY0ludGVycnVwdCkgewogICAgICAgICAgdGhpcy5uZXMuZG1jSXJxV2FudGVkID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UgMHg0MDExOiB7CiAgICAgICAgdGhpcy5kbWNPdXRwdXQgPSB2YWx1ZSAmIDB4N2Y7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMTI6IHsKICAgICAgICB0aGlzLmRtY1NhbXBsZUFkZHJlc3MgPSAweGMwMDAgfCAodmFsdWUgPDwgNik7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMTM6IHsKICAgICAgICB0aGlzLmRtY1NhbXBsZUxlbmd0aCA9ICh2YWx1ZSA8PCA0KSArIDE7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMTU6IHsKICAgICAgICB0aGlzLmVuYWJsZU5vaXNlID0gKHZhbHVlICYgMHgwOCkgPiAwOwogICAgICAgIHRoaXMuZW5hYmxlVHJpYW5nbGUgPSAodmFsdWUgJiAweDA0KSA+IDA7CiAgICAgICAgdGhpcy5lbmFibGVQdWxzZTIgPSAodmFsdWUgJiAweDAyKSA+IDA7CiAgICAgICAgdGhpcy5lbmFibGVQdWxzZTEgPSAodmFsdWUgJiAweDAxKSA+IDA7CiAgICAgICAgaWYoIXRoaXMuZW5hYmxlUHVsc2UxKSB7CiAgICAgICAgICB0aGlzLnAxQ291bnRlciA9IDA7CiAgICAgICAgfQogICAgICAgIGlmKCF0aGlzLmVuYWJsZVB1bHNlMikgewogICAgICAgICAgdGhpcy5wMkNvdW50ZXIgPSAwOwogICAgICAgIH0KICAgICAgICBpZighdGhpcy5lbmFibGVUcmlhbmdsZSkgewogICAgICAgICAgdGhpcy50cmlDb3VudGVyID0gMDsKICAgICAgICB9CiAgICAgICAgaWYoIXRoaXMuZW5hYmxlTm9pc2UpIHsKICAgICAgICAgIHRoaXMubm9pc2VDb3VudGVyID0gMDsKICAgICAgICB9CiAgICAgICAgaWYoKHZhbHVlICYgMHgxMCkgPiAwKSB7CiAgICAgICAgICBpZih0aGlzLmRtY0J5dGVzTGVmdCA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmRtY0J5dGVzTGVmdCA9IHRoaXMuZG1jU2FtcGxlTGVuZ3RoOwogICAgICAgICAgICB0aGlzLmRtY0FkZHJlc3MgPSB0aGlzLmRtY1NhbXBsZUFkZHJlc3M7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZG1jQnl0ZXNMZWZ0ID0gMDsKICAgICAgICB9CiAgICAgICAgdGhpcy5uZXMuZG1jSXJxV2FudGVkID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgY2FzZSAweDQwMTc6IHsKICAgICAgICB0aGlzLnN0ZXA1TW9kZSA9ICh2YWx1ZSAmIDB4ODApID4gMDsKICAgICAgICB0aGlzLmludGVycnVwdEluaGliaXQgPSAodmFsdWUgJiAweDQwKSA+IDA7CiAgICAgICAgaWYodGhpcy5pbnRlcnJ1cHRJbmhpYml0KSB7CiAgICAgICAgICB0aGlzLm5lcy5mcmFtZUlycVdhbnRlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICB0aGlzLmZyYW1lQ291bnRlciA9IDA7CiAgICAgICAgaWYodGhpcy5zdGVwNU1vZGUpIHsKICAgICAgICAgIHRoaXMuY2xvY2tRdWFydGVyKCk7CiAgICAgICAgICB0aGlzLmNsb2NrSGFsZigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgICBkZWZhdWx0OiB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9Cn0K"></script>
  <script src="data:application/javascript;base64,CmZ1bmN0aW9uIE5lcygpIHsKCiAgLy8gc3RhdGUgdmVyc2lvbiwgZm9yIHNhdmVzdGF0ZXMKICB0aGlzLnN0YXRlVmVyc2lvbiA9IDE7CiAgLy8gcmFtCiAgdGhpcy5yYW0gPSBuZXcgVWludDhBcnJheSgweDgwMCk7CiAgLy8gY3B1CiAgdGhpcy5jcHUgPSBuZXcgQ3B1KHRoaXMpOwogIC8vIHBwdQogIHRoaXMucHB1ID0gbmV3IFBwdSh0aGlzKTsKICAvLyBhcHUKICB0aGlzLmFwdSA9IG5ldyBBcHUodGhpcyk7CiAgLy8gbWFwcGVyIC8gcm9tCiAgdGhpcy5tYXBwZXI7CgogIC8vIGN1cnJlbnQgY29udHJvbGxlciBzdGF0ZSwgY2hhbmdlcyBleHRlcm5hbGx5CiAgdGhpcy5jdXJyZW50Q29udHJvbDFTdGF0ZSA9IDA7CiAgdGhpcy5jdXJyZW50Q29udHJvbDJTdGF0ZSA9IDA7CgogIC8vIGNhbGxiYWNrcyBmb3Igb25yZWFkKGFkciwgdmFsKSwgb253cml0ZShhZHIsIHZhbCkgYW5kIG9uZXhlY3V0ZShhZHIsIHZhbCkKICB0aGlzLm9ucmVhZCA9IHVuZGVmaW5lZDsKICB0aGlzLm9ud3JpdGUgPSB1bmRlZmluZWQ7CiAgdGhpcy5vbmV4ZWN1dGUgPSB1bmRlZmluZWQ7CgogIHRoaXMucmVzZXQgPSBmdW5jdGlvbihoYXJkKSB7CiAgICBpZihoYXJkKSB7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnJhbS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucmFtW2ldID0gMDsKICAgICAgfQogICAgfQogICAgdGhpcy5jcHUucmVzZXQoKTsKICAgIHRoaXMucHB1LnJlc2V0KCk7CiAgICB0aGlzLmFwdS5yZXNldCgpOwogICAgaWYodGhpcy5tYXBwZXIpIHsKICAgICAgdGhpcy5tYXBwZXIucmVzZXQoaGFyZCk7CiAgICB9CgogICAgLy8gY3ljbGUgdGltZXIsIHRvIHN5bmMgY3B1L3BwdQogICAgdGhpcy5jeWNsZXMgPSAwOwoKICAgIC8vIG9hbSBkbWEKICAgIHRoaXMuaW5EbWEgPSBmYWxzZTsKICAgIHRoaXMuZG1hVGltZXIgPSAwOwogICAgdGhpcy5kbWFCYXNlID0gMDsKICAgIHRoaXMuZG1hVmFsdWUgPSAwOwoKICAgIC8vIGNvbnRyb2xsZXJzCiAgICB0aGlzLmxhdGNoZWRDb250cm9sMVN0YXRlID0gMDsKICAgIHRoaXMubGF0Y2hlZENvbnRyb2wyU3RhdGUgPSAwOwogICAgdGhpcy5jb250cm9sbGVyTGF0Y2hlZCA9IGZhbHNlOwoKICAgIC8vIGlycSBzb3VyY2VzCiAgICB0aGlzLm1hcHBlcklycVdhbnRlZCA9IGZhbHNlOwogICAgdGhpcy5mcmFtZUlycVdhbnRlZCA9IGZhbHNlOwogICAgdGhpcy5kbWNJcnFXYW50ZWQgPSBmYWxzZTsKICB9CiAgdGhpcy5yZXNldCh0cnVlKTsKICB0aGlzLnNhdmVWYXJzID0gWwogICAgInJhbSIsICJjeWNsZXMiLCAiaW5EbWEiLCAiZG1hVGltZXIiLCAiZG1hQmFzZSIsICJkbWFWYWx1ZSIsCiAgICAibGF0Y2hlZENvbnRyb2wxU3RhdGUiLCAibGF0Y2hlZENvbnRyb2wyU3RhdGUiLCAiY29udHJvbGxlckxhdGNoZWQiLAogICAgIm1hcHBlcklycVdhbnRlZCIsICJmcmFtZUlycVdhbnRlZCIsICJkbWNJcnFXYW50ZWQiCiAgXTsKCiAgdGhpcy5sb2FkUm9tID0gZnVuY3Rpb24ocm9tKSB7CiAgICBpZihyb20ubGVuZ3RoIDwgMHgxMCkgewogICAgICBsb2coIkludmFsaWQgcm9tIGxvYWRlZCIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZigKICAgICAgcm9tWzBdICE9PSAweDRlIHx8IHJvbVsxXSAhPT0gMHg0NSB8fAogICAgICByb21bMl0gIT09IDB4NTMgfHwgcm9tWzNdICE9PSAweDFhCiAgICApIHsKICAgICAgbG9nKCJJbnZhbGlkIHJvbSBsb2FkZWQiKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgbGV0IGhlYWRlciA9IHRoaXMucGFyc2VIZWFkZXIocm9tKTsKICAgIGlmKHJvbS5sZW5ndGggPCBoZWFkZXIuY2hyQmFzZSArIDB4MjAwMCAqIGhlYWRlci5jaHJCYW5rcykgewogICAgICBsb2coIlJvbSBmaWxlIGlzIG1pc3NpbmcgZGF0YSIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZihtYXBwZXJzW2hlYWRlci5tYXBwZXJdID09PSB1bmRlZmluZWQpIHsKICAgICAgbG9nKCJVbnN1cHBvcnRlZCBtYXBwZXI6ICIgKyBoZWFkZXIubWFwcGVyKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLm1hcHBlciA9IG5ldyBtYXBwZXJzW2hlYWRlci5tYXBwZXJdKHRoaXMsIHJvbSwgaGVhZGVyKTsKICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgbG9nKCJSb20gbG9hZCBlcnJvcjogIiArIGUpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogICAgbG9nKAogICAgICAiTG9hZGVkICIgKyB0aGlzLm1hcHBlci5uYW1lICsgIiByb206ICIgKyB0aGlzLm1hcHBlci5oLmJhbmtzICsKICAgICAgIiBQUkcgYmFuayhzKSwgIiArIHRoaXMubWFwcGVyLmguY2hyQmFua3MgKyAiIENIUiBiYW5rKHMpIgogICAgKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgdGhpcy5wYXJzZUhlYWRlciA9IGZ1bmN0aW9uKHJvbSkgewogICAgbGV0IG8gPSB7CiAgICAgIGJhbmtzOiByb21bNF0sCiAgICAgIGNockJhbmtzOiByb21bNV0sCiAgICAgIG1hcHBlcjogKHJvbVs2XSA+PiA0KSB8IChyb21bN10gJiAweGYwKSwKICAgICAgdmVydGljYWxNaXJyb3Jpbmc6IChyb21bNl0gJiAweDAxKSA+IDAsCiAgICAgIGJhdHRlcnk6IChyb21bNl0gJiAweDAyKSA+IDAsCiAgICAgIHRyYWluZXI6IChyb21bNl0gJiAweDA0KSA+IDAsCiAgICAgIGZvdXJTY3JlZW46IChyb21bNl0gJiAweDA4KSA+IDAsCiAgICB9OwogICAgb1siYmFzZSJdID0gMTYgKyAoby50cmFpbmVyID8gNTEyIDogMCk7CiAgICBvWyJjaHJCYXNlIl0gPSBvLmJhc2UgKyAweDQwMDAgKiBvLmJhbmtzOwogICAgb1sicHJnQW5kIl0gPSAoby5iYW5rcyAqIDB4NDAwMCkgLSAxOwogICAgb1siY2hyQW5kIl0gPSBvLmNockJhbmtzID09PSAwID8gMHgxZmZmIDogKG8uY2hyQmFua3MgKiAweDIwMDApIC0gMTsKICAgIG9bInNhdmVWYXJzIl0gPSBbCiAgICAgICJiYW5rcyIsICJjaHJCYW5rcyIsICJtYXBwZXIiLCAidmVydGljYWxNaXJyb3JpbmciLCAiYmF0dGVyeSIsICJ0cmFpbmVyIiwKICAgICAgImZvdXJTY3JlZW4iCiAgICBdOwogICAgcmV0dXJuIG87CiAgfQoKICB0aGlzLmdldFBpeGVscyA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHRoaXMucHB1LnNldEZyYW1lKGRhdGEpOwogIH0KCiAgdGhpcy5nZXRTYW1wbGVzID0gZnVuY3Rpb24oZGF0YSwgY291bnQpIHsKICAgIC8vIGFwdSByZXR1cm5zIDI5NzgwIG9yIDI5NzgxIHNhbXBsZXMgKDAgLSAxKSBmb3IgYSBmcmFtZQogICAgLy8gd2UgbmVlZCBjb3VudCB2YWx1ZXMgKDAgLSAxKQogICAgbGV0IHNhbXBsZXMgPSB0aGlzLmFwdS5nZXRPdXRwdXQoKTsKICAgIGxldCBydW5BZGQgPSAoMjk3ODAgLyBjb3VudCk7CiAgICBsZXQgdG90YWwgPSAwOwogICAgbGV0IGlucHV0UG9zID0gMDsKICAgIGxldCBydW5uaW5nID0gMDsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIHJ1bm5pbmcgKz0gcnVuQWRkOwogICAgICBsZXQgdG90YWwgPSAwOwogICAgICBsZXQgYXZnQ291bnQgPSBydW5uaW5nICYgMHhmZmZmOwogICAgICBmb3IobGV0IGogPSBpbnB1dFBvczsgaiA8IGlucHV0UG9zICsgYXZnQ291bnQ7IGorKykgewogICAgICAgIHRvdGFsICs9IHNhbXBsZXNbMV1bal07CiAgICAgIH0KICAgICAgZGF0YVtpXSA9IHRvdGFsIC8gYXZnQ291bnQ7CiAgICAgIGlucHV0UG9zICs9IGF2Z0NvdW50OwogICAgICBydW5uaW5nIC09IGF2Z0NvdW50OwogICAgfQogIH0KCiAgdGhpcy5jeWNsZSA9IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5jeWNsZXMgPT09IDApIHsKICAgICAgdGhpcy5jeWNsZXMgPSAzOwogICAgICAvLyBkbyBhIGNwdSBhbmQgYXB1IGN5Y2xlIGV2ZXJ5IDMgcHB1IGN5Y2xlcwoKICAgICAgLy8gaGFuZGxlIGNvbnRyb2xsZXIgbGF0Y2gKICAgICAgaWYodGhpcy5jb250cm9sbGVyTGF0Y2hlZCkgewogICAgICAgIHRoaXMubGF0Y2hlZENvbnRyb2wxU3RhdGUgPSB0aGlzLmN1cnJlbnRDb250cm9sMVN0YXRlOwogICAgICAgIHRoaXMubGF0Y2hlZENvbnRyb2wyU3RhdGUgPSB0aGlzLmN1cnJlbnRDb250cm9sMlN0YXRlOwogICAgICB9CgogICAgICAvLyBoYW5kbGUgaXJxCiAgICAgIGlmKHRoaXMubWFwcGVySXJxV2FudGVkIHx8IHRoaXMuZnJhbWVJcnFXYW50ZWQgfHwgdGhpcy5kbWNJcnFXYW50ZWQpIHsKICAgICAgICB0aGlzLmNwdS5pcnFXYW50ZWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY3B1LmlycVdhbnRlZCA9IGZhbHNlOwogICAgICB9CgogICAgICBpZighdGhpcy5pbkRtYSkgewogICAgICAgIGlmKHRoaXMub25leGVjdXRlICYmIHRoaXMuY3B1LmN5Y2xlc0xlZnQgPT09IDApIHsKICAgICAgICAgIHRoaXMub25leGVjdXRlKHRoaXMuY3B1LmJyWzBdLCB0aGlzLnBlYWsodGhpcy5jcHUuYnJbMF0pKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5jcHUuY3ljbGUoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBoYW5kbGUgZG1hCiAgICAgICAgaWYodGhpcy5kbWFUaW1lciA+IDApIHsKICAgICAgICAgIGlmKCh0aGlzLmRtYVRpbWVyICYgMSkgPT09IDApIHsKICAgICAgICAgICAgLy8gZXZlbiBjeWNsZXMgYXJlIHdyaXRlIHRvIHBwdQogICAgICAgICAgICB0aGlzLnBwdS53cml0ZSg0LCB0aGlzLmRtYVZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIG9kZCBjeWNsZXMgYXJlIHJlYWQgZm9yIHZhbHVlCiAgICAgICAgICAgIHRoaXMuZG1hVmFsdWUgPSB0aGlzLnJlYWQoCiAgICAgICAgICAgICAgdGhpcy5kbWFCYXNlICsgKCh0aGlzLmRtYVRpbWVyIC8gMikgJiAweGZmKQogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLmRtYVRpbWVyKys7CiAgICAgICAgaWYodGhpcy5kbWFUaW1lciA9PT0gNTEzKSB7CiAgICAgICAgICB0aGlzLmRtYVRpbWVyID0gMDsKICAgICAgICAgIHRoaXMuaW5EbWEgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYXB1LmN5Y2xlKCk7CiAgICB9CiAgICB0aGlzLnBwdS5jeWNsZSgpOwogICAgdGhpcy5jeWNsZXMtLTsKICB9CgogIHRoaXMucnVuRnJhbWUgPSBmdW5jdGlvbigpIHsKICAgIGRvIHsKICAgICAgdGhpcy5jeWNsZSgpCiAgICB9IHdoaWxlKCEodGhpcy5wcHUubGluZSA9PT0gMjQwICYmIHRoaXMucHB1LmRvdCA9PT0gMCkpOwogIH0KCiAgLy8gcGVhawogIHRoaXMucGVhayA9IGZ1bmN0aW9uKGFkcikgewogICAgYWRyICY9IDB4ZmZmZjsKICAgIGlmKGFkciA8IDB4MjAwMCkgewogICAgICAvLyByYW0KICAgICAgcmV0dXJuIHRoaXMucmFtW2FkciAmIDB4N2ZmXTsKICAgIH0KICAgIGlmKGFkciA8IDB4NDAwMCkgewogICAgICAvLyBwcHUgcG9ydHMKICAgICAgcmV0dXJuIHRoaXMucHB1LnBlYWsoYWRyICYgMHg3KTsKICAgIH0KICAgIGlmKGFkciA8IDB4NDAyMCkgewogICAgICAvLyBhcHUvbWlzYyBwb3J0cwogICAgICBpZihhZHIgPT09IDB4NDAxNCkgewogICAgICAgIHJldHVybiAwOyAvLyBub3QgcmVhZGFibGUKICAgICAgfQogICAgICBpZihhZHIgPT09IDB4NDAxNikgewogICAgICAgIGxldCByZXQgPSB0aGlzLmxhdGNoZWRDb250cm9sMVN0YXRlICYgMTsKICAgICAgICByZXR1cm4gcmV0IHwgMHg0MDsKICAgICAgfQogICAgICBpZihhZHIgPT09IDB4NDAxNykgewogICAgICAgIGxldCByZXQgPSB0aGlzLmxhdGNoZWRDb250cm9sMlN0YXRlICYgMTsKICAgICAgICByZXR1cm4gcmV0IHwgMHg0MDsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5hcHUucGVhayhhZHIpOwogICAgfQogICAgcmV0dXJuIHRoaXMubWFwcGVyLnBlYWsoYWRyKTsKICB9CgogIC8vIGNwdSByZWFkCiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oYWRyKSB7CiAgICBhZHIgJj0gMHhmZmZmOwogICAgaWYodGhpcy5vbnJlYWQpIHsKICAgICAgdGhpcy5vbnJlYWQoYWRyLCB0aGlzLnBlYWsoYWRyKSk7CiAgICB9CgogICAgaWYoYWRyIDwgMHgyMDAwKSB7CiAgICAgIC8vIHJhbQogICAgICByZXR1cm4gdGhpcy5yYW1bYWRyICYgMHg3ZmZdOwogICAgfQogICAgaWYoYWRyIDwgMHg0MDAwKSB7CiAgICAgIC8vIHBwdSBwb3J0cwogICAgICByZXR1cm4gdGhpcy5wcHUucmVhZChhZHIgJiAweDcpOwogICAgfQogICAgaWYoYWRyIDwgMHg0MDIwKSB7CiAgICAgIC8vIGFwdS9taXNjIHBvcnRzCiAgICAgIGlmKGFkciA9PT0gMHg0MDE0KSB7CiAgICAgICAgcmV0dXJuIDA7IC8vIG5vdCByZWFkYWJsZQogICAgICB9CiAgICAgIGlmKGFkciA9PT0gMHg0MDE2KSB7CiAgICAgICAgbGV0IHJldCA9IHRoaXMubGF0Y2hlZENvbnRyb2wxU3RhdGUgJiAxOwogICAgICAgIHRoaXMubGF0Y2hlZENvbnRyb2wxU3RhdGUgPj49IDE7CiAgICAgICAgdGhpcy5sYXRjaGVkQ29udHJvbDFTdGF0ZSB8PSAweDgwOyAvLyBzZXQgYml0IDcKICAgICAgICAvLyBzdXBwb3NlZCB0byBiZSBvcGVuIGJ1cywgYnV0IGlzIHVzdWFsbHkgdGhlIGhpZ2ggYnl0ZSBvZiB0aGUgYWRkcmVzcwogICAgICAgIC8vIHdoaWNoIGlzIDB4NDAxNiwgc28gb3BlbiBidXMgd291bGQgYmUgMHg0MAogICAgICAgIHJldHVybiByZXQgfCAweDQwOwogICAgICB9CiAgICAgIGlmKGFkciA9PT0gMHg0MDE3KSB7CiAgICAgICAgbGV0IHJldCA9IHRoaXMubGF0Y2hlZENvbnRyb2wyU3RhdGUgJiAxOwogICAgICAgIHRoaXMubGF0Y2hlZENvbnRyb2wyU3RhdGUgPj49IDE7CiAgICAgICAgdGhpcy5sYXRjaGVkQ29udHJvbDJTdGF0ZSB8PSAweDgwOyAvLyBzZXQgYml0IDcKICAgICAgICAvLyBzYW1lIGFzIDB4NDAxNgogICAgICAgIHJldHVybiByZXQgfCAweDQwOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmFwdS5yZWFkKGFkcik7CiAgICB9CiAgICByZXR1cm4gdGhpcy5tYXBwZXIucmVhZChhZHIpOwogIH0KCiAgLy8gY3B1IHdyaXRlCiAgdGhpcy53cml0ZSA9IGZ1bmN0aW9uKGFkciwgdmFsdWUpIHsKICAgIGFkciAmPSAweGZmZmY7CiAgICBpZih0aGlzLm9ud3JpdGUpIHsKICAgICAgdGhpcy5vbndyaXRlKGFkciwgdmFsdWUpOwogICAgfQogICAgaWYoYWRyIDwgMHgyMDAwKSB7CiAgICAgIC8vIHJhbQogICAgICB0aGlzLnJhbVthZHIgJiAweDdmZl0gPSB2YWx1ZTsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYoYWRyIDwgMHg0MDAwKSB7CiAgICAgIC8vIHBwdSBwb3J0cwogICAgICB0aGlzLnBwdS53cml0ZShhZHIgJiAweDcsIHZhbHVlKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYoYWRyIDwgMHg0MDIwKSB7CiAgICAgIC8vIGFwdS9taXNjIHBvcnRzCiAgICAgIGlmKGFkciA9PT0gMHg0MDE0KSB7CiAgICAgICAgdGhpcy5pbkRtYSA9IHRydWU7CiAgICAgICAgdGhpcy5kbWFCYXNlID0gdmFsdWUgPDwgODsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYoYWRyID09PSAweDQwMTYpIHsKICAgICAgICBpZigodmFsdWUgJiAweDAxKSA+IDApIHsKICAgICAgICAgIHRoaXMuY29udHJvbGxlckxhdGNoZWQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNvbnRyb2xsZXJMYXRjaGVkID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmFwdS53cml0ZShhZHIsIHZhbHVlKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5tYXBwZXIud3JpdGUoYWRyLCB2YWx1ZSk7CiAgfQoKICAvLyBwcmludCBieXRlcyBhbmQgd29yZHMgbmljZWx5CiAgdGhpcy5nZXRCeXRlUmVwID0gZnVuY3Rpb24odmFsKSB7CiAgICByZXR1cm4gKCIwIiArIHZhbC50b1N0cmluZygxNikpLnNsaWNlKC0yKTsKICB9CgogIHRoaXMuZ2V0V29yZFJlcCA9IGZ1bmN0aW9uKHZhbCkgewogICAgcmV0dXJuICgiMDAwIiArIHZhbC50b1N0cmluZygxNikpLnNsaWNlKC00KTsKICB9CgogIC8vIGdldCBjb250cm9scyBpbgogIHRoaXMuc2V0QnV0dG9uUHJlc3NlZCA9IGZ1bmN0aW9uKHBsYXllciwgYnV0dG9uKSB7CiAgICBpZihwbGF5ZXIgPT09IDEpIHsKICAgICAgdGhpcy5jdXJyZW50Q29udHJvbDFTdGF0ZSB8PSAoMSA8PCBidXR0b24pOwogICAgfSBlbHNlIGlmKHBsYXllciA9PT0gMikgewogICAgICB0aGlzLmN1cnJlbnRDb250cm9sMlN0YXRlIHw9ICgxIDw8IGJ1dHRvbik7CiAgICB9CiAgfQoKICB0aGlzLnNldEJ1dHRvblJlbGVhc2VkID0gZnVuY3Rpb24ocGxheWVyLCBidXR0b24pIHsKICAgIGlmKHBsYXllciA9PT0gMSkgewogICAgICB0aGlzLmN1cnJlbnRDb250cm9sMVN0YXRlICY9ICh+KDEgPDwgYnV0dG9uKSkgJiAweGZmOwogICAgfSBlbHNlIGlmKHBsYXllciA9PT0gMikgewogICAgICB0aGlzLmN1cnJlbnRDb250cm9sMlN0YXRlICY9ICh+KDEgPDwgYnV0dG9uKSkgJiAweGZmOwogICAgfQogIH0KCiAgdGhpcy5JTlBVVCA9IHsKICAgIEE6IDAsCiAgICBCOiAxLAogICAgU0VMRUNUOiAyLAogICAgU1RBUlQ6IDMsCiAgICBVUDogNCwKICAgIERPV046IDUsCiAgICBMRUZUOiA2LAogICAgUklHSFQ6IDcKICB9CgogIC8vIHNhdmUgc3RhdGVzLCBiYXR0ZXJ5IHNhdmVzCiAgdGhpcy5nZXRCYXR0ZXJ5ID0gZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLm1hcHBlci5oLmJhdHRlcnkpIHsKICAgICAgcmV0dXJuIHtkYXRhOiB0aGlzLm1hcHBlci5nZXRCYXR0ZXJ5KCl9OwogICAgfQogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHRoaXMuc2V0QmF0dGVyeSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgIGlmKHRoaXMubWFwcGVyLmguYmF0dGVyeSkgewogICAgICByZXR1cm4gdGhpcy5tYXBwZXIuc2V0QmF0dGVyeShkYXRhLmRhdGEpOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICB0aGlzLmdldFN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICBsZXQgY3B1T2JqID0gdGhpcy5nZXRPYmpTdGF0ZSh0aGlzLmNwdSk7CiAgICBsZXQgcHB1T2JqID0gdGhpcy5nZXRPYmpTdGF0ZSh0aGlzLnBwdSk7CiAgICBsZXQgYXB1T2JqID0gdGhpcy5nZXRPYmpTdGF0ZSh0aGlzLmFwdSk7CiAgICBsZXQgbWFwcGVyT2JqID0gdGhpcy5nZXRPYmpTdGF0ZSh0aGlzLm1hcHBlcik7CiAgICBsZXQgaGVhZGVyT2JqID0gdGhpcy5nZXRPYmpTdGF0ZSh0aGlzLm1hcHBlci5oKTsKICAgIGxldCBmaW5hbCA9IHRoaXMuZ2V0T2JqU3RhdGUodGhpcyk7CiAgICBmaW5hbFsiY3B1Il0gPSBjcHVPYmo7CiAgICBmaW5hbFsicHB1Il0gPSBwcHVPYmo7CiAgICBmaW5hbFsiYXB1Il0gPSBhcHVPYmo7CiAgICBmaW5hbFsibWFwcGVyIl0gPSBtYXBwZXJPYmo7CiAgICBmaW5hbFsiaGVhZGVyIl0gPSBoZWFkZXJPYmo7CiAgICBmaW5hbFsibWFwcGVyVmVyc2lvbiJdID0gdGhpcy5tYXBwZXIudmVyc2lvbjsKICAgIGZpbmFsWyJ2ZXJzaW9uIl0gPSB0aGlzLnN0YXRlVmVyc2lvbjsKICAgIHJldHVybiBmaW5hbDsKICB9CgogIHRoaXMuc2V0U3RhdGUgPSBmdW5jdGlvbihvYmopIHsKICAgIGlmKG9iai52ZXJzaW9uICE9PSB0aGlzLnN0YXRlVmVyc2lvbiB8fCBvYmoubWFwcGVyVmVyc2lvbiAhPT0gdGhpcy5tYXBwZXIudmVyc2lvbikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvLyBjaGVjayBoZWFkZXIKICAgIGlmKCF0aGlzLmNoZWNrT2JqU3RhdGUodGhpcy5tYXBwZXIuaCwgb2JqLmhlYWRlcikpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdGhpcy5zZXRPYmpTdGF0ZSh0aGlzLmNwdSwgb2JqLmNwdSk7CiAgICB0aGlzLnNldE9ialN0YXRlKHRoaXMucHB1LCBvYmoucHB1KTsKICAgIHRoaXMuc2V0T2JqU3RhdGUodGhpcy5hcHUsIG9iai5hcHUpOwogICAgdGhpcy5zZXRPYmpTdGF0ZSh0aGlzLm1hcHBlciwgb2JqLm1hcHBlcik7CiAgICB0aGlzLnNldE9ialN0YXRlKHRoaXMsIG9iaik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHRoaXMuZ2V0T2JqU3RhdGUgPSBmdW5jdGlvbihvYmopIHsKICAgIGxldCByZXQgPSB7fTsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBvYmouc2F2ZVZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgbGV0IG5hbWUgPSBvYmouc2F2ZVZhcnNbaV07CiAgICAgIGxldCB2YWwgPSBvYmpbbmFtZV07CiAgICAgIGlmKHZhbCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgdmFsIGluc3RhbmNlb2YgVWludDE2QXJyYXkpIHsKICAgICAgICByZXRbbmFtZV0gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh2YWwpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldFtuYW1lXSA9IHZhbDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHJldDsKICB9CgogIHRoaXMuc2V0T2JqU3RhdGUgPSBmdW5jdGlvbihvYmosIHNhdmUpIHsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBvYmouc2F2ZVZhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgbGV0IG5hbWUgPSBvYmouc2F2ZVZhcnNbaV07CiAgICAgIGxldCB2YWwgPSBvYmpbbmFtZV07CiAgICAgIGlmKHZhbCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgICBvYmpbbmFtZV0gPSBuZXcgVWludDhBcnJheShzYXZlW25hbWVdKTsKICAgICAgfSBlbHNlIGlmKHZhbCBpbnN0YW5jZW9mIFVpbnQxNkFycmF5KSB7CiAgICAgICAgb2JqW25hbWVdID0gbmV3IFVpbnQxNkFycmF5KHNhdmVbbmFtZV0pOwogICAgICB9IGVsc2UgewogICAgICAgIG9ialtuYW1lXSA9IHNhdmVbbmFtZV07CiAgICAgIH0KICAgIH0KICB9CgogIHRoaXMuY2hlY2tPYmpTdGF0ZSA9IGZ1bmN0aW9uKG9iaiwgc2F2ZSkgewogICAgZm9yKGxldCBpID0gMDsgaSA8IG9iai5zYXZlVmFycy5sZW5ndGg7IGkrKykgewogICAgICBsZXQgbmFtZSA9IG9iai5zYXZlVmFyc1tpXTsKICAgICAgaWYob2JqW25hbWVdICE9PSBzYXZlW25hbWVdKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0K"></script>

  <script src="data:application/javascript;base64,CmZ1bmN0aW9uIEF1ZGlvSGFuZGxlcigpIHsKCiAgdGhpcy5oYXNBdWRpbyA9IHRydWU7CiAgbGV0IEFjID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0OwogIHRoaXMuc2FtcGxlQnVmZmVyID0gbmV3IEZsb2F0NjRBcnJheSg3MzUpOwogIHRoaXMuc2FtcGxlc1BlckZyYW1lID0gNzM1OwoKICBpZihBYyA9PT0gdW5kZWZpbmVkKSB7CiAgICBsb2coIkF1ZGlvIGRpc2FibGVkOiBubyBXZWIgQXVkaW8gQVBJIHN1cHBvcnQiKTsKICAgIHRoaXMuaGFzQXVkaW8gPSBmYWxzZTsKICB9IGVsc2UgewogICAgdGhpcy5hY3R4ID0gbmV3IEFjKCk7CgogICAgbGV0IHNhbXBsZXMgPSB0aGlzLmFjdHguc2FtcGxlUmF0ZSAvIDYwOwogICAgdGhpcy5zYW1wbGVCdWZmZXIgPSBuZXcgRmxvYXQ2NEFycmF5KHNhbXBsZXMpOwogICAgdGhpcy5zYW1wbGVzUGVyRnJhbWUgPSBzYW1wbGVzOwoKICAgIGxvZygiQXVkaW8gaW5pdGlhbGl6ZWQsIHNhbXBsZSByYXRlOiAiICsgc2FtcGxlcyAqIDYwKTsKCiAgICB0aGlzLmlucHV0QnVmZmVyID0gbmV3IEZsb2F0NjRBcnJheSg0MDk2KTsKICAgIHRoaXMuaW5wdXRCdWZmZXJQb3MgPSAwOwogICAgdGhpcy5pbnB1dFJlYWRQb3MgPSAwOwoKICAgIHRoaXMuc2NyaXB0Tm9kZSA9IHVuZGVmaW5lZDsKICAgIHRoaXMuZHVtbXlOb2RlID0gdW5kZWZpbmVkOwogIH0KCiAgdGhpcy5yZXN1bWUgPSBmdW5jdGlvbigpIHsKICAgIC8vIGZvciBDaHJvbWUgYXV0b3BsYXkgcG9saWN5CiAgICBpZih0aGlzLmhhc0F1ZGlvKSB7CiAgICAgIHRoaXMuYWN0eC5vbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7IGNvbnNvbGUubG9nKHRoaXMuYWN0eC5zdGF0ZSkgfTsKICAgICAgdGhpcy5hY3R4LnJlc3VtZSgpOwogICAgfQogIH0KCiAgdGhpcy5zdGFydCA9IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5oYXNBdWRpbykgewoKICAgICAgdGhpcy5kdW1teU5vZGUgPSB0aGlzLmFjdHguY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICAgIHRoaXMuZHVtbXlOb2RlLmJ1ZmZlciA9IHRoaXMuYWN0eC5jcmVhdGVCdWZmZXIoMSwgNDQxMDAsIDQ0MTAwKTsKICAgICAgdGhpcy5kdW1teU5vZGUubG9vcCA9IHRydWU7CgogICAgICB0aGlzLnNjcmlwdE5vZGUgPSB0aGlzLmFjdHguY3JlYXRlU2NyaXB0UHJvY2Vzc29yKDIwNDgsIDEsIDEpOwogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHRoaXMuc2NyaXB0Tm9kZS5vbmF1ZGlvcHJvY2VzcyA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICB0aGF0LnByb2Nlc3MoZSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZHVtbXlOb2RlLmNvbm5lY3QodGhpcy5zY3JpcHROb2RlKTsKICAgICAgdGhpcy5zY3JpcHROb2RlLmNvbm5lY3QodGhpcy5hY3R4LmRlc3RpbmF0aW9uKTsKICAgICAgdGhpcy5kdW1teU5vZGUuc3RhcnQoKTsKCiAgICB9CiAgfQoKICB0aGlzLnN0b3AgPSBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuaGFzQXVkaW8pIHsKICAgICAgaWYodGhpcy5kdW1teU5vZGUpIHsKICAgICAgICB0aGlzLmR1bW15Tm9kZS5zdG9wKCk7CiAgICAgICAgdGhpcy5kdW1teU5vZGUuZGlzY29ubmVjdCgpOwogICAgICAgIHRoaXMuZHVtbXlOb2RlID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIGlmKHRoaXMuc2NyaXB0Tm9kZSkgewogICAgICAgIHRoaXMuc2NyaXB0Tm9kZS5kaXNjb25uZWN0KCk7CiAgICAgICAgdGhpcy5zY3JpcHROb2RlID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHRoaXMuaW5wdXRCdWZmZXJQb3MgPSAwOwogICAgICB0aGlzLmlucHV0UmVhZFBvcyA9IDA7CiAgICB9CiAgfQoKICB0aGlzLnByb2Nlc3MgPSBmdW5jdGlvbihlKSB7CiAgICBpZih0aGlzLmlucHV0UmVhZFBvcyArIDIwNDggPiB0aGlzLmlucHV0QnVmZmVyUG9zKSB7CiAgICAgIC8vIHdlIG92ZXJyYW4gdGhlIGJ1ZmZlcgogICAgICAvL2xvZygiQXVkaW8gYnVmZmVyIG92ZXJyYW4iKTsKICAgICAgdGhpcy5pbnB1dFJlYWRQb3MgPSB0aGlzLmlucHV0QnVmZmVyUG9zIC0gMjA0ODsKICAgIH0KICAgIGlmKHRoaXMuaW5wdXRSZWFkUG9zICsgNDA5NiA8IHRoaXMuaW5wdXRCdWZmZXJQb3MpIHsKICAgICAgLy8gd2UgdW5kZXJyYW4gdGhlIGJ1ZmZlcgogICAgICAvL2xvZygiQXVkaW8gYnVmZmVyIHVuZGVycmFuIik7CiAgICAgIHRoaXMuaW5wdXRSZWFkUG9zICs9IDIwNDg7CiAgICB9CiAgICBsZXQgb3V0cHV0ID0gZS5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMjA0ODsgaSsrKSB7CiAgICAgIG91dHB1dFtpXSA9IHRoaXMuaW5wdXRCdWZmZXJbKHRoaXMuaW5wdXRSZWFkUG9zKyspICYgMHhmZmZdOwogICAgfQogIH0KCiAgdGhpcy5uZXh0QnVmZmVyID0gZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLmhhc0F1ZGlvKSB7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnNhbXBsZXNQZXJGcmFtZTsgaSsrKSB7CiAgICAgICAgbGV0IHZhbCA9IHRoaXMuc2FtcGxlQnVmZmVyW2ldOwogICAgICAgIHRoaXMuaW5wdXRCdWZmZXJbKHRoaXMuaW5wdXRCdWZmZXJQb3MrKykgJiAweGZmZl0gPSB2YWw7CiAgICAgIH0KICAgIH0KICB9Cn0K"></script>
  <script src="data:application/javascript;base64,CmxldCBuZXMgPSBuZXcgTmVzKCk7CmxldCBhdWRpb0hhbmRsZXIgPSBuZXcgQXVkaW9IYW5kbGVyKCk7CmxldCBwYXVzZWQgPSBmYWxzZTsKbGV0IGxvYWRlZCA9IGZhbHNlOwpsZXQgcGF1c2VkSW5CZyA9IGZhbHNlOwpsZXQgbG9vcElkID0gMDsKbGV0IGxvYWRlZE5hbWUgPSAiIjsKCmxldCBjID0gZWwoIm91dHB1dCIpOwpjLndpZHRoID0gMjU2OwpjLmhlaWdodCA9IDI0MDsKbGV0IGN0eCA9IGMuZ2V0Q29udGV4dCgiMmQiKTsKbGV0IGltZ0RhdGEgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKDI1NiwgMjQwKTsKCmxldCBjb250cm9sc1AxID0gewogIGFycm93cmlnaHQ6IG5lcy5JTlBVVC5SSUdIVCwKICBhcnJvd2xlZnQ6IG5lcy5JTlBVVC5MRUZULAogIGFycm93ZG93bjogbmVzLklOUFVULkRPV04sCiAgYXJyb3d1cDogbmVzLklOUFVULlVQLAogIGVudGVyOiBuZXMuSU5QVVQuU1RBUlQsCiAgc2hpZnQ6IG5lcy5JTlBVVC5TRUxFQ1QsCiAgYTogbmVzLklOUFVULkIsCiAgejogbmVzLklOUFVULkEKfQpsZXQgY29udHJvbHNQMiA9IHsKICBsOiBuZXMuSU5QVVQuUklHSFQsCiAgajogbmVzLklOUFVULkxFRlQsCiAgazogbmVzLklOUFVULkRPV04sCiAgaTogbmVzLklOUFVULlVQLAogIHA6IG5lcy5JTlBVVC5TVEFSVCwKICBvOiBuZXMuSU5QVVQuU0VMRUNULAogIHQ6IG5lcy5JTlBVVC5CLAogIGc6IG5lcy5JTlBVVC5BCn0KCnppcC53b3JrZXJTY3JpcHRzUGF0aCA9ICJsaWIvIjsKemlwLnVzZVdlYldvcmtlcnMgPSBmYWxzZTsKCmVsKCJyb20iKS5vbmNoYW5nZSA9IGZ1bmN0aW9uKGUpIHsKICBhdWRpb0hhbmRsZXIucmVzdW1lKCk7CiAgbGV0IGZyZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogIGZyZWFkZXIub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICBsZXQgYnVmID0gZnJlYWRlci5yZXN1bHQ7CiAgICBpZihlLnRhcmdldC5maWxlc1swXS5uYW1lLnNsaWNlKC00KSA9PT0gIi56aXAiKSB7CiAgICAgIC8vIHVzZSB6aXAuanMgdG8gcmVhZCB0aGUgemlwCiAgICAgIGxldCBibG9iID0gbmV3IEJsb2IoW2J1Zl0pOwogICAgICB6aXAuY3JlYXRlUmVhZGVyKG5ldyB6aXAuQmxvYlJlYWRlcihibG9iKSwgZnVuY3Rpb24ocmVhZGVyKSB7CiAgICAgICAgcmVhZGVyLmdldEVudHJpZXMoZnVuY3Rpb24oZW50cmllcykgewogICAgICAgICAgaWYoZW50cmllcy5sZW5ndGgpIHsKICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgbGV0IG5hbWUgPSBlbnRyaWVzW2ldLmZpbGVuYW1lOwogICAgICAgICAgICAgIGlmKG5hbWUuc2xpY2UoLTQpICE9PSAiLm5lcyIgJiYgbmFtZS5zbGljZSgtNCkgIT09ICIuTkVTIikgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBsb2coIkxvYWRlZCBcIiIgKyBuYW1lICsgIlwiIGZyb20gemlwIik7CiAgICAgICAgICAgICAgZW50cmllc1tpXS5nZXREYXRhKG5ldyB6aXAuQmxvYldyaXRlcigpLCBmdW5jdGlvbihibG9iKSB7CiAgICAgICAgICAgICAgICBsZXQgYnJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgICBicmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICBsZXQgcmJ1ZiA9IGJyZWFkZXIucmVzdWx0OwogICAgICAgICAgICAgICAgICBsZXQgYXJyID0gbmV3IFVpbnQ4QXJyYXkocmJ1Zik7CiAgICAgICAgICAgICAgICAgIGxvYWRSb20oYXJyLCBuYW1lKTsKICAgICAgICAgICAgICAgICAgcmVhZGVyLmNsb3NlKGZ1bmN0aW9uKCkge30pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKTsKICAgICAgICAgICAgICB9LCBmdW5jdGlvbihjdXJyLCB0b3RhbCkge30pOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFmb3VuZCkgewogICAgICAgICAgICAgIGxvZygiTm8gLm5lcyBmaWxlIGZvdW5kIGluIHppcCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2coIlppcCBmaWxlIHdhcyBlbXB0eSIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LCBmdW5jdGlvbihlcnIpIHsKICAgICAgICBsb2coIkZhaWxlZCB0byByZWFkIHppcDogIiArIGVycik7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgLy8gbG9hZCByb20gbm9ybWFsbHkKICAgICAgbGV0IHBhcnRzID0gZS50YXJnZXQudmFsdWUuc3BsaXQoIlxcIik7CiAgICAgIGxldCBuYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBhcnIgPSBuZXcgVWludDhBcnJheShidWYpOwogICAgICBsb2FkUm9tKGFyciwgbmFtZSk7CiAgICB9CiAgfQogIGZyZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZS50YXJnZXQuZmlsZXNbMF0pOwp9CgplbCgicGF1c2UiKS5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogIGlmKHBhdXNlZCAmJiBsb2FkZWQpIHsKICAgIGxvb3BJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpOwogICAgYXVkaW9IYW5kbGVyLnN0YXJ0KCk7CiAgICBwYXVzZWQgPSBmYWxzZTsKICAgIGVsKCJwYXVzZSIpLmlubmVyVGV4dCA9ICJQYXVzZSI7CiAgfSBlbHNlIHsKICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGxvb3BJZCk7CiAgICBhdWRpb0hhbmRsZXIuc3RvcCgpOwogICAgcGF1c2VkID0gdHJ1ZTsKICAgIGVsKCJwYXVzZSIpLmlubmVyVGV4dCA9ICJVbnBhdXNlIjsKICB9Cn0KCmVsKCJyZXNldCIpLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgbmVzLnJlc2V0KGZhbHNlKTsKfQoKZWwoImhhcmRyZXNldCIpLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgbmVzLnJlc2V0KHRydWUpOwp9CgplbCgicnVuZnJhbWUiKS5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogIGlmKGxvYWRlZCkgewogICAgcnVuRnJhbWUoKTsKICB9Cn0KCmRvY3VtZW50Lm9udmlzaWJpbGl0eWNoYW5nZSA9IGZ1bmN0aW9uKGUpIHsKICBpZihkb2N1bWVudC5oaWRkZW4pIHsKICAgIHBhdXNlZEluQmcgPSBmYWxzZTsKICAgIGlmKCFwYXVzZWQgJiYgbG9hZGVkKSB7CiAgICAgIGVsKCJwYXVzZSIpLmNsaWNrKCk7CiAgICAgIHBhdXNlZEluQmcgPSB0cnVlOwogICAgfQogIH0gZWxzZSB7CiAgICBpZihwYXVzZWRJbkJnICYmIGxvYWRlZCkgewogICAgICBlbCgicGF1c2UiKS5jbGljaygpOwogICAgICBwYXVzZWRJbkJnID0gZmFsc2U7CiAgICB9CiAgfQp9Cgp3aW5kb3cub25wYWdlaGlkZSA9IGZ1bmN0aW9uKGUpIHsKICBzYXZlQmF0dGVyeUZvclJvbSgpOwp9CgpmdW5jdGlvbiBsb2FkUm9tKHJvbSwgbmFtZSkgewogIHNhdmVCYXR0ZXJ5Rm9yUm9tKCk7CiAgaWYobmVzLmxvYWRSb20ocm9tKSkgewogICAgLy8gbG9hZCB0aGUgcm9tcyBiYXR0ZXJ5IGRhdGEKICAgIGxldCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0obmFtZSArICJfYmF0dGVyeSIpOwogICAgaWYoZGF0YSkgewogICAgICBsZXQgb2JqID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgbmVzLnNldEJhdHRlcnkob2JqKTsKICAgICAgbG9nKCJMb2FkZWQgYmF0dGVyeSIpOwogICAgfQogICAgbmVzLnJlc2V0KHRydWUpOwogICAgaWYoIWxvYWRlZCAmJiAhcGF1c2VkKSB7CiAgICAgIGxvb3BJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpOwogICAgICBhdWRpb0hhbmRsZXIuc3RhcnQoKTsKICAgIH0KICAgIGxvYWRlZCA9IHRydWU7CiAgICBsb2FkZWROYW1lID0gbmFtZTsKICB9Cn0KCmZ1bmN0aW9uIHNhdmVCYXR0ZXJ5Rm9yUm9tKCkgewogIC8vIHNhdmUgdGhlIGxvYWRlZE5hbWUncyBiYXR0ZXJ5IGRhdGEKICBpZihsb2FkZWQpIHsKICAgIGxldCBkYXRhID0gbmVzLmdldEJhdHRlcnkoKTsKICAgIGlmKGRhdGEpIHsKICAgICAgdHJ5IHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShsb2FkZWROYW1lICsgIl9iYXR0ZXJ5IiwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgIGxvZygiU2F2ZWQgYmF0dGVyeSIpOwogICAgICB9IGNhdGNoKGUpIHsKICAgICAgICBsb2coIkZhaWxlZCB0byBzYXZlIGJhdHRlcnk6ICIgKyBlKTsKICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gdXBkYXRlKCkgewogIHJ1bkZyYW1lKCk7CiAgbG9vcElkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZSk7Cn0KCmZ1bmN0aW9uIHJ1bkZyYW1lKCkgewogIG5lcy5ydW5GcmFtZSgpOwogIG5lcy5nZXRTYW1wbGVzKGF1ZGlvSGFuZGxlci5zYW1wbGVCdWZmZXIsIGF1ZGlvSGFuZGxlci5zYW1wbGVzUGVyRnJhbWUpOwogIGF1ZGlvSGFuZGxlci5uZXh0QnVmZmVyKCk7CiAgbmVzLmdldFBpeGVscyhpbWdEYXRhLmRhdGEpOwogIGN0eC5wdXRJbWFnZURhdGEoaW1nRGF0YSwgMCwgMCk7Cn0KCmZ1bmN0aW9uIGxvZyh0ZXh0KSB7CiAgZWwoImxvZyIpLmlubmVySFRNTCArPSB0ZXh0ICsgIjxicj4iOwogIGVsKCJsb2ciKS5zY3JvbGxUb3AgPSBlbCgibG9nIikuc2Nyb2xsSGVpZ2h0Owp9CgpmdW5jdGlvbiBlbChpZCkgewogIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7Cn0KCndpbmRvdy5vbmtleWRvd24gPSBmdW5jdGlvbihlKSB7CiAgaWYoY29udHJvbHNQMVtlLmtleS50b0xvd2VyQ2FzZSgpXSAhPT0gdW5kZWZpbmVkKSB7CiAgICBuZXMuc2V0QnV0dG9uUHJlc3NlZCgxLCBjb250cm9sc1AxW2Uua2V5LnRvTG93ZXJDYXNlKCldKTsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICB9CiAgaWYoY29udHJvbHNQMltlLmtleS50b0xvd2VyQ2FzZSgpXSAhPT0gdW5kZWZpbmVkKSB7CiAgICBuZXMuc2V0QnV0dG9uUHJlc3NlZCgyLCBjb250cm9sc1AyW2Uua2V5LnRvTG93ZXJDYXNlKCldKTsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICB9Cn0KCndpbmRvdy5vbmtleXVwID0gZnVuY3Rpb24oZSkgewogIGlmKGNvbnRyb2xzUDFbZS5rZXkudG9Mb3dlckNhc2UoKV0gIT09IHVuZGVmaW5lZCkgewogICAgbmVzLnNldEJ1dHRvblJlbGVhc2VkKDEsIGNvbnRyb2xzUDFbZS5rZXkudG9Mb3dlckNhc2UoKV0pOwogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogIH0KICBpZihjb250cm9sc1AyW2Uua2V5LnRvTG93ZXJDYXNlKCldICE9PSB1bmRlZmluZWQpIHsKICAgIG5lcy5zZXRCdXR0b25SZWxlYXNlZCgyLCBjb250cm9sc1AyW2Uua2V5LnRvTG93ZXJDYXNlKCldKTsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICB9CiAgaWYoZS5rZXkudG9Mb3dlckNhc2UoKSA9PT0gIm0iICYmIGxvYWRlZCkgewogICAgbGV0IHNhdmVTdGF0ZSA9IG5lcy5nZXRTdGF0ZSgpOwogICAgdHJ5IHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0obG9hZGVkTmFtZSArICJfc2F2ZXN0YXRlIiwgSlNPTi5zdHJpbmdpZnkoc2F2ZVN0YXRlKSk7CiAgICAgIGxvZygiU2F2ZWQgc3RhdGUiKTsKICAgIH0gY2F0Y2goZSkgewogICAgICBsb2coIkZhaWxlZCB0byBzYXZlIHN0YXRlOiAiICsgZSk7CiAgICB9CiAgfQogIGlmKGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICJuIiAmJiBsb2FkZWQpIHsKICAgIGxldCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0obG9hZGVkTmFtZSArICJfc2F2ZXN0YXRlIik7CiAgICBpZihkYXRhKSB7CiAgICAgIGxldCBvYmogPSBKU09OLnBhcnNlKGRhdGEpOwogICAgICBpZihuZXMuc2V0U3RhdGUob2JqKSkgewogICAgICAgIGxvZygiTG9hZGVkIHN0YXRlIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9nKCJGYWlsZWQgdG8gbG9hZCBzdGF0ZSIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBsb2coIk5vIHN0YXRlIHNhdmVkIHlldCIpOwogICAgfQogIH0KfQo="></script>



<chatgpt-sidebar data-gpts-theme="light"></chatgpt-sidebar><chatgpt-sidebar-popups data-gpts-theme="light"></chatgpt-sidebar-popups></body></html>


<style>
body{

  background: linear-gradient(45deg,#ff7e5f,#feb47b,#ffed86,#9feb8f,#5fbfff,#9b8eff);

}

    </style>