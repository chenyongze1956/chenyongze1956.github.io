
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --bg-color: #0d0d0d;
            --text-color: #00ff41; 
            --prompt-color: #00e5ff; 
            --error-color: #ff3d00;
        }
        * { box-sizing: border-box; }
        body {      background: linear-gradient(45deg,#ff7e5f,#feb47b,#ffed86,#9feb8f,#5fbfff,#9b8eff);
 display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; font-family: 'Consolas', 'Monaco', monospace; overflow: hidden; }
        #terminal {
            background-color: var(--bg-color);
            width: 95%; max-width: 1000px; height: 90vh;
            border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            display: flex; flex-direction: column; border: 1px solid #333; position: relative;
        }
        #output { flex-grow: 1; overflow-y: auto; padding: 25px; line-height: 1.6; white-space: pre-wrap; color: var(--text-color); font-size: 14px; }
        #input-line { display: flex; padding: 15px 25px; background: #050505; border-top: 1px solid #222; }
        #prompt { color: var(--prompt-color); margin-right: 12px; font-weight: bold; }
        #cmd-input { flex-grow: 1; background: transparent; border: none; color: var(--text-color); outline: none; font-size: 1rem; width: 100%; }
        
        /* åŠ¨æ•ˆ */
        .visualizer { display: flex; align-items: flex-end; height: 35px; gap: 4px; margin: 10px 0; }
        .bar { width: 6px; background: var(--text-color); animation: fluctuate 0.5s infinite alternate; }
        @keyframes fluctuate { from { height: 5px; } to { height: 35px; } }
        .success { color: #00e676; } .error { color: var(--error-color); } .welcome { color: #ffd600; }
        .qr-box { background: #fff; color: #000; padding: 5px; display: inline-block; font-size: 7px; line-height: 1; margin: 10px 0; border: 4px solid #fff; }
        #snow-zone { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 100; }
        .flake { position: absolute; color: #fff; animation: fall linear forwards; top: -10%; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
    </style>
</head>
<body>
    <div id="snow-zone"></div>
    <div id="terminal">
        <div id="output"></div>
        <div id="input-line">
            <span id="prompt">admin@web-cli:~$</span>
            <input type="text" id="cmd-input" autofocus spellcheck="false" autocomplete="off">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
    <script>
        const output = document.getElementById('output');
        const input = document.getElementById('cmd-input');
        const promptText = document.getElementById('prompt');
        const terminal = document.getElementById('terminal');
        const snowZone = document.getElementById('snow-zone');

        let state = {
            path: '/home/admin',
            user: 'admin',
            isMusicLocked: true,
            files: ['README.txt', 'Documents/', 'Downloads/', 'music.mp3'],
            history: [],
            hIdx: -1,
            isChat: false,
            intervals: []
        };

        const write = (txt, cls = '') => {
            const p = document.createElement('p'); p.className = cls;
            p.textContent = txt; output.appendChild(p);
            output.scrollTop = output.scrollHeight; return p;
        };

        const stopAll = () => { state.intervals.forEach(clearInterval); state.intervals = []; snowZone.innerHTML = ''; };

        const cmds = {
            // --- æ–‡ä»¶ç³»ç»Ÿ (å·²ä¿®å¤ rmdir é€»è¾‘) ---
            'help': { desc: 'åˆ—å‡ºæ‰€æœ‰ 35 ä¸ªå‘½ä»¤', exec: () => {
                let list = 'ðŸ”§ ç³»ç»Ÿå¯ç”¨å‘½ä»¤è¡¥å…¨åˆ—è¡¨:\n';
                Object.keys(cmds).sort().forEach(c => list += `  ${c.padEnd(12)} - ${cmds[c].desc}\n`);
                write(list);
            }},
            'ls': { desc: 'æŸ¥çœ‹æ–‡ä»¶', exec: () => {
                const list = state.files.map(f => (f === 'music.mp3' && state.isMusicLocked) ? `${f}(ðŸ”’)` : f);
                write(list.join('  ') || "(ç©º)");
            }},
            'mkdir': { desc: 'åˆ›å»ºç›®å½•', exec: (a) => {
                if(!a[0]) return write("mkdir: ç¼ºå°‘æ“ä½œæ•°", "error");
                const dir = a[0].endsWith('/') ? a[0] : a[0] + '/';
                if(!state.files.includes(dir)) state.files.push(dir);
                write(`ç›®å½• '${dir}' å·²åˆ›å»ºã€‚`);
            }},
            'rmdir': { desc: 'åˆ é™¤ç©ºç›®å½•', exec: (a) => {
                if(!a[0]) return write("rmdir: ç¼ºå°‘æ“ä½œæ•°", "error");
                // æ ¸å¿ƒä¿®å¤ï¼šè‡ªåŠ¨è¡¥å…¨æ–œæ 
                const target = a[0].endsWith('/') ? a[0] : a[0] + '/';
                const idx = state.files.indexOf(target);
                if(idx === -1) return write(`rmdir: åˆ é™¤ '${a[0]}' å¤±è´¥: ç›®å½•ä¸å­˜åœ¨`, "error");
                state.files.splice(idx, 1);
                write(`ç›®å½• '${target}' å·²æˆåŠŸç§»é™¤ã€‚`, "success");
            }},
            'rm': { desc: 'åˆ é™¤æ–‡ä»¶ (rm -r åˆ ç›®å½•)', exec: (a) => {
                let recursive = false; let target = "";
                a.forEach(arg => { if(arg.startsWith('-r')) recursive = true; else if(!target) target = arg; });
                if(!target) return write("rm: ç¼ºå°‘æ“ä½œæ•°", "error");
                const match = state.files.find(f => f === target || f === target + '/');
                if(!match) return write(`rm: '${target}' ä¸å­˜åœ¨`, "error");
                if(match.endsWith('/') && !recursive) return write(`rm: '${target}' æ˜¯ç›®å½•ï¼Œè¯·ä½¿ç”¨ -r`, "error");
                if(match === 'music.mp3' && state.isMusicLocked) return write("âŒ æƒé™æ‹’ç»ï¼šæ–‡ä»¶è¢«é­”æ³•é”å®šã€‚", "error");
                state.files = state.files.filter(f => f !== match);
                write(`å·²åˆ é™¤ '${match}'ã€‚`);
            }},
            'touch': { desc: 'åˆ›å»ºæ–‡ä»¶', exec: (a) => {
                if(!a[0]) return write("touch: ç¼ºå°‘æ“ä½œæ•°", "error");
                if(!state.files.includes(a[0])) state.files.push(a[0]);
                write(`æ–‡ä»¶ '${a[0]}' å·²åˆ›å»ºã€‚`);
            }},
            'cd': { desc: 'åˆ‡æ¢ç›®å½•', exec: (a) => { state.path = a[0] || '/home/admin'; promptText.textContent = `${state.user}@web-cli:${state.path}$`; }},
            'pwd': { desc: 'å½“å‰è·¯å¾„', exec: () => write(state.path) },
            'whoami': { desc: 'å½“å‰ç”¨æˆ·', exec: () => write(state.user) },

            // --- ç³»ç»Ÿå·¥å…· ---
            'clear': { desc: 'æ¸…ç©ºå±å¹•', exec: () => { output.innerHTML = ''; writeWelcome(); stopAll(); }},
            'date': { desc: 'æ˜¾ç¤ºæ—¥æœŸ', exec: () => write(new Date().toLocaleString()) },
            'echo': { desc: 'æ‰“å°æ–‡æœ¬', exec: (a) => write(a.join(' ')) },
            'fortune': { desc: 'éšæœºç®´è¨€', exec: () => write(["æœ€å¥½çš„é‡æž„æ˜¯åˆ é™¤ä»£ç ã€‚", "Bug åªæ˜¯æœªå£°æ˜Žçš„ç‰¹æ€§ã€‚", "ç®€å•å°±æ˜¯ç¾Žã€‚"][Math.floor(Math.random()*3)], "welcome") },
            'linuxlogo': { desc: 'Logo', exec: () => write("  .---. \n / o o \\ \n \\  >  / \n  `---' \nv5.1", "welcome") },
            'pwgen': { desc: 'ç”Ÿæˆå¯†ç ', exec: () => write(Math.random().toString(36).slice(-12), "success") },
            'gkrellm': { desc: 'ç³»ç»Ÿç›‘è§†', exec: () => write(`CPU: 14% | RAM: 3.2G | TEMP: 40Â°C`) },
            
            // --- ç½‘ç»œæ¨¡æ‹Ÿ ---
            'ping': { desc: 'ç½‘ç»œæµ‹è¯•', exec: (a) => {
                let c=0; const i = setInterval(()=>{ write(`64 bytes from ${a[0]||'8.8.8.8'}: seq=${c++} time=12ms`); if(c>=4)clearInterval(i); }, 800); state.intervals.push(i);
            }},
            'curl': { desc: 'HTTPè¯·æ±‚', exec: (a) => write(`GET ${a[0]||'localhost'}... 200 OK`) },
            'ncat': { desc: 'ç«¯å£æ‰«æ', exec: (a) => write(`æ‰«æ ${a[0]||'127.0.0.1'}... ç«¯å£ 80, 443 å¼€å¯ã€‚`) },
            'makemagnet': { desc: 'ç£åŠ›ç”Ÿæˆ', exec: () => write("magnet:?xt=urn:btih:" + Math.random().toString(16).slice(2, 42)) },

            // --- å®žç”¨å·¥å…· ---
            'crypto': { desc: 'åŠ å¯†å¸ä»·', exec: () => write(`BTC: $${(69000+Math.random()*500).toFixed(2)}`) },
            'stock': { desc: 'å®žæ—¶è‚¡ä»·', exec: () => write(`NVDA: $128.4 (+2.1%)`) },
            'fx': { desc: 'æ±‡çŽ‡', exec: () => write("1 USD = 7.24 CNY") },
            'qrterminal': { desc: 'ç”ŸæˆäºŒç»´ç ', exec: (a) => {
                if(!a[0]) return write("ç”¨æ³•: qrterminal <å†…å®¹>");
                const qr = qrcode(0, 'M'); qr.addData(a[0]); qr.make();
                let row = ''; const size = qr.getModuleCount();
                for (let r=0; r<size; r++) { for (let c=0; c<size; c++) row += qr.isDark(r,c) ? 'â–ˆâ–ˆ' : '  '; row += '\n'; }
                const pre = document.createElement('pre'); pre.className='qr-box'; pre.textContent = row; output.appendChild(pre);
            }},

            // --- ç‰¹æ•ˆ/é­”æ³• ---
            'cast': { desc: 'é­”æ³•å’’è¯­', exec: (a) => {
                const s = (a[0]||'').toLowerCase();
                if(s === 'alohomora') { state.isMusicLocked = false; write("ðŸ”“ é­”æ³•ç”Ÿæ•ˆï¼šmusic.mp3 å·²è§£é”ã€‚", "success"); }
                else if(s === 'lumos') { terminal.style.boxShadow = '0 0 100px #00e5ff'; write("âœ¨ è§å…‰é—ªçƒï¼"); }
                else if(s === 'nox') { terminal.style.boxShadow = '0 20px 50px rgba(0,0,0,0.9)'; write("ðŸŒš è¯ºå…‹æ–¯ï¼"); }
                else write("å¯ç”¨: alohomora, lumos, nox");
            }},
            'xsnow': { desc: 'é™é›ª', exec: () => {
                const i = setInterval(() => {
                    const f = document.createElement('div'); f.className='flake'; f.textContent='â„';
                    f.style.left=Math.random()*100+'vw'; f.style.animationDuration=Math.random()*3+2+'s';
                    snowZone.appendChild(f); setTimeout(()=>f.remove(), 4000);
                }, 150); state.intervals.push(i); write("â„ï¸ é™é›ªå·²å¼€å¯ã€‚");
            }},
            'sl': { desc: 'å°ç«è½¦', exec: () => {
                let p=0; const line = write(""); 
                const i = setInterval(()=>{ line.textContent = " ".repeat(p)+"=OO=o-o- å‘œå‘œï¼ï¼"; p++; if(p>50)clearInterval(i); }, 80); state.intervals.push(i);
            }},
            'cbonsai': { desc: 'ç›†æ ½', exec: () => write("    &&& &&  & &&\n && &\\/&\\|& ()|/ @, &&\n   &\\/(/&/&||/& /_/)_&/_&\n            | |", "success") },
            'divine': { desc: 'å åœ', exec: () => write("æ±‚å¾—ã€åœ°ç«æ˜Žå¤·ã€‘å¦ï¼šè‰°è‹¦å¥‹æ–—ï¼Œå¿…æœ‰åŽç¦ã€‚", "welcome") },
            'gifwrap': { desc: 'ASCIIåŠ¨ç”»', exec: () => write(" (o^â–½^o) -> (o_O) -> (o^â–½^o) ") },
            
            // --- åª’ä½“ ---
            'listen': { desc: 'å¯è§†åŒ–', exec: () => {
                let bars = ''; for(let i=0; i<15; i++) bars += `<div class="bar" style="animation-delay: ${Math.random()}s"></div>`;
                const d = document.createElement('div'); d.className='visualizer'; d.innerHTML=bars; output.appendChild(d);
            }},
            'mplayer': { desc: 'æ’­æ”¾å™¨', exec: () => write("Streaming: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80%") },
            'chat': { desc: 'AIæ¨¡å¼', exec: () => { state.isChat = true; promptText.textContent = `AI_SYSTEM >`; write("ðŸ’¬ AI å·²è¿žæŽ¥ã€‚/quit é€€å‡ºã€‚"); }},
            'display': { desc: 'å›¾åƒ', exec: (a) => { const img = document.createElement('img'); img.src = a[0]||'https://picsum.photos/200/100'; output.appendChild(img); }},
            'ruler': { desc: 'åˆ»åº¦å°º', exec: (a) => write("-".repeat(a[0]||40)+"\n0...10...20...30...40") }
        };

        const writeWelcome = () => {
            write("", "");
            write(" ", "");
            write("", "");
            write("");
        };

        input.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const val = input.value.trim(); input.value = ''; if (!val) return;
                state.history.unshift(val); state.hIdx = -1;
                const l = document.createElement('p');
                l.innerHTML = `<span style="color:var(--prompt-color)">${promptText.textContent}</span> ${val}`;
                output.appendChild(l);
                
                if (state.isChat) {
                    if (val === '/quit') { state.isChat = false; promptText.textContent = `${state.user}@web-cli:${state.path}$`; write("AI ç¦»çº¿ã€‚"); }
                    else write("AI: ç³»ç»ŸæŒ‡ä»¤æŽ¥æ”¶ä¸­...");
                    return;
                }
                const args = val.split(' ').filter(v => v !== "");
                const cmd = args.shift().toLowerCase();
                if (cmds[cmd]) cmds[cmd].exec(args); 
                else write(`-bash: ${cmd}: command not found.`, 'error');
            } else if (e.key === 'ArrowUp') { if (state.hIdx < state.history.length - 1) input.value = state.history[++state.hIdx]; }
            else if (e.key === 'ArrowDown') { input.value = state.hIdx > 0 ? state.history[--state.hIdx] : (state.hIdx = -1, ""); }
        });

        writeWelcome();
    </script>
</body>
</html>
