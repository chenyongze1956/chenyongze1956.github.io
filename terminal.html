
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Web Terminal CLI v5.5 - Hacker Mode</title>
    <style>
        :root { --bg: #0d0d0d; --text: #00ff41; --prompt: #00e5ff; --err: #ff3d00; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {      background: linear-gradient(45deg,#ff7e5f,#feb47b,#ffed86,#9feb8f,#5fbfff,#9b8eff);
display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Consolas', monospace; overflow: hidden; }
        
        #terminal { 
            background: var(--bg); 
            width: 100%; 
            max-width: 1000px; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            position: relative;
            transition: all 0.5s ease;
        }

        @media (min-width: 768px) { 
            #terminal { height: 90vh; border-radius: 12px; border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,0,0,0.8); } 
        }

        #output { flex-grow: 1; overflow-y: auto; padding: 20px; line-height: 1.5; white-space: pre-wrap; word-break: break-all; color: var(--text); font-size: 14px; -webkit-overflow-scrolling: touch; }
        #input-line { display: flex; align-items: flex-start; padding: 12px 20px; background: #050505; border-top: 1px solid #222; padding-bottom: calc(12px + env(safe-area-inset-bottom)); }
        #prompt { color: var(--prompt); margin-right: 10px; font-weight: bold; white-space: nowrap; font-size: 14px; }
        #cmd-input { flex-grow: 1; background: transparent; border: none; color: var(--text); outline: none; font-size: 16px; font-family: inherit; width: 100%; padding: 0; }
        
        .success { color: #00e676; } .error { color: var(--err); } .welcome { color: #ffd600; }
        .hacker-text { color: #00ff41; font-weight: bold; text-shadow: 0 0 5px #00ff41; }
        .visualizer { display: flex; align-items: flex-end; height: 30px; gap: 4px; margin: 10px 0; }
        .bar { width: 5px; background: var(--text); animation: fluctuate 0.5s infinite alternate; }
        @keyframes fluctuate { from { height: 5px; } to { height: 30px; } }
    </style>
</head>
<body onclick="document.getElementById('cmd-input').focus()">
    <div id="terminal">
        <div id="output"></div>
        <div id="input-line">
            <span id="prompt">admin@web-cli:~$</span>
            <input type="text" id="cmd-input" spellcheck="false" autocomplete="off" autocapitalize="none">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
    <script>
        const output = document.getElementById('output');
        const input = document.getElementById('cmd-input');
        const promptText = document.getElementById('prompt');
        const terminal = document.getElementById('terminal');

        let state = {
            path: '/home/admin',
            files: ['README.txt', 'Documents/', 'Downloads/', 'music.mp3'],
            history: [], hIdx: -1, isMusicLocked: true, isChat: false, intervals: []
        };

        const write = (txt, cls = '') => {
            const p = document.createElement('p'); p.className = cls;
            p.textContent = txt; output.appendChild(p);
            setTimeout(() => { output.scrollTop = output.scrollHeight; }, 10);
            return p;
        };

        const stopAll = () => { state.intervals.forEach(clearInterval); state.intervals = []; };

        // é»‘å®¢æ¨¡å¼æ‰“å­—æ•ˆæžœ
        const hackerWrite = async (lines) => {
            for (let line of lines) {
                await new Promise(r => setTimeout(r, Math.random() * 200 + 50));
                write(">> " + line, "hacker-text");
            }
        };

        const cmds = {
            'help': { desc: 'æ‰€æœ‰å‘½ä»¤åˆ—è¡¨', exec: () => {
                let list = 'ðŸ”§ ç³»ç»Ÿå¯ç”¨æŒ‡ä»¤:\n';
                Object.keys(cmds).sort().forEach(c => list += `  ${c.padEnd(12)} - ${cmds[c].desc}\n`);
                write(list);
            }},
            'ls': { desc: 'åˆ—å‡ºæ–‡ä»¶', exec: () => {
                const display = state.files.map(f => (f==='music.mp3' && state.isMusicLocked) ? `${f}(ðŸ”’)` : f);
                write(display.join('  ') || "(ç©º)");
            }},
            'mkdir': { desc: 'åˆ›å»ºç›®å½•', exec: (a) => {
                const dir = a[0] ? (a[0].endsWith('/') ? a[0] : a[0] + '/') : 'new_folder/';
                if(!state.files.includes(dir)) state.files.push(dir);
                write(`ç›®å½• '${dir}' åˆ›å»ºæˆåŠŸã€‚`);
            }},
            'rmdir': { desc: 'åˆ é™¤ç›®å½•', exec: (a) => {
                if(!a[0]) return write("rmdir: ç¼ºå¤±å‚æ•°", "error");
                const target = a[0].endsWith('/') ? a[0] : a[0] + '/';
                const idx = state.files.indexOf(target);
                if(idx === -1) return write(`rmdir: '${a[0]}' ç›®å½•ä¸å­˜åœ¨`, "error");
                state.files.splice(idx, 1);
                write(`ç›®å½• '${target}' å·²ç§»é™¤ã€‚`, "success");
            }},
            'touch': { desc: 'åˆ›å»ºæ–‡ä»¶', exec: (a) => {
                if(!a[0]) return write("touch: ç¼ºå¤±å‚æ•°", "error");
                if(!state.files.includes(a[0])) state.files.push(a[0]);
                write(`æ–‡ä»¶ '${a[0]}' å·²åˆ›å»ºã€‚`);
            }},
            'rm': { desc: 'åˆ é™¤ (-r åˆ ç›®å½•)', exec: (a) => {
                let isR = a.includes('-r'); let name = a.find(i => !i.startsWith('-'));
                if(!name) return write("rm: ç¼ºå¤±å‚æ•°", "error");
                const match = state.files.find(f => f === name || f === name + '/');
                if(!match) return write(`rm: '${name}' ä¸å­˜åœ¨`, "error");
                if(match.endsWith('/') && !isR) return write("è¿™æ˜¯ç›®å½•ï¼Œè¯·ä½¿ç”¨ -r", "error");
                state.files = state.files.filter(f => f !== match);
                write(`å·²ç§»é™¤ '${match}'ã€‚`);
            }},
            'cd': { desc: 'åˆ‡æ¢è·¯å¾„', exec: (a) => { state.path = a[0] || '/home/admin'; promptText.textContent = `admin@web-cli:${state.path}$`; }},
            'pwd': { desc: 'æ˜¾ç¤ºè·¯å¾„', exec: () => write(state.path) },
            'clear': { desc: 'æ¸…ç©ºå±å¹•', exec: () => { output.innerHTML = ''; writeWelcome(); stopAll(); }},
            'date': { desc: 'ç³»ç»Ÿæ—¥æœŸ', exec: () => write(new Date().toLocaleString()) },
            'cast': { desc: 'æ–½æ”¾å’’è¯­ (lumos/nox/alohomora)', exec: (a) => {
                const s = (a[0]||'').toLowerCase();
                if(s === 'alohomora') { state.isMusicLocked=false; write("ðŸ”“ é”å·²å¼¹å¼€ã€‚", "success"); }
                else if(s === 'lumos') { 
                    terminal.style.boxShadow = '0 0 80px rgba(0, 229, 255, 0.6)';
                    terminal.style.borderColor = '#00e5ff';
                    write("âœ¨ è§å…‰é—ªçƒï¼", "success");
                }
                else if(s === 'nox') { 
                    terminal.style.boxShadow = '0 20px 50px rgba(0,0,0,0.8)';
                    terminal.style.borderColor = '#333';
                    write("ðŸŒš è¯ºå…‹æ–¯ï¼");
                }
                else write("å¯ç”¨ï¼šlumos, nox, alohomora");
            }},
            'chat': { desc: 'é»‘å®¢äº¤äº’æ¨¡å¼', exec: () => { 
                state.isChat = true; 
                promptText.textContent = "HACKER@SYSTEM >"; 
                write("--- å»ºç«‹åŠ å¯†éš§é“ ---", "success");
                write("çŠ¶æ€: å·²è¿›å…¥é»‘å®¢æ¨¡å¼ã€‚è¾“å…¥ä»»ä½•å†…å®¹å¼€å§‹æ¸—é€ï¼Œ/quit é€€å‡ºã€‚");
            }},
            'qrterminal': { desc: 'ç”ŸæˆäºŒç»´ç ', exec: (a) => {
                if(!a[0]) return write("ç”¨æ³•: qrterminal å†…å®¹");
                const qr = qrcode(0, 'M'); qr.addData(a[0]); qr.make();
                let row = ''; const size = qr.getModuleCount();
                for (let r=0; r<size; r++) { for (let c=0; c<size; c++) row += qr.isDark(r,c) ? 'â–ˆâ–ˆ' : '  '; row += '\n'; }
                const pre = document.createElement('pre'); pre.style.fontSize="6px"; pre.style.lineHeight="1"; pre.textContent = row; output.appendChild(pre);
            }},
            'sl': { desc: 'å°ç«è½¦', exec: () => {
                let p=0; const line = write(""); 
                const i = setInterval(()=>{ line.textContent = " ".repeat(p)+"=OO=o-o- å‘œï¼ï¼"; p++; if(p>40)clearInterval(i); }, 80); state.intervals.push(i);
            }},
            'listen': { desc: 'é¢‘è°±åˆ†æž', exec: () => {
                let bars = ''; for(let i=0; i<12; i++) bars += `<div class="bar" style="animation-delay: ${Math.random()}s"></div>`;
                const d = document.createElement('div'); d.className='visualizer'; d.innerHTML=bars; output.appendChild(d);
            }},
            'whoami': { desc: 'å½“å‰ç”¨æˆ·', exec: () => write('admin') },
            'pwgen': { desc: 'å¯†ç ç”Ÿæˆ', exec: () => write(Math.random().toString(36).slice(-10), "success") },
            'fortune': { desc: 'éšæœºç®´è¨€', exec: () => write("Hack the planet.") },
            'ping': { desc: 'ç½‘ç»œæµ‹è¯•', exec: (a) => write(`PING ${a[0]||'8.8.8.8'}: 64 bytes, time=12ms`) },
            'curl': { desc: 'æŠ“å–ç½‘é¡µ', exec: (a) => write(`Requesting ${a[0]||'local'}... 200 OK`) },
            'history': { desc: 'åŽ†å²è®°å½•', exec: () => write(state.history.join('\n')) },
            'crypto': { desc: 'å¸ä»·', exec: () => write(`BTC: $${(69000+Math.random()*100).toFixed(2)}`) },
            'stock': { desc: 'è‚¡ä»·', exec: () => write(`NVDA: $128.4`) },
            'divine': { desc: 'å åœ', exec: () => write("ã€å¤§å‰ã€‘æ¸—é€å¿…æˆã€‚") },
            'df': { desc: 'ç£ç›˜', exec: () => write("/dev/sda1 42G 21%") },
            'top': { desc: 'è¿›ç¨‹', exec: () => write("PID: 101 node 0.5%CPU") },
            'uptime': { desc: 'è¿è¡Œæ—¶é—´', exec: () => write("up 12 days") },
            'uname': { desc: 'å†…æ ¸', exec: () => write("Hacker-Linux") },
            'exit': { desc: 'é€€å‡º', exec: () => { output.innerHTML = 'Logged out.'; input.disabled=true; }},
            'ncat': { desc: 'ç«¯å£æ‰«æ', exec: () => write("Port 80, 443 OPEN") },
            'fx': { desc: 'æ±‡çŽ‡', exec: () => write("1 USD = 7.24 CNY") },
            'display': { desc: 'æ˜¾ç¤ºå›¾åƒ', exec: (a) => { const img = document.createElement('img'); img.src = a[0]||'https://picsum.photos/100'; output.appendChild(img); }},
            'ruler': { desc: 'å°ºå­', exec: () => write("0...10...20") },
            'linuxlogo': { desc: 'Logo', exec: () => write("  .---. \n / o o \\ \n v5.5") },
            'echo': { desc: 'å›žæ˜¾', exec: (a) => write(a.join(' ')) }
        };

        function writeWelcome() {
            write("", "");
            write("");
        }

        input.addEventListener('keydown', async (e) => {
            if (e.key === 'Enter') {
                const val = input.value.trim(); input.value = ''; if (!val) return;
                state.history.unshift(val); state.hIdx = -1;
                
                const l = document.createElement('p');
                l.innerHTML = `<span style="color:var(--prompt)">${promptText.textContent}</span> ${val}`;
                output.appendChild(l);
                
                if (state.isChat) {
                    if (val === '/quit') { 
                        state.isChat = false; 
                        promptText.textContent = `admin@web-cli:${state.path}$`; 
                        write("--- éš§é“å·²å…³é—­ ---", "error"); 
                    } else {
                        // é»‘å®¢æ¨¡å¼éšæœºé€»è¾‘
                        const hacks = [
                            "æ­£åœ¨ç»•è¿‡é˜²ç«å¢™...",
                            "æ­£åœ¨æ³¨å…¥ SQL è´Ÿè½½...",
                            "æ‹¦æˆªæ•°æ®åŒ… [SUCCESS]",
                            "æ­£åœ¨åŒæ­¥å¯†é’¥çŸ©é˜µ...",
                            "æƒé™æå‡: Root è®¿é—®å·²æŽˆæƒã€‚"
                        ];
                        await hackerWrite([hacks[Math.floor(Math.random()*hacks.length)], "ç›®æ ‡å“åº”: " + btoa(val).slice(0,10) + "..."]);
                    }
                    return;
                }
                const args = val.split(' ').filter(v => v !== "");
                const cmd = args.shift().toLowerCase();
                if (cmds[cmd]) cmds[cmd].exec(args); 
                else write(`-bash: ${cmd}: command not found.`, 'error');
                output.scrollTop = output.scrollHeight;
            } else if (e.key === 'ArrowUp') {
                if (state.hIdx < state.history.length - 1) input.value = state.history[++state.hIdx];
            }
        });

        window.visualViewport.addEventListener('resize', () => {
            document.body.style.height = window.visualViewport.height + 'px';
            output.scrollTop = output.scrollHeight;
        });

        writeWelcome();
        input.focus();
    </script>
</body>
</html>
